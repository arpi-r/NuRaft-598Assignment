2022-04-27T15:03:05.190_893+00:00 [40775] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:03:05.192_245+00:00 [40775] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:03:05.192_274+00:00 [40775] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:03:05.192_283+00:00 [40775] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:03:05.192_306+00:00 [40775] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:03:05.192_310+00:00 [40775] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:03:05.192_312+00:00 [40775] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:03:05.192_343+00:00 [40775] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:03:05.192_487+00:00 [40811] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:03:06.854_577+00:00 [40782] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:03:06.854_588+00:00 [40782] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:03:06.854_603+00:00 [40782] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:03:06.854_613+00:00 [40782] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:03:06.854_619+00:00 [40782] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:03:06.854_623+00:00 [40782] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:03:06.854_642+00:00 [40782] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:03:06.854_715+00:00 [40810] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:03:06.854_723+00:00 [40810] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:03:06.854_733+00:00 [40810] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:03:06.993_540+00:00 [40775] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:03:06.993_934+00:00 [40782] [INFO] 0x561cae24f8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:03:06.994_261+00:00 [40782] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:03:06.994_269+00:00 [40782] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:03:06.994_321+00:00 [40810] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:03:06.994_332+00:00 [40810] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:03:06.994_378+00:00 [40810] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:03:06.994_381+00:00 [40810] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:03:06.994_423+00:00 [40810] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:03:06.994_426+00:00 [40810] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:03:06.994_432+00:00 [40810] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:03:07.243_779+00:00 [40775] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:03:07.243_985+00:00 [40782] [INFO] 0x561cae24fc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:03:07.244_365+00:00 [40782] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:03:07.244_370+00:00 [40782] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:03:07.244_505+00:00 [40782] [INFO] 0x7fc9900018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:03:07.244_668+00:00 [40782] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:03:07.244_876+00:00 [40810] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:03:07.244_891+00:00 [40810] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:03:07.244_949+00:00 [40810] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:03:07.244_953+00:00 [40810] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:03:07.244_999+00:00 [40810] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:03:07.245_004+00:00 [40810] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:03:07.245_014+00:00 [40810] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:03:07.745_309+00:00 [40780] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:08.245_407+00:00 [40780] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:08.795_566+00:00 [40780] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:09.395_743+00:00 [40780] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:10.045_880+00:00 [40778] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:10.746_094+00:00 [40778] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:11.496_278+00:00 [40778] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:12.246_464+00:00 [40778] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:12.498_940+00:00 [40778] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:12.626_878+00:00 [40784] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:12.882_962+00:00 [40798] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:13.383_083+00:00 [40788] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:13.883_067+00:00 [40802] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:14.383_105+00:00 [40797] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:14.883_260+00:00 [40792] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:15.383_222+00:00 [40803] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:15.883_325+00:00 [40793] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:16.383_299+00:00 [40797] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:16.883_409+00:00 [40789] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:03:17.383_401+00:00 [40795] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:03:23.615_913+00:00 [40810] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:03:23.615_924+00:00 [40810] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:03:23.615_944+00:00 [40810] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:03:23.615_948+00:00 [40810] [INFO] create snapshot idx 100000 log_term 1 done: 19 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:04:07.583_230+00:00 [40905] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:04:07.584_576+00:00 [40905] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:04:07.584_604+00:00 [40905] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:04:07.584_610+00:00 [40905] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:04:07.584_634+00:00 [40905] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:04:07.584_639+00:00 [40905] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:04:07.584_642+00:00 [40905] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:04:07.584_676+00:00 [40905] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:04:07.584_823+00:00 [40941] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:04:08.634_897+00:00 [40912] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:04:08.634_909+00:00 [40912] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:04:08.634_923+00:00 [40912] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:04:08.634_934+00:00 [40912] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:04:08.634_941+00:00 [40912] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:04:08.634_944+00:00 [40912] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:04:08.634_963+00:00 [40912] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:04:08.635_013+00:00 [40940] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:04:08.635_021+00:00 [40940] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:04:08.635_031+00:00 [40940] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:04:08.635_450+00:00 [40905] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:04:08.635_831+00:00 [40912] [INFO] 0x56490c8a88b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:04:08.636_160+00:00 [40912] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:04:08.636_167+00:00 [40912] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:04:08.636_214+00:00 [40940] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:04:08.636_225+00:00 [40940] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:04:08.636_271+00:00 [40940] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:04:08.636_273+00:00 [40940] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:04:08.636_314+00:00 [40940] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:04:08.636_318+00:00 [40940] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:04:08.636_323+00:00 [40940] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:04:08.885_718+00:00 [40905] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:04:08.885_961+00:00 [40912] [INFO] 0x56490c8a8c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:04:08.886_348+00:00 [40912] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:04:08.886_353+00:00 [40912] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:04:08.886_496+00:00 [40912] [INFO] 0x7f621c0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:04:08.886_700+00:00 [40912] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:04:08.886_919+00:00 [40940] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:04:08.886_935+00:00 [40940] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:04:08.886_991+00:00 [40940] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:04:08.886_993+00:00 [40940] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:04:08.887_034+00:00 [40940] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:04:08.887_039+00:00 [40940] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:04:08.887_046+00:00 [40940] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:04:09.387_373+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:09.887_941+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:10.437_861+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:11.038_017+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:11.688_134+00:00 [40908] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:12.388_378+00:00 [40908] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:13.138_391+00:00 [40908] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:13.888_888+00:00 [40908] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:14.140_699+00:00 [40908] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:14.268_736+00:00 [40912] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:14.524_815+00:00 [40937] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:15.024_908+00:00 [40913] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:15.525_006+00:00 [40916] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:16.024_995+00:00 [40923] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:16.524_981+00:00 [40916] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:17.025_033+00:00 [40917] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:17.525_056+00:00 [40913] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:18.025_165+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:18.525_199+00:00 [40910] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:04:19.025_201+00:00 [40908] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:04:21.683_329+00:00 [40940] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:04:21.683_338+00:00 [40940] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:04:21.683_448+00:00 [40940] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:04:21.683_452+00:00 [40940] [INFO] create snapshot idx 100000 log_term 1 done: 42 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:04:30.358_690+00:00 [40940] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:04:30.358_699+00:00 [40940] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:04:30.358_718+00:00 [40940] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:04:30.358_721+00:00 [40940] [INFO] create snapshot idx 200000 log_term 1 done: 18 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:05:09.232_624+00:00 [41037] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:05:09.234_636+00:00 [41037] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:05:09.234_684+00:00 [41037] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:05:09.234_689+00:00 [41037] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:05:09.234_722+00:00 [41037] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:05:09.234_726+00:00 [41037] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:05:09.234_729+00:00 [41037] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:05:09.234_758+00:00 [41037] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:05:09.235_239+00:00 [41073] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:05:10.569_964+00:00 [41044] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:05:10.569_976+00:00 [41044] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:05:10.569_991+00:00 [41044] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:05:10.570_003+00:00 [41044] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:05:10.570_010+00:00 [41044] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:05:10.570_014+00:00 [41044] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:05:10.570_034+00:00 [41044] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:05:10.570_089+00:00 [41072] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:05:10.570_096+00:00 [41072] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:05:10.570_106+00:00 [41072] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:05:10.785_754+00:00 [41037] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:05:10.786_176+00:00 [41044] [INFO] 0x56072d2a58b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:05:10.786_510+00:00 [41044] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:05:10.786_521+00:00 [41044] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:05:10.786_575+00:00 [41072] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:05:10.786_587+00:00 [41072] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:05:10.786_642+00:00 [41072] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:05:10.786_644+00:00 [41072] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:05:10.786_706+00:00 [41072] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:05:10.786_710+00:00 [41072] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:05:10.786_716+00:00 [41072] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:05:11.036_010+00:00 [41037] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:05:11.036_239+00:00 [41044] [INFO] 0x56072d2a5c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:05:11.036_571+00:00 [41044] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:05:11.036_576+00:00 [41044] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:05:11.036_715+00:00 [41044] [INFO] 0x7fc4380018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:05:11.036_884+00:00 [41044] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:05:11.037_083+00:00 [41072] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:05:11.037_098+00:00 [41072] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:05:11.037_149+00:00 [41072] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:05:11.037_151+00:00 [41072] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:05:11.037_191+00:00 [41072] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:05:11.037_195+00:00 [41072] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:05:11.037_202+00:00 [41072] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:05:11.537_506+00:00 [41071] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:12.037_634+00:00 [41071] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:12.587_781+00:00 [41071] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:13.187_949+00:00 [41071] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:13.838_080+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:14.538_304+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:15.288_506+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:16.038_657+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:16.291_490+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:16.419_476+00:00 [41061] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:16.675_544+00:00 [41040] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:17.175_586+00:00 [41046] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:17.675_613+00:00 [41051] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:18.175_794+00:00 [41052] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:18.675_755+00:00 [41046] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:19.175_854+00:00 [41047] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:19.675_908+00:00 [41059] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:20.176_048+00:00 [41060] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:20.676_079+00:00 [41065] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:05:21.176_104+00:00 [41062] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:05:23.395_009+00:00 [41072] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:05:23.395_017+00:00 [41072] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:05:23.395_035+00:00 [41072] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:05:23.395_039+00:00 [41072] [INFO] create snapshot idx 100000 log_term 1 done: 17 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:05:31.403_058+00:00 [41072] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:05:31.403_083+00:00 [41072] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:05:31.403_165+00:00 [41072] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:05:31.403_170+00:00 [41072] [INFO] create snapshot idx 200000 log_term 1 done: 82 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:06:11.375_109+00:00 [41170] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:06:11.376_474+00:00 [41170] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:06:11.376_503+00:00 [41170] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:06:11.376_511+00:00 [41170] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:06:11.376_533+00:00 [41170] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:06:11.376_537+00:00 [41170] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:06:11.376_540+00:00 [41170] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:06:11.376_573+00:00 [41170] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:06:11.376_726+00:00 [41206] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:06:12.555_834+00:00 [41177] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:06:12.555_848+00:00 [41177] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:06:12.555_863+00:00 [41177] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:06:12.555_875+00:00 [41177] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:06:12.555_882+00:00 [41177] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:06:12.555_886+00:00 [41177] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:06:12.555_905+00:00 [41177] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:06:12.555_963+00:00 [41205] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:06:12.555_971+00:00 [41205] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:06:12.555_981+00:00 [41205] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:06:12.677_492+00:00 [41170] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:06:12.677_891+00:00 [41177] [INFO] 0x55821eaa08b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:06:12.678_221+00:00 [41177] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:06:12.678_229+00:00 [41177] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:06:12.678_282+00:00 [41205] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:06:12.678_293+00:00 [41205] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:06:12.678_338+00:00 [41205] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:06:12.678_341+00:00 [41205] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:06:12.678_386+00:00 [41205] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:06:12.678_390+00:00 [41205] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:06:12.678_395+00:00 [41205] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:06:12.927_772+00:00 [41170] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:06:12.927_979+00:00 [41177] [INFO] 0x55821eaa0c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:06:12.928_335+00:00 [41177] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:06:12.928_340+00:00 [41177] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:06:12.928_480+00:00 [41177] [INFO] 0x7f4d640018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:06:12.928_739+00:00 [41177] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:06:12.928_951+00:00 [41205] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:06:12.928_966+00:00 [41205] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:06:12.929_020+00:00 [41205] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:06:12.929_023+00:00 [41205] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:06:12.929_063+00:00 [41205] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:06:12.929_067+00:00 [41205] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:06:12.929_074+00:00 [41205] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:06:13.429_377+00:00 [41175] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:13.929_495+00:00 [41183] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:14.479_630+00:00 [41183] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:15.079_752+00:00 [41183] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:15.729_961+00:00 [41204] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:16.430_138+00:00 [41204] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:17.180_243+00:00 [41204] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:17.930_449+00:00 [41173] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:18.183_194+00:00 [41173] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:18.311_169+00:00 [41186] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:18.567_279+00:00 [41186] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:19.067_442+00:00 [41203] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:19.567_634+00:00 [41200] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:20.067_458+00:00 [41187] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:20.567_676+00:00 [41181] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:21.067_712+00:00 [41175] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:21.567_523+00:00 [41202] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:22.067_459+00:00 [41200] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:22.567_771+00:00 [41198] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:06:23.067_919+00:00 [41178] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:06:25.525_679+00:00 [41205] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:06:25.525_688+00:00 [41205] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:06:25.525_823+00:00 [41205] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:06:25.525_900+00:00 [41205] [INFO] create snapshot idx 100000 log_term 1 done: 206 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:06:33.200_843+00:00 [41205] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:06:33.200_851+00:00 [41205] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:06:33.201_062+00:00 [41205] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:06:33.201_095+00:00 [41205] [INFO] create snapshot idx 200000 log_term 1 done: 240 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:07:13.280_772+00:00 [41306] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:07:13.282_142+00:00 [41306] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:07:13.282_173+00:00 [41306] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:07:13.282_178+00:00 [41306] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:07:13.282_204+00:00 [41306] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:07:13.282_208+00:00 [41306] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:07:13.282_211+00:00 [41306] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:07:13.282_242+00:00 [41306] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:07:13.282_387+00:00 [41342] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:07:15.074_471+00:00 [41313] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:07:15.074_482+00:00 [41313] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:07:15.074_498+00:00 [41313] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:07:15.074_510+00:00 [41313] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:07:15.074_517+00:00 [41313] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:07:15.074_520+00:00 [41313] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:07:15.074_540+00:00 [41313] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:07:15.074_589+00:00 [41341] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:07:15.074_597+00:00 [41341] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:07:15.074_606+00:00 [41341] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:07:15.083_346+00:00 [41306] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:07:15.083_746+00:00 [41313] [INFO] 0x562fa0f4c8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:07:15.084_064+00:00 [41313] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:07:15.084_071+00:00 [41313] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:07:15.084_118+00:00 [41341] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:07:15.084_128+00:00 [41341] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:07:15.084_175+00:00 [41341] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:07:15.084_177+00:00 [41341] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:07:15.084_218+00:00 [41341] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:07:15.084_222+00:00 [41341] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:07:15.084_228+00:00 [41341] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:07:15.333_586+00:00 [41306] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:07:15.333_813+00:00 [41313] [INFO] 0x562fa0f4cc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:07:15.334_181+00:00 [41313] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:07:15.334_185+00:00 [41313] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:07:15.334_330+00:00 [41313] [INFO] 0x7fd3b80018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:07:15.334_505+00:00 [41313] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:07:15.334_732+00:00 [41341] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:07:15.334_747+00:00 [41341] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:07:15.334_808+00:00 [41341] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:07:15.334_810+00:00 [41341] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:07:15.334_853+00:00 [41341] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:07:15.334_858+00:00 [41341] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:07:15.334_867+00:00 [41341] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:07:15.835_527+00:00 [41311] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:16.335_733+00:00 [41311] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:16.885_789+00:00 [41311] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:17.486_239+00:00 [41311] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:18.136_558+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:18.836_603+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:19.586_624+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:20.336_863+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:20.589_164+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:20.717_262+00:00 [41327] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:20.973_421+00:00 [41322] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:21.473_669+00:00 [41309] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:21.973_904+00:00 [41316] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:22.473_957+00:00 [41320] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:22.973_648+00:00 [41332] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:23.473_806+00:00 [41319] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:23.973_948+00:00 [41331] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:24.473_807+00:00 [41312] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:24.974_175+00:00 [41336] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:07:25.474_064+00:00 [41325] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:07:27.690_480+00:00 [41341] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:07:27.690_488+00:00 [41341] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:07:27.690_601+00:00 [41341] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:07:27.690_606+00:00 [41341] [INFO] create snapshot idx 100000 log_term 1 done: 113 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:07:35.301_794+00:00 [41341] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:07:35.301_826+00:00 [41341] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:07:35.301_844+00:00 [41341] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:07:35.301_848+00:00 [41341] [INFO] create snapshot idx 200000 log_term 1 done: 17 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:08:15.674_906+00:00 [41444] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:08:15.676_336+00:00 [41444] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:08:15.676_366+00:00 [41444] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:08:15.676_372+00:00 [41444] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:08:15.676_396+00:00 [41444] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:08:15.676_400+00:00 [41444] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:08:15.676_403+00:00 [41444] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:08:15.676_432+00:00 [41444] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:08:15.676_581+00:00 [41480] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:08:17.473_656+00:00 [41451] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:08:17.473_669+00:00 [41451] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:08:17.473_685+00:00 [41451] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:08:17.473_696+00:00 [41451] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:08:17.473_703+00:00 [41451] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:08:17.473_707+00:00 [41451] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:08:17.473_726+00:00 [41451] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:08:17.473_782+00:00 [41479] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:08:17.473_791+00:00 [41479] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:08:17.473_802+00:00 [41479] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:08:17.477_565+00:00 [41444] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:08:17.477_962+00:00 [41451] [INFO] 0x556bcbf478b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:08:17.478_290+00:00 [41451] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:08:17.478_297+00:00 [41451] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:08:17.478_343+00:00 [41479] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:08:17.478_354+00:00 [41479] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:08:17.478_400+00:00 [41479] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:08:17.478_402+00:00 [41479] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:08:17.478_445+00:00 [41479] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:08:17.478_449+00:00 [41479] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:08:17.478_454+00:00 [41479] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:08:17.727_812+00:00 [41444] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:08:17.728_044+00:00 [41451] [INFO] 0x556bcbf47c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:08:17.728_426+00:00 [41451] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:08:17.728_432+00:00 [41451] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:08:17.728_579+00:00 [41451] [INFO] 0x7f6d4c0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:08:17.728_761+00:00 [41451] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:08:17.728_985+00:00 [41479] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:08:17.728_998+00:00 [41479] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:08:17.729_044+00:00 [41479] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:08:17.729_046+00:00 [41479] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:08:17.729_081+00:00 [41479] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:08:17.729_084+00:00 [41479] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:08:17.729_090+00:00 [41479] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:08:18.229_329+00:00 [41449] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:18.729_491+00:00 [41449] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:19.279_637+00:00 [41449] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:19.879_797+00:00 [41449] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:20.529_971+00:00 [41447] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:21.230_147+00:00 [41447] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:21.980_327+00:00 [41447] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:22.730_451+00:00 [41447] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:22.983_698+00:00 [41447] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:23.111_906+00:00 [41467] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:23.368_138+00:00 [41457] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:23.868_488+00:00 [41472] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:24.368_619+00:00 [41453] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:24.868_227+00:00 [41455] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:25.368_320+00:00 [41462] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:25.868_327+00:00 [41460] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:26.368_787+00:00 [41471] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:26.868_584+00:00 [41454] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:27.368_994+00:00 [41464] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:08:27.868_996+00:00 [41465] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:08:30.049_947+00:00 [41479] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:08:30.049_955+00:00 [41479] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:08:30.050_045+00:00 [41479] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:08:30.050_120+00:00 [41479] [INFO] create snapshot idx 100000 log_term 1 done: 159 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:08:37.526_731+00:00 [41479] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:08:37.526_758+00:00 [41479] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:08:37.526_945+00:00 [41479] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:08:37.526_975+00:00 [41479] [INFO] create snapshot idx 200000 log_term 1 done: 211 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:09:18.077_823+00:00 [41585] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:09:18.079_203+00:00 [41585] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:09:18.079_238+00:00 [41585] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:09:18.079_244+00:00 [41585] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:09:18.079_266+00:00 [41585] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:09:18.079_270+00:00 [41585] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:09:18.079_272+00:00 [41585] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:09:18.079_300+00:00 [41585] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:09:18.079_441+00:00 [41621] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:09:19.787_496+00:00 [41592] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:09:19.787_507+00:00 [41592] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:09:19.787_524+00:00 [41592] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:09:19.787_535+00:00 [41592] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:09:19.787_542+00:00 [41592] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:09:19.787_545+00:00 [41592] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:09:19.787_564+00:00 [41592] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:09:19.787_615+00:00 [41620] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:09:19.787_623+00:00 [41620] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:09:19.787_633+00:00 [41620] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:09:19.880_668+00:00 [41585] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:09:19.881_094+00:00 [41592] [INFO] 0x56299ac2a8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:09:19.881_443+00:00 [41592] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:09:19.881_450+00:00 [41592] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:09:19.881_502+00:00 [41620] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:09:19.881_514+00:00 [41620] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:09:19.881_561+00:00 [41620] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:09:19.881_564+00:00 [41620] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:09:19.881_607+00:00 [41620] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:09:19.881_611+00:00 [41620] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:09:19.881_616+00:00 [41620] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:09:20.130_920+00:00 [41585] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:09:20.131_138+00:00 [41592] [INFO] 0x56299ac2ac60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:09:20.131_509+00:00 [41592] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:09:20.131_513+00:00 [41592] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:09:20.131_664+00:00 [41592] [INFO] 0x7fc0000018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:09:20.131_839+00:00 [41592] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:09:20.132_105+00:00 [41620] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:09:20.132_131+00:00 [41620] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:09:20.132_203+00:00 [41620] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:09:20.132_206+00:00 [41620] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:09:20.132_245+00:00 [41620] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:09:20.132_249+00:00 [41620] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:09:20.132_256+00:00 [41620] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:09:20.632_601+00:00 [41590] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:21.132_675+00:00 [41590] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:21.682_852+00:00 [41590] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:22.282_974+00:00 [41590] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:22.933_148+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:23.633_311+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:24.383_373+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:25.133_528+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:25.386_803+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:25.514_896+00:00 [41614] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:25.771_077+00:00 [41606] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:26.271_035+00:00 [41596] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:26.771_318+00:00 [41614] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:27.271_357+00:00 [41613] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:27.771_813+00:00 [41596] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:28.271_464+00:00 [41614] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:28.771_433+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:29.271_481+00:00 [41608] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:29.771_490+00:00 [41588] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:09:30.271_532+00:00 [41597] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:09:32.458_272+00:00 [41620] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:09:32.458_280+00:00 [41620] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:09:32.458_450+00:00 [41620] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:09:32.458_463+00:00 [41620] [INFO] create snapshot idx 100000 log_term 1 done: 60 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:09:39.861_748+00:00 [41620] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:09:39.861_756+00:00 [41620] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:09:39.861_928+00:00 [41620] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:09:39.861_943+00:00 [41620] [INFO] create snapshot idx 200000 log_term 1 done: 60 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:10:20.476_963+00:00 [41726] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:10:20.478_318+00:00 [41726] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:10:20.478_347+00:00 [41726] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:10:20.478_351+00:00 [41726] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:10:20.478_374+00:00 [41726] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:10:20.478_378+00:00 [41726] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:10:20.478_380+00:00 [41726] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:10:20.478_408+00:00 [41726] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:10:20.478_550+00:00 [41762] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:10:21.642_617+00:00 [41733] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:10:21.642_626+00:00 [41733] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:10:21.642_639+00:00 [41733] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:10:21.642_648+00:00 [41733] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:10:21.642_653+00:00 [41733] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:10:21.642_656+00:00 [41733] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:10:21.642_689+00:00 [41733] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:10:21.642_736+00:00 [41761] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:10:21.642_744+00:00 [41761] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:10:21.642_752+00:00 [41761] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:10:21.779_329+00:00 [41726] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:10:21.779_745+00:00 [41733] [INFO] 0x565378d078b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:10:21.780_075+00:00 [41733] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:10:21.780_083+00:00 [41733] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:10:21.780_137+00:00 [41761] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:10:21.780_148+00:00 [41761] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:10:21.780_198+00:00 [41761] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:10:21.780_200+00:00 [41761] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:10:21.780_245+00:00 [41761] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:10:21.780_248+00:00 [41761] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:10:21.780_254+00:00 [41761] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:10:22.029_757+00:00 [41726] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:10:22.029_966+00:00 [41733] [INFO] 0x565378d07c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:10:22.030_413+00:00 [41733] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:10:22.030_417+00:00 [41733] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:10:22.030_556+00:00 [41733] [INFO] 0x7f916c0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:10:22.030_738+00:00 [41733] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:10:22.030_915+00:00 [41761] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:10:22.030_927+00:00 [41761] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:10:22.030_980+00:00 [41761] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:10:22.030_982+00:00 [41761] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:10:22.031_016+00:00 [41761] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:10:22.031_019+00:00 [41761] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:10:22.031_025+00:00 [41761] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:10:22.531_635+00:00 [41731] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:23.031_531+00:00 [41731] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:23.581_714+00:00 [41731] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:24.181_885+00:00 [41731] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:24.831_986+00:00 [41729] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:25.532_195+00:00 [41729] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:26.282_463+00:00 [41729] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:27.032_620+00:00 [41729] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:27.285_530+00:00 [41729] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:27.413_938+00:00 [41737] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:27.670_040+00:00 [41741] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:28.170_597+00:00 [41736] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:28.670_626+00:00 [41746] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:29.170_256+00:00 [41744] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:29.670_821+00:00 [41738] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:30.170_301+00:00 [41756] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:30.670_397+00:00 [41758] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:31.170_482+00:00 [41758] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:31.670_469+00:00 [41734] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:10:32.170_933+00:00 [41755] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:10:34.314_084+00:00 [41761] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:10:34.314_092+00:00 [41761] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:10:34.314_273+00:00 [41761] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:10:34.314_278+00:00 [41761] [INFO] create snapshot idx 100000 log_term 1 done: 50 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:10:41.750_572+00:00 [41761] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:10:41.750_580+00:00 [41761] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:10:41.750_857+00:00 [41761] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:10:41.750_888+00:00 [41761] [INFO] create snapshot idx 200000 log_term 1 done: 303 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:11:22.375_032+00:00 [41869] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:11:22.376_446+00:00 [41869] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:11:22.376_474+00:00 [41869] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:11:22.376_480+00:00 [41869] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:11:22.376_504+00:00 [41869] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:11:22.376_508+00:00 [41869] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:11:22.376_511+00:00 [41869] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:11:22.376_540+00:00 [41869] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:11:22.376_680+00:00 [41905] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:11:24.156_753+00:00 [41876] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:11:24.156_764+00:00 [41876] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:11:24.156_780+00:00 [41876] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:11:24.156_798+00:00 [41876] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:11:24.156_805+00:00 [41876] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:11:24.156_809+00:00 [41876] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:11:24.156_828+00:00 [41876] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:11:24.156_883+00:00 [41904] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:11:24.156_892+00:00 [41904] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:11:24.156_902+00:00 [41904] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:11:24.177_584+00:00 [41869] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:11:24.177_988+00:00 [41876] [INFO] 0x5580b8a9f8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:11:24.178_296+00:00 [41876] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:11:24.178_309+00:00 [41876] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:11:24.178_355+00:00 [41904] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:11:24.178_365+00:00 [41904] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:11:24.178_412+00:00 [41904] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:11:24.178_414+00:00 [41904] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:11:24.178_455+00:00 [41904] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:11:24.178_459+00:00 [41904] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:11:24.178_465+00:00 [41904] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:11:24.427_985+00:00 [41869] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:11:24.428_210+00:00 [41876] [INFO] 0x5580b8a9fc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:11:24.428_580+00:00 [41876] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:11:24.428_584+00:00 [41876] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:11:24.428_730+00:00 [41876] [INFO] 0x7fdb080018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:11:24.428_910+00:00 [41876] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:11:24.429_100+00:00 [41904] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:11:24.429_113+00:00 [41904] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:11:24.429_160+00:00 [41904] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:11:24.429_162+00:00 [41904] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:11:24.429_198+00:00 [41904] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:11:24.429_202+00:00 [41904] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:11:24.429_210+00:00 [41904] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:11:24.929_564+00:00 [41874] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:25.429_718+00:00 [41874] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:25.979_854+00:00 [41874] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:26.580_001+00:00 [41874] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:27.230_096+00:00 [41872] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:27.930_246+00:00 [41872] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:28.680_286+00:00 [41872] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:29.430_470+00:00 [41872] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:29.683_928+00:00 [41872] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:29.811_892+00:00 [41880] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:30.068_414+00:00 [41886] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:30.568_402+00:00 [41900] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:31.068_124+00:00 [41878] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:31.568_140+00:00 [41900] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:32.068_545+00:00 [41878] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:32.568_701+00:00 [41888] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:33.068_227+00:00 [41898] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:33.568_713+00:00 [41885] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:34.068_394+00:00 [41877] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:11:34.568_458+00:00 [41880] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:11:36.807_091+00:00 [41904] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:11:36.807_100+00:00 [41904] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:11:36.807_336+00:00 [41904] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:11:36.807_354+00:00 [41904] [INFO] create snapshot idx 100000 log_term 1 done: 249 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:11:44.339_343+00:00 [41904] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:11:44.339_351+00:00 [41904] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:11:44.339_548+00:00 [41904] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:11:44.339_579+00:00 [41904] [INFO] create snapshot idx 200000 log_term 1 done: 223 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:12:24.776_459+00:00 [42042] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:12:24.778_585+00:00 [42042] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:12:24.778_616+00:00 [42042] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:12:24.778_620+00:00 [42042] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:12:24.778_643+00:00 [42042] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:12:24.778_647+00:00 [42042] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:12:24.778_650+00:00 [42042] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:12:24.778_699+00:00 [42042] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:12:24.779_226+00:00 [42078] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:12:26.746_908+00:00 [42048] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:12:26.746_921+00:00 [42048] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:12:26.746_937+00:00 [42048] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:12:26.746_958+00:00 [42048] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:12:26.746_964+00:00 [42048] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:12:26.746_968+00:00 [42048] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:12:26.746_987+00:00 [42048] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:12:26.747_044+00:00 [42077] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:12:26.747_053+00:00 [42077] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:12:26.747_064+00:00 [42077] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:12:26.829_844+00:00 [42042] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:12:26.830_230+00:00 [42048] [INFO] 0x5594116368b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:12:26.830_581+00:00 [42048] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:12:26.830_588+00:00 [42048] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:12:26.830_641+00:00 [42077] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:12:26.830_652+00:00 [42077] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:12:26.830_713+00:00 [42077] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:12:26.830_716+00:00 [42077] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:12:26.830_762+00:00 [42077] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:12:26.830_766+00:00 [42077] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:12:26.830_772+00:00 [42077] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:12:27.080_118+00:00 [42042] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:12:27.080_348+00:00 [42048] [INFO] 0x559411636c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:12:27.080_726+00:00 [42048] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:12:27.080_731+00:00 [42048] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:12:27.080_871+00:00 [42048] [INFO] 0x7f541c0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:12:27.081_052+00:00 [42048] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:12:27.081_261+00:00 [42077] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:12:27.081_277+00:00 [42077] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:12:27.081_335+00:00 [42077] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:12:27.081_338+00:00 [42077] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:12:27.081_377+00:00 [42077] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:12:27.081_381+00:00 [42077] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:12:27.081_388+00:00 [42077] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:12:27.581_681+00:00 [42076] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:28.081_836+00:00 [42076] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:28.631_927+00:00 [42076] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:29.232_071+00:00 [42076] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:29.882_218+00:00 [42045] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:30.582_425+00:00 [42045] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:31.332_597+00:00 [42045] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:32.082_757+00:00 [42045] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:32.336_294+00:00 [42045] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:32.464_391+00:00 [42069] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:32.720_905+00:00 [42072] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:33.220_657+00:00 [42059] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:33.720_720+00:00 [42073] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:34.221_190+00:00 [42063] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:34.721_355+00:00 [42061] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:35.220_983+00:00 [42066] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:35.721_014+00:00 [42053] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:36.221_501+00:00 [42050] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:36.721_099+00:00 [42069] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:12:37.221_113+00:00 [42048] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:12:39.219_929+00:00 [42077] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:12:39.219_937+00:00 [42077] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:12:39.220_104+00:00 [42077] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:12:39.220_119+00:00 [42077] [INFO] create snapshot idx 100000 log_term 1 done: 178 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:12:46.582_524+00:00 [42077] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:12:46.582_531+00:00 [42077] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:12:46.582_716+00:00 [42077] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:12:46.582_748+00:00 [42077] [INFO] create snapshot idx 200000 log_term 1 done: 212 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:22:47.967_085+00:00 [42406] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:22:47.968_460+00:00 [42406] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:22:47.968_491+00:00 [42406] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:22:47.968_495+00:00 [42406] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:22:47.968_521+00:00 [42406] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:22:47.968_526+00:00 [42406] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:22:47.968_528+00:00 [42406] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:22:47.968_558+00:00 [42406] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:22:47.968_714+00:00 [42442] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:22:50.015_782+00:00 [42413] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:22:50.015_795+00:00 [42413] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:22:50.015_810+00:00 [42413] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:22:50.015_822+00:00 [42413] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:22:50.015_829+00:00 [42413] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:22:50.015_832+00:00 [42413] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:22:50.015_851+00:00 [42413] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:22:50.015_910+00:00 [42441] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:22:50.015_919+00:00 [42441] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:22:50.015_930+00:00 [42441] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:22:50.019_755+00:00 [42406] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:22:50.020_139+00:00 [42413] [INFO] 0x56543865f8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:22:50.020_423+00:00 [42413] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:22:50.020_431+00:00 [42413] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:22:50.020_476+00:00 [42441] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:22:50.020_486+00:00 [42441] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:22:50.020_531+00:00 [42441] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:22:50.020_533+00:00 [42441] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:22:50.020_574+00:00 [42441] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:22:50.020_578+00:00 [42441] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:22:50.020_583+00:00 [42441] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:22:50.269_987+00:00 [42406] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:22:50.270_196+00:00 [42413] [INFO] 0x56543865fc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:22:50.270_525+00:00 [42413] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:22:50.270_530+00:00 [42413] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:22:50.270_683+00:00 [42413] [INFO] 0x7fb2600018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:22:50.270_848+00:00 [42413] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:22:50.271_051+00:00 [42441] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:22:50.271_066+00:00 [42441] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:22:50.271_121+00:00 [42441] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:22:50.271_123+00:00 [42441] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:22:50.271_163+00:00 [42441] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:22:50.271_168+00:00 [42441] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:22:50.271_175+00:00 [42441] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:22:50.771_506+00:00 [42411] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:51.271_651+00:00 [42411] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:51.821_852+00:00 [42411] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:52.422_038+00:00 [42411] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:53.072_196+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:53.772_411+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:54.522_439+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:55.272_671+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:55.525_510+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:55.653_513+00:00 [42424] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:55.909_638+00:00 [42438] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:56.409_614+00:00 [42439] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:56.909_733+00:00 [42415] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:57.409_781+00:00 [42411] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:57.909_821+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:58.409_890+00:00 [42440] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:58.910_039+00:00 [42412] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:59.410_064+00:00 [42409] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:22:59.910_048+00:00 [42415] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:00.410_134+00:00 [42435] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:23:06.507_719+00:00 [42441] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:23:06.507_728+00:00 [42441] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:23:06.507_747+00:00 [42441] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:23:06.507_751+00:00 [42441] [INFO] create snapshot idx 100000 log_term 1 done: 18 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:23:50.609_601+00:00 [42536] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:23:50.611_035+00:00 [42536] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:23:50.611_066+00:00 [42536] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:23:50.611_071+00:00 [42536] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:23:50.611_093+00:00 [42536] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:23:50.611_098+00:00 [42536] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:23:50.611_100+00:00 [42536] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:23:50.611_131+00:00 [42536] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:23:50.611_278+00:00 [42572] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:23:52.588_355+00:00 [42543] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:23:52.588_366+00:00 [42543] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:23:52.588_382+00:00 [42543] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:23:52.588_393+00:00 [42543] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:23:52.588_399+00:00 [42543] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:23:52.588_402+00:00 [42543] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:23:52.588_421+00:00 [42543] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:23:52.588_472+00:00 [42571] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:23:52.588_479+00:00 [42571] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:23:52.588_488+00:00 [42571] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:23:52.662_380+00:00 [42536] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:23:52.662_794+00:00 [42543] [INFO] 0x563859d3c8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:23:52.663_105+00:00 [42543] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:23:52.663_112+00:00 [42543] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:23:52.663_165+00:00 [42571] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:23:52.663_176+00:00 [42571] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:23:52.663_229+00:00 [42571] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:23:52.663_232+00:00 [42571] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:23:52.663_276+00:00 [42571] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:23:52.663_279+00:00 [42571] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:23:52.663_285+00:00 [42571] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:23:52.912_627+00:00 [42536] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:23:52.912_869+00:00 [42543] [INFO] 0x563859d3cc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:23:52.913_247+00:00 [42543] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:23:52.913_252+00:00 [42543] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:23:52.913_396+00:00 [42543] [INFO] 0x7f00200018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:23:52.913_570+00:00 [42543] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:23:52.913_780+00:00 [42571] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:23:52.913_795+00:00 [42571] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:23:52.913_853+00:00 [42571] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:23:52.913_855+00:00 [42571] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:23:52.913_895+00:00 [42571] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:23:52.913_899+00:00 [42571] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:23:52.913_906+00:00 [42571] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:23:53.414_243+00:00 [42541] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:53.914_393+00:00 [42541] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:54.464_563+00:00 [42541] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:55.064_739+00:00 [42541] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:55.714_911+00:00 [42539] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:56.415_081+00:00 [42539] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:57.165_144+00:00 [42539] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:57.915_328+00:00 [42539] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:58.167_867+00:00 [42539] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:58.295_894+00:00 [42561] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:58.552_045+00:00 [42570] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:59.051_988+00:00 [42544] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:23:59.552_092+00:00 [42561] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:00.052_304+00:00 [42563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:00.552_304+00:00 [42540] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:01.052_326+00:00 [42540] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:01.552_338+00:00 [42543] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:02.052_428+00:00 [42543] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:02.552_490+00:00 [42556] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:03.052_627+00:00 [42554] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:24:05.623_529+00:00 [42571] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:24:05.623_538+00:00 [42571] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:24:05.623_557+00:00 [42571] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:24:05.623_561+00:00 [42571] [INFO] create snapshot idx 100000 log_term 1 done: 18 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:24:13.559_113+00:00 [42571] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:24:13.559_122+00:00 [42571] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:24:13.559_139+00:00 [42571] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:24:13.559_143+00:00 [42571] [INFO] create snapshot idx 200000 log_term 1 done: 17 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:24:53.257_510+00:00 [42668] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:24:53.258_907+00:00 [42668] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:24:53.258_937+00:00 [42668] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:24:53.258_941+00:00 [42668] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:24:53.258_963+00:00 [42668] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:24:53.258_968+00:00 [42668] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:24:53.258_971+00:00 [42668] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:24:53.258_998+00:00 [42668] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:24:53.259_149+00:00 [42704] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:24:54.601_230+00:00 [42675] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:24:54.601_242+00:00 [42675] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:24:54.601_259+00:00 [42675] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:24:54.601_277+00:00 [42675] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:24:54.601_283+00:00 [42675] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:24:54.601_288+00:00 [42675] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:24:54.601_308+00:00 [42675] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:24:54.601_364+00:00 [42703] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:24:54.601_372+00:00 [42703] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:24:54.601_385+00:00 [42703] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:24:54.810_062+00:00 [42668] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:24:54.810_492+00:00 [42675] [INFO] 0x55dd119538b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:24:54.810_832+00:00 [42675] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:24:54.810_841+00:00 [42675] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:24:54.810_892+00:00 [42703] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:24:54.810_903+00:00 [42703] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:24:54.810_956+00:00 [42703] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:24:54.810_958+00:00 [42703] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:24:54.811_002+00:00 [42703] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:24:54.811_006+00:00 [42703] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:24:54.811_012+00:00 [42703] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:24:55.060_315+00:00 [42668] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:24:55.060_549+00:00 [42675] [INFO] 0x55dd11953c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:24:55.060_890+00:00 [42675] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:24:55.060_895+00:00 [42675] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:24:55.061_043+00:00 [42675] [INFO] 0x7ff1600018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:24:55.061_202+00:00 [42675] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:24:55.061_404+00:00 [42703] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:24:55.061_419+00:00 [42703] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:24:55.061_474+00:00 [42703] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:24:55.061_476+00:00 [42703] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:24:55.061_518+00:00 [42703] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:24:55.061_522+00:00 [42703] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:24:55.061_529+00:00 [42703] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:24:55.561_847+00:00 [42673] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:56.061_965+00:00 [42673] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:56.612_160+00:00 [42673] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:57.212_319+00:00 [42673] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:57.862_454+00:00 [42671] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:58.562_696+00:00 [42671] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:24:59.312_963+00:00 [42671] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:00.063_127+00:00 [42671] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:00.315_733+00:00 [42671] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:00.443_797+00:00 [42691] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:00.699_865+00:00 [42687] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:01.199_934+00:00 [42676] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:01.700_005+00:00 [42684] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:02.200_085+00:00 [42702] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:02.700_309+00:00 [42697] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:03.200_314+00:00 [42699] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:03.700_480+00:00 [42697] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:04.200_442+00:00 [42692] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:04.700_615+00:00 [42687] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:05.200_754+00:00 [42674] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:25:07.763_507+00:00 [42703] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:25:07.763_518+00:00 [42703] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:25:07.763_535+00:00 [42703] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:25:07.763_539+00:00 [42703] [INFO] create snapshot idx 100000 log_term 1 done: 16 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:25:14.684_869+00:00 [42703] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:25:14.684_879+00:00 [42703] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:25:14.684_898+00:00 [42703] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:25:14.684_901+00:00 [42703] [INFO] create snapshot idx 200000 log_term 1 done: 18 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:25:55.407_918+00:00 [42801] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:25:55.409_277+00:00 [42801] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:25:55.409_310+00:00 [42801] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:25:55.409_314+00:00 [42801] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:25:55.409_339+00:00 [42801] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:25:55.409_343+00:00 [42801] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:25:55.409_346+00:00 [42801] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:25:55.409_378+00:00 [42801] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:25:55.409_528+00:00 [42837] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:25:56.520_630+00:00 [42808] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:25:56.520_641+00:00 [42808] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:25:56.520_656+00:00 [42808] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:25:56.520_668+00:00 [42808] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:25:56.520_674+00:00 [42808] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:25:56.520_678+00:00 [42808] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:25:56.520_697+00:00 [42808] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:25:56.520_749+00:00 [42836] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:25:56.520_758+00:00 [42836] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:25:56.520_768+00:00 [42836] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:25:56.710_727+00:00 [42801] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:25:56.711_117+00:00 [42808] [INFO] 0x55d4056bb8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:25:56.711_459+00:00 [42808] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:25:56.711_467+00:00 [42808] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:25:56.711_511+00:00 [42836] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:25:56.711_521+00:00 [42836] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:25:56.711_562+00:00 [42836] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:25:56.711_564+00:00 [42836] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:25:56.711_604+00:00 [42836] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:25:56.711_607+00:00 [42836] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:25:56.711_612+00:00 [42836] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:25:56.960_978+00:00 [42801] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:25:56.961_207+00:00 [42808] [INFO] 0x55d4056bbc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:25:56.961_565+00:00 [42808] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:25:56.961_571+00:00 [42808] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:25:56.961_739+00:00 [42808] [INFO] 0x7f91d00018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:25:56.961_945+00:00 [42808] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:25:56.962_212+00:00 [42836] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:25:56.962_228+00:00 [42836] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:25:56.962_286+00:00 [42836] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:25:56.962_289+00:00 [42836] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:25:56.962_330+00:00 [42836] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:25:56.962_334+00:00 [42836] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:25:56.962_345+00:00 [42836] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:25:57.462_586+00:00 [42806] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:57.962_698+00:00 [42806] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:58.512_888+00:00 [42806] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:59.113_102+00:00 [42806] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:25:59.763_244+00:00 [42804] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:00.463_407+00:00 [42804] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:01.213_440+00:00 [42804] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:01.963_652+00:00 [42804] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:02.216_364+00:00 [42804] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:02.344_372+00:00 [42813] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:02.600_398+00:00 [42816] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:03.100_409+00:00 [42808] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:03.600_455+00:00 [42835] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:04.100_718+00:00 [42818] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:04.600_525+00:00 [42821] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:05.100_614+00:00 [42808] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:05.600_769+00:00 [42811] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:06.100_814+00:00 [42805] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:06.600_837+00:00 [42812] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:26:07.100_769+00:00 [42820] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:26:09.472_513+00:00 [42836] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:26:09.472_521+00:00 [42836] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:26:09.472_618+00:00 [42836] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:26:09.472_623+00:00 [42836] [INFO] create snapshot idx 100000 log_term 1 done: 98 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:26:17.109_513+00:00 [42836] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:26:17.109_522+00:00 [42836] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:26:17.109_540+00:00 [42836] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:26:17.109_544+00:00 [42836] [INFO] create snapshot idx 200000 log_term 1 done: 17 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:26:57.309_069+00:00 [42940] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:26:57.310_425+00:00 [42940] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:26:57.310_455+00:00 [42940] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:26:57.310_461+00:00 [42940] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:26:57.310_482+00:00 [42940] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:26:57.310_486+00:00 [42940] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:26:57.310_489+00:00 [42940] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:26:57.310_525+00:00 [42940] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:26:57.310_692+00:00 [42976] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:26:58.650_741+00:00 [42947] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:26:58.650_753+00:00 [42947] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:26:58.650_768+00:00 [42947] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:26:58.650_784+00:00 [42947] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:26:58.650_791+00:00 [42947] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:26:58.650_795+00:00 [42947] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:26:58.650_814+00:00 [42947] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:26:58.650_866+00:00 [42975] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:26:58.650_874+00:00 [42975] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:26:58.650_883+00:00 [42975] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:26:58.861_510+00:00 [42940] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:26:58.861_943+00:00 [42947] [INFO] 0x55e56b14b8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:26:58.862_252+00:00 [42947] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:26:58.862_261+00:00 [42947] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:26:58.862_314+00:00 [42975] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:26:58.862_325+00:00 [42975] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:26:58.862_373+00:00 [42975] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:26:58.862_376+00:00 [42975] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:26:58.862_420+00:00 [42975] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:26:58.862_424+00:00 [42975] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:26:58.862_430+00:00 [42975] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:26:59.111_755+00:00 [42940] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:26:59.111_963+00:00 [42947] [INFO] 0x55e56b14bc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:26:59.112_321+00:00 [42947] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:26:59.112_326+00:00 [42947] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:26:59.112_467+00:00 [42947] [INFO] 0x7ff2000018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:26:59.112_638+00:00 [42947] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:26:59.112_830+00:00 [42975] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:26:59.112_843+00:00 [42975] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:26:59.112_895+00:00 [42975] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:26:59.112_897+00:00 [42975] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:26:59.112_934+00:00 [42975] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:26:59.112_938+00:00 [42975] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:26:59.112_944+00:00 [42975] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:26:59.613_226+00:00 [42945] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:00.113_371+00:00 [42953] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:00.663_577+00:00 [42953] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:01.263_698+00:00 [42953] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:01.913_896+00:00 [42974] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:02.614_066+00:00 [42974] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:03.364_175+00:00 [42974] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:04.114_268+00:00 [42974] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:04.367_021+00:00 [42974] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:04.495_048+00:00 [42972] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:04.751_333+00:00 [42973] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:05.251_526+00:00 [42952] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:05.751_197+00:00 [42964] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:06.251_504+00:00 [42959] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:06.751_444+00:00 [42973] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:07.251_569+00:00 [42953] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:07.751_790+00:00 [42943] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:08.251_951+00:00 [42944] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:08.751_942+00:00 [42943] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:27:09.252_159+00:00 [42956] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:27:11.455_855+00:00 [42975] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:27:11.455_863+00:00 [42975] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:27:11.455_950+00:00 [42975] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:27:11.456_022+00:00 [42975] [INFO] create snapshot idx 100000 log_term 1 done: 154 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:27:19.039_463+00:00 [42975] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:27:19.039_471+00:00 [42975] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:27:19.039_576+00:00 [42975] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:27:19.039_648+00:00 [42975] [INFO] create snapshot idx 200000 log_term 1 done: 172 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:27:59.446_616+00:00 [43136] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:27:59.447_963+00:00 [43136] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:27:59.447_992+00:00 [43136] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:27:59.447_996+00:00 [43136] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:27:59.448_018+00:00 [43136] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:27:59.448_022+00:00 [43136] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:27:59.448_025+00:00 [43136] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:27:59.448_057+00:00 [43136] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:27:59.448_202+00:00 [43172] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:28:01.087_289+00:00 [43143] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:28:01.087_302+00:00 [43143] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:28:01.087_318+00:00 [43143] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:28:01.087_337+00:00 [43143] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:28:01.087_343+00:00 [43143] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:28:01.087_347+00:00 [43143] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:28:01.087_367+00:00 [43143] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:28:01.087_426+00:00 [43171] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:28:01.087_435+00:00 [43171] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:28:01.087_445+00:00 [43171] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:28:01.249_152+00:00 [43136] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:28:01.249_485+00:00 [43143] [INFO] 0x5594ee76e8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:28:01.249_775+00:00 [43143] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:28:01.249_782+00:00 [43143] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:28:01.249_835+00:00 [43171] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:28:01.249_846+00:00 [43171] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:28:01.249_891+00:00 [43171] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:28:01.249_893+00:00 [43171] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:28:01.249_935+00:00 [43171] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:28:01.249_939+00:00 [43171] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:28:01.249_945+00:00 [43171] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:28:01.499_424+00:00 [43136] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:28:01.499_650+00:00 [43143] [INFO] 0x5594ee76ec60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:28:01.500_032+00:00 [43143] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:28:01.500_037+00:00 [43143] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:28:01.500_172+00:00 [43143] [INFO] 0x7fdc880018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:28:01.500_340+00:00 [43143] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:28:01.500_549+00:00 [43171] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:28:01.500_564+00:00 [43171] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:28:01.500_615+00:00 [43171] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:28:01.500_618+00:00 [43171] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:28:01.500_656+00:00 [43171] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:28:01.500_660+00:00 [43171] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:28:01.500_667+00:00 [43171] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:28:02.000_939+00:00 [43141] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:02.501_062+00:00 [43141] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:03.051_230+00:00 [43141] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:03.651_351+00:00 [43141] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:04.301_528+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:05.001_717+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:05.751_806+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:06.501_962+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:06.755_176+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:06.883_212+00:00 [43145] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:07.139_326+00:00 [43152] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:07.639_372+00:00 [43156] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:08.139_782+00:00 [43153] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:08.639_446+00:00 [43162] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:09.139_594+00:00 [43158] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:09.639_693+00:00 [43159] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:10.140_051+00:00 [43155] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:10.640_109+00:00 [43151] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:11.139_971+00:00 [43139] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:28:11.639_782+00:00 [43144] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:28:13.582_639+00:00 [43171] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:28:13.582_647+00:00 [43171] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:28:13.582_830+00:00 [43171] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:28:13.582_845+00:00 [43171] [INFO] create snapshot idx 100000 log_term 1 done: 193 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:28:20.933_456+00:00 [43171] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:28:20.933_463+00:00 [43171] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:28:20.933_598+00:00 [43171] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:28:20.933_603+00:00 [43171] [INFO] create snapshot idx 200000 log_term 1 done: 135 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:29:01.850_282+00:00 [43347] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:29:01.851_654+00:00 [43347] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:29:01.851_689+00:00 [43347] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:29:01.851_693+00:00 [43347] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:29:01.851_717+00:00 [43347] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:29:01.851_721+00:00 [43347] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:29:01.851_724+00:00 [43347] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:29:01.851_751+00:00 [43347] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:29:01.851_899+00:00 [43383] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:29:03.860_948+00:00 [43354] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:29:03.860_960+00:00 [43354] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:29:03.860_975+00:00 [43354] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:29:03.860_986+00:00 [43354] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:29:03.860_992+00:00 [43354] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:29:03.860_996+00:00 [43354] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:29:03.861_014+00:00 [43354] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:29:03.861_069+00:00 [43382] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:29:03.861_077+00:00 [43382] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:29:03.861_088+00:00 [43382] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:29:03.902_868+00:00 [43347] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:29:03.903_223+00:00 [43354] [INFO] 0x555ca9fbc8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:29:03.903_614+00:00 [43354] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:29:03.903_621+00:00 [43354] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:29:03.903_667+00:00 [43382] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:29:03.903_677+00:00 [43382] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:29:03.903_718+00:00 [43382] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:29:03.903_721+00:00 [43382] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:29:03.903_762+00:00 [43382] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:29:03.903_766+00:00 [43382] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:29:03.903_771+00:00 [43382] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:29:04.153_237+00:00 [43347] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:29:04.153_483+00:00 [43354] [INFO] 0x555ca9fbcc60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:29:04.153_894+00:00 [43354] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:29:04.153_899+00:00 [43354] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:29:04.154_042+00:00 [43354] [INFO] 0x7fc3300018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:29:04.154_256+00:00 [43354] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:29:04.154_480+00:00 [43382] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:29:04.154_496+00:00 [43382] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:29:04.154_551+00:00 [43382] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:29:04.154_554+00:00 [43382] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:29:04.154_595+00:00 [43382] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:29:04.154_599+00:00 [43382] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:29:04.154_607+00:00 [43382] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:29:04.654_959+00:00 [43352] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:05.155_097+00:00 [43352] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:05.705_235+00:00 [43352] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:06.305_419+00:00 [43352] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:06.955_586+00:00 [43350] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:07.655_797+00:00 [43350] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:08.405_813+00:00 [43350] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:09.155_980+00:00 [43350] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:09.408_769+00:00 [43350] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:09.537_036+00:00 [43374] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:09.793_283+00:00 [43356] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:10.293_302+00:00 [43365] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:10.793_284+00:00 [43374] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:11.293_564+00:00 [43366] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:11.793_596+00:00 [43380] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:12.293_606+00:00 [43355] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:12.794_112+00:00 [43361] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:13.293_777+00:00 [43366] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:13.793_900+00:00 [43358] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:29:14.294_097+00:00 [43370] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:29:16.595_144+00:00 [43382] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:29:16.595_151+00:00 [43382] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:29:16.595_277+00:00 [43382] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:29:16.595_350+00:00 [43382] [INFO] create snapshot idx 100000 log_term 1 done: 194 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:29:24.318_593+00:00 [43382] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:29:24.318_601+00:00 [43382] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:29:24.318_742+00:00 [43382] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:29:24.318_816+00:00 [43382] [INFO] create snapshot idx 200000 log_term 1 done: 210 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:30:04.501_571+00:00 [43560] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:30:04.503_047+00:00 [43560] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:30:04.503_082+00:00 [43560] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:30:04.503_089+00:00 [43560] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:30:04.503_109+00:00 [43560] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:30:04.503_113+00:00 [43560] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:30:04.503_116+00:00 [43560] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:30:04.503_150+00:00 [43560] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:30:04.503_293+00:00 [43596] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:30:06.473_424+00:00 [43567] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:30:06.473_436+00:00 [43567] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:30:06.473_451+00:00 [43567] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:30:06.473_462+00:00 [43567] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:30:06.473_468+00:00 [43567] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:30:06.473_471+00:00 [43567] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:30:06.473_490+00:00 [43567] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:30:06.473_550+00:00 [43595] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:30:06.473_558+00:00 [43595] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:30:06.473_568+00:00 [43595] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:30:06.554_429+00:00 [43560] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:30:06.554_875+00:00 [43567] [INFO] 0x556c835e98b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:30:06.555_191+00:00 [43567] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:30:06.555_200+00:00 [43567] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:30:06.555_251+00:00 [43595] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:30:06.555_262+00:00 [43595] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:30:06.555_309+00:00 [43595] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:30:06.555_311+00:00 [43595] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:30:06.555_357+00:00 [43595] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:30:06.555_361+00:00 [43595] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:30:06.555_366+00:00 [43595] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:30:06.804_711+00:00 [43560] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:30:06.804_958+00:00 [43567] [INFO] 0x556c835e9c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:30:06.805_353+00:00 [43567] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:30:06.805_358+00:00 [43567] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:30:06.805_508+00:00 [43567] [INFO] 0x7fd6fc0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:30:06.805_688+00:00 [43567] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:30:06.805_901+00:00 [43595] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:30:06.805_916+00:00 [43595] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:30:06.805_971+00:00 [43595] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:30:06.805_973+00:00 [43595] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:30:06.806_008+00:00 [43595] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:30:06.806_012+00:00 [43595] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:30:06.806_018+00:00 [43595] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:30:07.306_328+00:00 [43565] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:07.806_488+00:00 [43565] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:08.356_676+00:00 [43565] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:08.956_836+00:00 [43565] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:09.607_033+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:10.307_158+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:11.057_206+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:11.807_431+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:12.060_557+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:12.188_615+00:00 [43585] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:12.445_029+00:00 [43591] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:12.944_745+00:00 [43586] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:13.445_285+00:00 [43567] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:13.945_281+00:00 [43574] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:14.445_216+00:00 [43569] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:14.944_904+00:00 [43565] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:15.444_966+00:00 [43590] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:15.945_094+00:00 [43585] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:16.445_078+00:00 [43563] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:30:16.945_447+00:00 [43571] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:30:19.325_432+00:00 [43595] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:30:19.325_439+00:00 [43595] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:30:19.325_584+00:00 [43595] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:30:19.325_589+00:00 [43595] [INFO] create snapshot idx 100000 log_term 1 done: 145 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:30:26.993_962+00:00 [43595] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:30:26.994_092+00:00 [43595] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:30:26.994_151+00:00 [43595] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:30:26.994_155+00:00 [43595] [INFO] create snapshot idx 200000 log_term 1 done: 58 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:31:07.158_593+00:00 [43759] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:31:07.159_973+00:00 [43759] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:31:07.160_005+00:00 [43759] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:31:07.160_008+00:00 [43759] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:31:07.160_030+00:00 [43759] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:31:07.160_035+00:00 [43759] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:31:07.160_037+00:00 [43759] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:31:07.160_064+00:00 [43759] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:31:07.160_200+00:00 [43795] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:31:08.320_259+00:00 [43766] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:31:08.320_270+00:00 [43766] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:31:08.320_285+00:00 [43766] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:31:08.320_302+00:00 [43766] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:31:08.320_308+00:00 [43766] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:31:08.320_312+00:00 [43766] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:31:08.320_331+00:00 [43766] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:31:08.320_382+00:00 [43794] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:31:08.320_390+00:00 [43794] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:31:08.320_400+00:00 [43794] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:31:08.461_052+00:00 [43759] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:31:08.461_464+00:00 [43766] [INFO] 0x55c94e9b58b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:31:08.461_801+00:00 [43766] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:31:08.461_809+00:00 [43766] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:31:08.461_858+00:00 [43794] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:31:08.461_869+00:00 [43794] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:31:08.461_921+00:00 [43794] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:31:08.461_924+00:00 [43794] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:31:08.461_968+00:00 [43794] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:31:08.461_972+00:00 [43794] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:31:08.461_978+00:00 [43794] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:31:08.711_314+00:00 [43759] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:31:08.711_554+00:00 [43766] [INFO] 0x55c94e9b5c60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:31:08.711_933+00:00 [43766] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:31:08.711_937+00:00 [43766] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:31:08.712_076+00:00 [43766] [INFO] 0x7f113c0018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:31:08.712_245+00:00 [43766] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:31:08.712_456+00:00 [43794] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:31:08.712_471+00:00 [43794] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:31:08.712_523+00:00 [43794] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:31:08.712_526+00:00 [43794] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:31:08.712_564+00:00 [43794] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:31:08.712_568+00:00 [43794] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:31:08.712_575+00:00 [43794] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:31:09.212_835+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:09.713_412+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:10.263_273+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:10.863_446+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:11.513_585+00:00 [43762] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:12.213_791+00:00 [43762] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:12.964_048+00:00 [43762] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:13.714_100+00:00 [43762] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:13.968_721+00:00 [43762] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:14.096_711+00:00 [43785] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:14.352_747+00:00 [43771] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:14.852_718+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:15.353_303+00:00 [43764] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:15.852_817+00:00 [43782] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:16.353_505+00:00 [43774] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:16.853_071+00:00 [43775] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:17.353_257+00:00 [43763] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:17.853_680+00:00 [43790] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:18.353_320+00:00 [43790] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:31:18.853_508+00:00 [43792] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:31:21.243_067+00:00 [43794] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:31:21.243_075+00:00 [43794] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:31:21.243_304+00:00 [43794] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:31:21.243_323+00:00 [43794] [INFO] create snapshot idx 100000 log_term 1 done: 243 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:31:28.912_887+00:00 [43794] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:31:28.912_895+00:00 [43794] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:31:28.913_028+00:00 [43794] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:31:28.913_102+00:00 [43794] [INFO] create snapshot idx 200000 log_term 1 done: 202 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:32:09.063_151+00:00 [43978] [====] Start logger: ./srv1.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T15:32:09.064_527+00:00 [43978] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T15:32:09.064_558+00:00 [43978] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T15:32:09.064_564+00:00 [43978] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T15:32:09.064_587+00:00 [43978] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T15:32:09.064_591+00:00 [43978] [INFO] peer 1: DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T15:32:09.064_594+00:00 [43978] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T15:32:09.064_623+00:00 [43978] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T15:32:09.064_773+00:00 [44014] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T15:32:10.137_843+00:00 [43985] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T15:32:10.137_856+00:00 [43985] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T15:32:10.137_872+00:00 [43985] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T15:32:10.137_884+00:00 [43985] [INFO] [VOTE INIT] my id 1, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T15:32:10.137_891+00:00 [43985] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T15:32:10.137_895+00:00 [43985] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T15:32:10.137_916+00:00 [43985] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T15:32:10.137_972+00:00 [44013] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:32:10.137_981+00:00 [44013] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:32:10.137_992+00:00 [44013] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:32:10.365_650+00:00 [43978] [INFO] sent join request to peer 2, tcp://localhost:12345	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:32:10.366_089+00:00 [43985] [INFO] 0x55868b7ce8b0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:32:10.366_430+00:00 [43985] [INFO] new server (2) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:32:10.366_438+00:00 [43985] [INFO] [SYNC LOG] LogSync is done for server 2 with log gap 0 (1 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:32:10.366_491+00:00 [44013] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:32:10.366_503+00:00 [44013] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:32:10.366_551+00:00 [44013] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:32:10.366_554+00:00 [44013] [INFO] enable heartbeating for server 2	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:32:10.366_599+00:00 [44013] [INFO] add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:32:10.366_603+00:00 [44013] [INFO] clearing uncommitted config at log 2, prev 1	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:32:10.366_609+00:00 [44013] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:32:10.615_883+00:00 [43978] [INFO] sent join request to peer 3, tcp://localhost:12346	[handle_join_leave.cxx:132, invite_srv_to_join_cluster()]
2022-04-27T15:32:10.616_115+00:00 [43985] [INFO] 0x55868b7cec60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:32:10.616_468+00:00 [43985] [INFO] new server (3) confirms it will join, start syncing logs to it	[handle_join_leave.cxx:199, handle_join_cluster_resp()]
2022-04-27T15:32:10.616_472+00:00 [43985] [INFO] [SYNC LOG] LogSync is done for server 3 with log gap 1 (2 - 1, limit 99999), now put the server into cluster	[handle_join_leave.cxx:222, sync_log_to_new_srv()]
2022-04-27T15:32:10.616_614+00:00 [43985] [INFO] 0x7f19f80018d0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T15:32:10.616_785+00:00 [43985] [INFO] declined append: peer 2, prev next log idx 4, resp next 2, new next log idx 2	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-27T15:32:10.616_980+00:00 [44013] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T15:32:10.616_994+00:00 [44013] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T15:32:10.617_044+00:00 [44013] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T15:32:10.617_046+00:00 [44013] [INFO] enable heartbeating for server 3	[handle_commit.cxx:671, reconfigure()]
2022-04-27T15:32:10.617_082+00:00 [44013] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T15:32:10.617_086+00:00 [44013] [INFO] clearing uncommitted config at log 3, prev 2	[handle_commit.cxx:774, reconfigure()]
2022-04-27T15:32:10.617_093+00:00 [44013] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 1, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T15:32:11.117_395+00:00 [43983] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:11.617_493+00:00 [43983] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:12.167_728+00:00 [43983] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:12.767_837+00:00 [43983] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:13.418_000+00:00 [43981] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:14.118_199+00:00 [43981] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:14.868_487+00:00 [43981] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:15.618_547+00:00 [43981] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:15.872_085+00:00 [43981] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:16.000_045+00:00 [43995] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:16.256_170+00:00 [44008] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:16.756_461+00:00 [43989] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:17.256_605+00:00 [43995] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:17.756_675+00:00 [43982] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:18.256_858+00:00 [43994] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:18.757_330+00:00 [43985] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:19.256_831+00:00 [44011] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:19.757_380+00:00 [44011] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:20.257_456+00:00 [44002] [WARN] peer (3) response error: failed to connect to peer 3, localhost:12346, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T15:32:20.757_131+00:00 [44011] [WARN] too verbose RPC error on peer (3), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T15:32:23.109_753+00:00 [44013] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:32:23.109_761+00:00 [44013] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:32:23.109_947+00:00 [44013] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:32:23.109_952+00:00 [44013] [INFO] create snapshot idx 100000 log_term 1 done: 186 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T15:32:30.718_983+00:00 [44013] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T15:32:30.718_991+00:00 [44013] [INFO] create snapshot idx 200000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T15:32:30.719_098+00:00 [44013] [INFO] snapshot idx 200000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T15:32:30.719_102+00:00 [44013] [INFO] create snapshot idx 200000 log_term 1 done: 107 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
