2022-04-27T12:02:58.745_935+00:00 [15936] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:02:58.747_318+00:00 [15936] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:02:58.747_347+00:00 [15936] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:02:58.747_352+00:00 [15936] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:02:58.747_374+00:00 [15936] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:02:58.747_378+00:00 [15936] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:02:58.747_382+00:00 [15936] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:02:58.747_418+00:00 [15936] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:02:58.747_557+00:00 [15972] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:03:00.285_596+00:00 [15943] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:03:00.285_607+00:00 [15943] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:03:00.285_622+00:00 [15943] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:03:00.285_638+00:00 [15943] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:03:00.285_644+00:00 [15943] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:03:00.285_647+00:00 [15943] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:03:00.285_665+00:00 [15943] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:03:00.285_723+00:00 [15971] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:03:00.285_731+00:00 [15971] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:03:00.285_741+00:00 [15971] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:03:20.061_627+00:00 [15943] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:03:20.061_650+00:00 [15943] [INFO] session 1 got connection from 127.0.0.1:42968 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:03:20.061_752+00:00 [15943] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:03:20.061_775+00:00 [15943] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:03:20.061_836+00:00 [15943] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:03:20.061_839+00:00 [15943] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:03:20.061_841+00:00 [15943] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:03:20.061_846+00:00 [15943] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:03:20.062_089+00:00 [15943] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42968 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:03:20.312_124+00:00 [15943] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:03:20.312_135+00:00 [15943] [INFO] session 2 got connection from 127.0.0.1:42970 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:03:20.312_219+00:00 [15943] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:03:20.312_223+00:00 [15943] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:03:20.312_352+00:00 [15943] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:03:20.312_356+00:00 [15943] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:03:20.312_420+00:00 [15971] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:03:20.312_423+00:00 [15971] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:03:20.312_431+00:00 [15971] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:03:20.312_442+00:00 [15971] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:03:20.312_447+00:00 [15971] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:03:20.312_466+00:00 [15971] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:03:20.312_565+00:00 [15971] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:03:20.312_577+00:00 [15971] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:03:20.312_637+00:00 [15971] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:03:20.312_642+00:00 [15971] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:03:20.312_649+00:00 [15971] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:03:40.558_987+00:00 [15961] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42970 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:03:41.502_758+00:00 [15961] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:03:41.502_772+00:00 [15961] [INFO] session 3 got connection from 127.0.0.1:42972 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:03:41.502_875+00:00 [15961] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:03:41.502_883+00:00 [15961] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:03:41.699_448+00:00 [15961] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:03:41.699_471+00:00 [15961] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:03:41.699_479+00:00 [15961] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:03:41.699_563+00:00 [15961] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:03:41.699_602+00:00 [15961] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:03:41.700_075+00:00 [15961] [INFO] 0x7f50a4013d30 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:03:41.700_280+00:00 [15961] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:41.700_350+00:00 [15961] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:03:41.700_354+00:00 [15961] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:03:41.700_356+00:00 [15961] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:03:41.700_370+00:00 [15961] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:03:41.700_524+00:00 [15961] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:03:41.700_528+00:00 [15961] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:03:41.700_535+00:00 [15961] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:03:41.700_539+00:00 [15961] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:03:41.700_577+00:00 [15961] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:03:41.700_685+00:00 [15961] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:03:41.700_945+00:00 [15971] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:03:41.700_965+00:00 [15971] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:03:41.700_977+00:00 [15971] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:03:41.701_118+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:42.201_102+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:42.751_186+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:43.351_333+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:44.001_581+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:44.701_973+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:45.451_924+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:45.558_464+00:00 [15963] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:03:45.558_477+00:00 [15963] [INFO] session 4 got connection from 127.0.0.1:42974 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:03:45.558_808+00:00 [15965] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:03:45.558_818+00:00 [15965] [INFO] session 5 got connection from 127.0.0.1:42976 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:03:45.580_150+00:00 [15970] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:45.836_310+00:00 [15942] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:46.336_625+00:00 [15961] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:46.836_694+00:00 [15944] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:47.337_016+00:00 [15958] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:47.837_086+00:00 [15953] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:48.337_086+00:00 [15962] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:48.837_329+00:00 [15951] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:49.337_367+00:00 [15963] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:49.837_333+00:00 [15941] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:50.337_650+00:00 [15950] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:03:50.837_691+00:00 [15952] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:04:20.614_716+00:00 [16397] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:04:20.616_272+00:00 [16397] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:04:20.616_307+00:00 [16397] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:04:20.616_314+00:00 [16397] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:04:20.616_342+00:00 [16397] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:04:20.616_347+00:00 [16397] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:04:20.616_351+00:00 [16397] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:04:20.616_386+00:00 [16397] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:04:20.616_557+00:00 [16433] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:04:22.599_571+00:00 [16404] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:04:22.599_582+00:00 [16404] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:04:22.599_598+00:00 [16404] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:04:22.599_609+00:00 [16404] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:04:22.599_616+00:00 [16404] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:04:22.599_619+00:00 [16404] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:04:22.599_637+00:00 [16404] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:04:22.599_695+00:00 [16432] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:04:22.599_703+00:00 [16432] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:04:22.599_714+00:00 [16432] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:04:42.690_518+00:00 [16404] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:04:42.690_541+00:00 [16404] [INFO] session 1 got connection from 127.0.0.1:42978 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:04:42.690_646+00:00 [16404] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:04:42.690_697+00:00 [16404] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:04:42.690_760+00:00 [16404] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:04:42.690_763+00:00 [16404] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:04:42.690_765+00:00 [16404] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:04:42.690_771+00:00 [16404] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:04:42.691_010+00:00 [16404] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42978 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:04:42.941_163+00:00 [16404] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:04:42.941_174+00:00 [16404] [INFO] session 2 got connection from 127.0.0.1:42980 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:04:42.941_253+00:00 [16404] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:04:42.941_257+00:00 [16404] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:04:42.941_384+00:00 [16404] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:04:42.941_388+00:00 [16404] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:04:42.941_452+00:00 [16432] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:04:42.941_456+00:00 [16432] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:04:42.941_464+00:00 [16432] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:04:42.941_475+00:00 [16432] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:04:42.941_479+00:00 [16432] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:04:42.941_500+00:00 [16432] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:04:42.941_594+00:00 [16432] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:04:42.941_607+00:00 [16432] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:04:42.941_664+00:00 [16432] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:04:42.941_668+00:00 [16432] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:04:42.941_677+00:00 [16432] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:05:02.184_659+00:00 [16422] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42980 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:05:03.156_102+00:00 [16422] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:05:03.156_124+00:00 [16422] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:05:03.156_133+00:00 [16422] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:05:03.156_207+00:00 [16422] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:05:03.156_250+00:00 [16422] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:05:03.156_698+00:00 [16422] [INFO] 0x7fd8b8002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:05:03.156_891+00:00 [16422] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:05:03.156_962+00:00 [16422] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:05:03.865_961+00:00 [16400] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:05:03.865_974+00:00 [16400] [INFO] session 3 got connection from 127.0.0.1:42982 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:05:03.866_074+00:00 [16400] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:05:03.866_083+00:00 [16400] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:05:03.866_254+00:00 [16400] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:05:03.866_277+00:00 [16400] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:05:03.866_286+00:00 [16400] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:05:03.866_297+00:00 [16400] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:05:03.866_527+00:00 [16400] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:05:03.866_771+00:00 [16432] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:05:03.866_794+00:00 [16432] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:05:03.866_809+00:00 [16432] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:05:21.148_480+00:00 [16432] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:05:21.148_488+00:00 [16432] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:05:21.148_510+00:00 [16432] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:05:21.148_515+00:00 [16432] [INFO] create snapshot idx 100000 log_term 2 done: 22 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:05:42.244_676+00:00 [16845] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:05:42.246_139+00:00 [16845] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:05:42.246_168+00:00 [16845] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:05:42.246_177+00:00 [16845] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:05:42.246_200+00:00 [16845] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:05:42.246_204+00:00 [16845] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:05:42.246_207+00:00 [16845] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:05:42.246_237+00:00 [16845] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:05:42.246_391+00:00 [16881] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:05:44.126_415+00:00 [16852] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:05:44.126_425+00:00 [16852] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:05:44.126_444+00:00 [16852] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:05:44.126_458+00:00 [16852] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:05:44.126_465+00:00 [16852] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:05:44.126_470+00:00 [16852] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:05:44.126_494+00:00 [16852] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:05:44.126_553+00:00 [16880] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:05:44.126_564+00:00 [16880] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:05:44.126_575+00:00 [16880] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:06:03.815_678+00:00 [16852] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:03.815_700+00:00 [16852] [INFO] session 1 got connection from 127.0.0.1:42984 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:06:03.815_803+00:00 [16852] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:06:03.815_823+00:00 [16852] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:06:03.815_874+00:00 [16852] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:06:03.815_877+00:00 [16852] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:06:03.815_879+00:00 [16852] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:06:03.815_884+00:00 [16852] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:06:03.816_120+00:00 [16852] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42984 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:06:04.066_257+00:00 [16852] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:04.066_268+00:00 [16852] [INFO] session 2 got connection from 127.0.0.1:42986 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:06:04.066_351+00:00 [16852] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:06:04.066_355+00:00 [16852] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:06:04.066_482+00:00 [16852] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:06:04.066_486+00:00 [16852] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:06:04.066_552+00:00 [16880] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:06:04.066_555+00:00 [16880] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:06:04.066_563+00:00 [16880] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:06:04.066_575+00:00 [16880] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:06:04.066_580+00:00 [16880] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:06:04.066_601+00:00 [16880] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:06:04.066_724+00:00 [16880] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:06:04.066_741+00:00 [16880] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:06:04.066_803+00:00 [16880] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:06:04.066_807+00:00 [16880] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:06:04.066_816+00:00 [16880] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:06:24.063_581+00:00 [16874] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42986 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:06:25.152_024+00:00 [16874] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:25.152_039+00:00 [16874] [INFO] session 3 got connection from 127.0.0.1:42988 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:06:25.152_143+00:00 [16874] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:06:25.152_151+00:00 [16874] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:06:25.647_641+00:00 [16874] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:06:25.647_665+00:00 [16874] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:06:25.647_673+00:00 [16874] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:06:25.647_756+00:00 [16874] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:06:25.647_796+00:00 [16874] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:06:25.648_610+00:00 [16874] [INFO] 0x7f48f0013c50 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:06:25.648_816+00:00 [16874] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:25.648_873+00:00 [16874] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:06:25.648_875+00:00 [16874] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:06:25.648_876+00:00 [16874] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:06:25.648_885+00:00 [16874] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:06:25.649_022+00:00 [16874] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:06:25.649_025+00:00 [16874] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:06:25.649_031+00:00 [16874] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:06:25.649_034+00:00 [16874] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:06:25.649_066+00:00 [16874] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:06:25.649_156+00:00 [16874] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:06:25.649_361+00:00 [16880] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:06:25.649_377+00:00 [16880] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:06:25.649_388+00:00 [16880] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:06:25.649_523+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:26.149_587+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:26.699_667+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:27.299_765+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:27.949_945+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:28.650_109+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:29.063_695+00:00 [16866] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:29.063_737+00:00 [16866] [INFO] session 4 got connection from 127.0.0.1:42992 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:06:29.063_984+00:00 [16866] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:29.063_992+00:00 [16866] [INFO] session 5 got connection from 127.0.0.1:42994 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:06:29.064_612+00:00 [16875] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:29.192_740+00:00 [16858] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:29.448_789+00:00 [16851] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:29.948_904+00:00 [16874] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:30.448_963+00:00 [16866] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:30.949_037+00:00 [16849] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:31.449_096+00:00 [16868] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:31.949_180+00:00 [16858] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:32.449_532+00:00 [16865] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:32.949_575+00:00 [16848] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:33.449_601+00:00 [16877] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:33.949_634+00:00 [16859] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:06:34.449_743+00:00 [16866] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:06:41.678_876+00:00 [16878] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:06:41.678_886+00:00 [16878] [INFO] session 6 got connection from 127.0.0.1:42996 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:07:04.122_114+00:00 [17281] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:07:04.123_543+00:00 [17281] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:07:04.123_573+00:00 [17281] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:07:04.123_577+00:00 [17281] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:07:04.123_599+00:00 [17281] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:07:04.123_603+00:00 [17281] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:07:04.123_606+00:00 [17281] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:07:04.123_637+00:00 [17281] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:07:04.123_789+00:00 [17317] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:07:05.549_827+00:00 [17288] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:07:05.549_839+00:00 [17288] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:07:05.549_853+00:00 [17288] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:07:05.549_864+00:00 [17288] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:07:05.549_870+00:00 [17288] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:07:05.549_874+00:00 [17288] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:07:05.549_892+00:00 [17288] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:07:05.549_947+00:00 [17316] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:07:05.549_954+00:00 [17316] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:07:05.549_965+00:00 [17316] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:07:25.948_023+00:00 [17288] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:07:25.948_046+00:00 [17288] [INFO] session 1 got connection from 127.0.0.1:42998 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:07:25.948_145+00:00 [17288] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:07:25.948_169+00:00 [17288] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:07:25.948_229+00:00 [17288] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:07:25.948_232+00:00 [17288] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:07:25.948_234+00:00 [17288] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:07:25.948_240+00:00 [17288] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:07:25.948_491+00:00 [17288] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42998 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:07:26.198_459+00:00 [17288] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:07:26.198_469+00:00 [17288] [INFO] session 2 got connection from 127.0.0.1:43000 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:07:26.198_549+00:00 [17288] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:07:26.198_553+00:00 [17288] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:07:26.198_699+00:00 [17288] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:07:26.198_704+00:00 [17288] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:07:26.198_772+00:00 [17316] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:07:26.198_776+00:00 [17316] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:07:26.198_785+00:00 [17316] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:07:26.198_800+00:00 [17316] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:07:26.198_806+00:00 [17316] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:07:26.198_830+00:00 [17316] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:07:26.198_961+00:00 [17316] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:07:26.198_980+00:00 [17316] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:07:26.199_044+00:00 [17316] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:07:26.199_049+00:00 [17316] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:07:26.199_057+00:00 [17316] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:07:45.941_262+00:00 [17303] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43000 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:07:47.213_132+00:00 [17303] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:07:47.213_156+00:00 [17303] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:07:47.213_164+00:00 [17303] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:07:47.213_240+00:00 [17303] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:07:47.213_282+00:00 [17303] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:07:47.213_722+00:00 [17303] [INFO] 0x7ff4dc002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:07:47.213_921+00:00 [17303] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:07:47.213_995+00:00 [17303] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:07:47.623_577+00:00 [17303] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:07:47.623_590+00:00 [17303] [INFO] session 3 got connection from 127.0.0.1:43002 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:07:47.623_664+00:00 [17303] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:07:47.623_671+00:00 [17303] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:07:47.623_881+00:00 [17303] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:07:47.623_903+00:00 [17303] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:07:47.623_912+00:00 [17303] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:07:47.623_924+00:00 [17303] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:07:47.624_129+00:00 [17303] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:07:47.624_285+00:00 [17316] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:07:47.624_304+00:00 [17316] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:07:47.624_318+00:00 [17316] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:08:05.012_374+00:00 [17316] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:08:05.012_387+00:00 [17316] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:08:05.012_411+00:00 [17316] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:08:05.012_416+00:00 [17316] [INFO] create snapshot idx 100000 log_term 2 done: 24 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:08:26.002_621+00:00 [17740] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:08:26.004_143+00:00 [17740] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:08:26.004_174+00:00 [17740] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:08:26.004_182+00:00 [17740] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:08:26.004_204+00:00 [17740] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:08:26.004_208+00:00 [17740] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:08:26.004_211+00:00 [17740] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:08:26.004_247+00:00 [17740] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:08:26.004_392+00:00 [17776] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:08:27.114_477+00:00 [17747] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:08:27.114_488+00:00 [17747] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:08:27.114_501+00:00 [17747] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:08:27.114_511+00:00 [17747] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:08:27.114_517+00:00 [17747] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:08:27.114_520+00:00 [17747] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:08:27.114_537+00:00 [17747] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:08:27.114_584+00:00 [17775] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:08:27.114_590+00:00 [17775] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:08:27.114_599+00:00 [17775] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:08:48.078_428+00:00 [17747] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:08:48.078_450+00:00 [17747] [INFO] session 1 got connection from 127.0.0.1:43004 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:08:48.078_547+00:00 [17747] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:08:48.078_569+00:00 [17747] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:08:48.078_627+00:00 [17747] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:08:48.078_631+00:00 [17747] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:08:48.078_633+00:00 [17747] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:08:48.078_638+00:00 [17747] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:08:48.078_915+00:00 [17747] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43004 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:08:48.328_905+00:00 [17747] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:08:48.328_915+00:00 [17747] [INFO] session 2 got connection from 127.0.0.1:43006 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:08:48.328_994+00:00 [17747] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:08:48.328_998+00:00 [17747] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:08:48.329_125+00:00 [17747] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:08:48.329_130+00:00 [17747] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:08:48.329_197+00:00 [17775] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:08:48.329_200+00:00 [17775] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:08:48.329_209+00:00 [17775] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:08:48.329_220+00:00 [17775] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:08:48.329_224+00:00 [17775] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:08:48.329_244+00:00 [17775] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:08:48.329_341+00:00 [17775] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:08:48.329_354+00:00 [17775] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:08:48.329_415+00:00 [17775] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:08:48.329_420+00:00 [17775] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:08:48.329_429+00:00 [17775] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:09:07.821_793+00:00 [17766] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43006 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:09:09.036_978+00:00 [17766] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:09:09.037_001+00:00 [17766] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:09:09.037_010+00:00 [17766] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:09:09.037_081+00:00 [17766] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:09:09.037_127+00:00 [17766] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:09:09.037_569+00:00 [17766] [INFO] 0x7fdfc4002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:09:09.037_767+00:00 [17766] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:09:09.037_839+00:00 [17766] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:09:09.061_092+00:00 [17766] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:09:09.061_104+00:00 [17766] [INFO] session 3 got connection from 127.0.0.1:43008 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:09:09.061_175+00:00 [17766] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:09:09.061_183+00:00 [17766] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:09:09.061_390+00:00 [17766] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:09:09.061_411+00:00 [17766] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:09:09.061_420+00:00 [17766] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:09:09.061_431+00:00 [17766] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:09:09.061_659+00:00 [17766] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:09:09.061_814+00:00 [17775] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:09:09.061_833+00:00 [17775] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:09:09.061_848+00:00 [17775] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:09:26.743_325+00:00 [17775] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:09:26.743_333+00:00 [17775] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:09:26.743_356+00:00 [17775] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:09:26.743_361+00:00 [17775] [INFO] create snapshot idx 100000 log_term 2 done: 22 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:09:47.882_923+00:00 [18184] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:09:47.884_279+00:00 [18184] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:09:47.884_315+00:00 [18184] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:09:47.884_321+00:00 [18184] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:09:47.884_347+00:00 [18184] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:09:47.884_351+00:00 [18184] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:09:47.884_354+00:00 [18184] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:09:47.884_384+00:00 [18184] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:09:47.884_531+00:00 [18220] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:09:49.401_590+00:00 [18191] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:09:49.401_601+00:00 [18191] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:09:49.401_616+00:00 [18191] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:09:49.401_627+00:00 [18191] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:09:49.401_633+00:00 [18191] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:09:49.401_637+00:00 [18191] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:09:49.401_656+00:00 [18191] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:09:49.401_708+00:00 [18219] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:09:49.401_716+00:00 [18219] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:09:49.401_726+00:00 [18219] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:10:09.955_915+00:00 [18191] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:10:09.955_936+00:00 [18191] [INFO] session 1 got connection from 127.0.0.1:43010 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:10:09.956_036+00:00 [18191] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:10:09.956_058+00:00 [18191] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:10:09.956_119+00:00 [18191] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:10:09.956_122+00:00 [18191] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:10:09.956_125+00:00 [18191] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:10:09.956_130+00:00 [18191] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:10:09.956_374+00:00 [18191] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43010 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:10:10.206_405+00:00 [18191] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:10:10.206_416+00:00 [18191] [INFO] session 2 got connection from 127.0.0.1:43012 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:10:10.206_496+00:00 [18191] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:10:10.206_500+00:00 [18191] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:10:10.206_626+00:00 [18191] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:10:10.206_630+00:00 [18191] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:10:10.206_713+00:00 [18219] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:10:10.206_716+00:00 [18219] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:10:10.206_724+00:00 [18219] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:10:10.206_736+00:00 [18219] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:10:10.206_740+00:00 [18219] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:10:10.206_760+00:00 [18219] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:10:10.206_850+00:00 [18219] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:10:10.206_861+00:00 [18219] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:10:10.206_911+00:00 [18219] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:10:10.206_915+00:00 [18219] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:10:10.206_923+00:00 [18219] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:10:29.198_585+00:00 [18207] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43012 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:10:29.822_403+00:00 [18202] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:10:29.822_416+00:00 [18202] [INFO] session 3 got connection from 127.0.0.1:43014 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:10:29.822_514+00:00 [18202] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:10:29.822_522+00:00 [18202] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:10:29.990_439+00:00 [18202] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:10:29.990_462+00:00 [18202] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:10:29.990_470+00:00 [18202] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:10:29.990_552+00:00 [18202] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:10:29.990_594+00:00 [18202] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:10:29.991_061+00:00 [18202] [INFO] 0x7f78b8014510 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:10:29.991_251+00:00 [18202] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:29.991_312+00:00 [18202] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:10:29.991_314+00:00 [18202] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:10:29.991_316+00:00 [18202] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:10:29.991_326+00:00 [18202] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:10:29.991_480+00:00 [18202] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:10:29.991_484+00:00 [18202] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:10:29.991_491+00:00 [18202] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:10:29.991_495+00:00 [18202] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:10:29.991_538+00:00 [18202] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:10:29.991_649+00:00 [18202] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:10:29.991_835+00:00 [18219] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:10:29.991_857+00:00 [18219] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:10:29.991_873+00:00 [18219] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:10:29.992_037+00:00 [18202] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:30.492_076+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:31.042_111+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:31.642_293+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:32.292_437+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:32.992_739+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:33.742_816+00:00 [18208] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:34.198_204+00:00 [18208] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:10:34.198_217+00:00 [18208] [INFO] session 4 got connection from 127.0.0.1:43016 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:10:34.198_652+00:00 [18204] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:10:34.198_725+00:00 [18215] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:34.198_928+00:00 [18204] [INFO] session 5 got connection from 127.0.0.1:43018 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:10:34.454_847+00:00 [18194] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:34.955_066+00:00 [18209] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:35.455_053+00:00 [18189] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:35.955_284+00:00 [18214] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:36.455_586+00:00 [18203] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:36.955_696+00:00 [18200] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:37.455_682+00:00 [18211] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:37.955_971+00:00 [18197] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:38.456_159+00:00 [18189] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:38.956_150+00:00 [18187] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:10:39.456_354+00:00 [18198] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:11:09.255_718+00:00 [18607] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:11:09.257_140+00:00 [18607] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:11:09.257_178+00:00 [18607] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:11:09.257_183+00:00 [18607] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:11:09.257_208+00:00 [18607] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:11:09.257_213+00:00 [18607] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:11:09.257_216+00:00 [18607] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:11:09.257_255+00:00 [18607] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:11:09.257_428+00:00 [18643] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:11:10.914_432+00:00 [18614] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:11:10.914_443+00:00 [18614] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:11:10.914_462+00:00 [18614] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:11:10.914_478+00:00 [18614] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:11:10.914_484+00:00 [18614] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:11:10.914_488+00:00 [18614] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:11:10.914_506+00:00 [18614] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:11:10.914_561+00:00 [18642] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:11:10.914_569+00:00 [18642] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:11:10.914_578+00:00 [18642] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:11:30.577_051+00:00 [18614] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:11:30.577_073+00:00 [18614] [INFO] session 1 got connection from 127.0.0.1:43020 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:11:30.577_179+00:00 [18614] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:11:30.577_203+00:00 [18614] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:11:30.577_263+00:00 [18614] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:11:30.577_267+00:00 [18614] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:11:30.577_269+00:00 [18614] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:11:30.577_274+00:00 [18614] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:11:30.577_521+00:00 [18614] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43020 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:11:30.828_867+00:00 [18614] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:11:30.828_885+00:00 [18614] [INFO] session 2 got connection from 127.0.0.1:43022 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:11:30.829_026+00:00 [18614] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:11:30.829_032+00:00 [18614] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:11:30.829_176+00:00 [18614] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:11:30.829_182+00:00 [18614] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:11:30.829_279+00:00 [18642] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:11:30.829_285+00:00 [18642] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:11:30.829_293+00:00 [18642] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:11:30.829_308+00:00 [18642] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:11:30.829_313+00:00 [18642] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:11:30.829_349+00:00 [18642] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:11:30.829_479+00:00 [18642] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:11:30.829_489+00:00 [18642] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:11:30.829_564+00:00 [18642] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:11:30.829_568+00:00 [18642] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:11:30.829_576+00:00 [18642] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:11:50.574_086+00:00 [18633] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43022 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:11:51.796_001+00:00 [18633] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:11:51.796_016+00:00 [18633] [INFO] session 3 got connection from 127.0.0.1:43024 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:11:51.796_126+00:00 [18611] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:11:51.796_134+00:00 [18611] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:11:51.802_022+00:00 [18633] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:11:51.802_035+00:00 [18633] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:11:51.802_040+00:00 [18633] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:11:51.802_097+00:00 [18633] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:11:51.802_134+00:00 [18633] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:11:51.802_469+00:00 [18633] [INFO] 0x7fa5dc013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:11:51.802_643+00:00 [18633] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:11:51.802_651+00:00 [18633] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:11:51.802_674+00:00 [18633] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:11:51.802_686+00:00 [18633] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:11:51.802_727+00:00 [18633] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-27T12:11:51.802_779+00:00 [18633] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:51.802_865+00:00 [18633] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:11:51.802_869+00:00 [18633] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:11:51.802_874+00:00 [18633] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:11:51.802_877+00:00 [18633] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:11:51.802_911+00:00 [18633] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:11:51.802_982+00:00 [18633] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:11:51.803_301+00:00 [18642] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:11:51.803_316+00:00 [18642] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:11:51.803_326+00:00 [18642] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:11:51.803_459+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:52.303_347+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:52.853_402+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:53.453_526+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:54.103_687+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:54.804_038+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:55.554_030+00:00 [18628] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:55.573_585+00:00 [18628] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:11:55.573_599+00:00 [18628] [INFO] session 4 got connection from 127.0.0.1:43026 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:11:55.573_904+00:00 [18610] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:11:55.573_916+00:00 [18610] [INFO] session 5 got connection from 127.0.0.1:43028 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:11:55.682_323+00:00 [18611] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:55.938_433+00:00 [18625] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:56.438_499+00:00 [18614] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:56.938_505+00:00 [18617] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:57.438_640+00:00 [18638] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:57.938_687+00:00 [18610] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:58.438_958+00:00 [18641] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:58.938_943+00:00 [18622] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:59.438_961+00:00 [18620] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:11:59.939_068+00:00 [18619] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:12:00.439_057+00:00 [18633] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:12:00.939_037+00:00 [18612] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:12:30.631_027+00:00 [19034] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:12:30.632_383+00:00 [19034] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:12:30.632_415+00:00 [19034] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:12:30.632_422+00:00 [19034] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:12:30.632_443+00:00 [19034] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:12:30.632_447+00:00 [19034] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:12:30.632_449+00:00 [19034] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:12:30.632_478+00:00 [19034] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:12:30.632_626+00:00 [19070] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:12:32.618_721+00:00 [19041] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:12:32.618_734+00:00 [19041] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:12:32.618_749+00:00 [19041] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:12:32.618_761+00:00 [19041] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:12:32.618_771+00:00 [19041] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:12:32.618_775+00:00 [19041] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:12:32.618_794+00:00 [19041] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:12:32.618_845+00:00 [19069] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:12:32.618_853+00:00 [19069] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:12:32.618_863+00:00 [19069] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:12:52.457_635+00:00 [19041] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:12:52.457_654+00:00 [19041] [INFO] session 1 got connection from 127.0.0.1:43030 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:12:52.457_754+00:00 [19041] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:12:52.457_777+00:00 [19041] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:12:52.457_835+00:00 [19041] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:12:52.457_839+00:00 [19041] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:12:52.457_841+00:00 [19041] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:12:52.457_846+00:00 [19041] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:12:52.458_081+00:00 [19041] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43030 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:12:52.708_286+00:00 [19041] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:12:52.708_297+00:00 [19041] [INFO] session 2 got connection from 127.0.0.1:43032 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:12:52.708_382+00:00 [19041] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:12:52.708_385+00:00 [19041] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:12:52.708_512+00:00 [19041] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:12:52.708_516+00:00 [19041] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:12:52.708_579+00:00 [19069] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:12:52.708_583+00:00 [19069] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:12:52.708_591+00:00 [19069] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:12:52.708_602+00:00 [19069] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:12:52.708_606+00:00 [19069] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:12:52.708_626+00:00 [19069] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:12:52.708_721+00:00 [19069] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:12:52.708_733+00:00 [19069] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:12:52.708_791+00:00 [19069] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:12:52.708_795+00:00 [19069] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:12:52.708_803+00:00 [19069] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:13:12.450_482+00:00 [19056] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43032 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:13:13.042_536+00:00 [19056] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:13:13.042_560+00:00 [19056] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:13:13.042_568+00:00 [19056] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:13:13.042_646+00:00 [19056] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:13:13.042_734+00:00 [19056] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:13:13.043_551+00:00 [19061] [INFO] 0x7fc940002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:13:13.043_746+00:00 [19061] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:13:13.043_815+00:00 [19061] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:13:13.230_420+00:00 [19061] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:13:13.230_434+00:00 [19061] [INFO] session 3 got connection from 127.0.0.1:43034 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:13:13.230_535+00:00 [19061] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:13:13.230_542+00:00 [19061] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:13:13.230_771+00:00 [19061] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:13:13.230_793+00:00 [19061] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:13:13.230_805+00:00 [19061] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:13:13.230_818+00:00 [19061] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:13:13.231_016+00:00 [19061] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:13:13.231_212+00:00 [19069] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:13:13.231_234+00:00 [19069] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:13:13.231_249+00:00 [19069] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:13:31.438_793+00:00 [19069] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:13:31.438_806+00:00 [19069] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:13:31.438_831+00:00 [19069] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:13:31.438_836+00:00 [19069] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:13:52.512_175+00:00 [19484] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:13:52.513_715+00:00 [19484] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:13:52.513_747+00:00 [19484] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:13:52.513_753+00:00 [19484] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:13:52.513_776+00:00 [19484] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:13:52.513_780+00:00 [19484] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:13:52.513_783+00:00 [19484] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:13:52.513_823+00:00 [19484] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:13:52.513_967+00:00 [19520] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:13:53.574_153+00:00 [19491] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:13:53.574_178+00:00 [19491] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:13:53.574_215+00:00 [19491] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:13:53.574_242+00:00 [19491] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:13:53.574_259+00:00 [19491] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:13:53.574_270+00:00 [19491] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:13:53.574_319+00:00 [19491] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:13:53.574_453+00:00 [19519] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:13:53.574_479+00:00 [19519] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:13:53.574_506+00:00 [19519] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:14:14.088_033+00:00 [19491] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:14:14.088_053+00:00 [19491] [INFO] session 1 got connection from 127.0.0.1:43036 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:14:14.088_154+00:00 [19491] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:14:14.088_177+00:00 [19491] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:14:14.088_238+00:00 [19491] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:14:14.088_241+00:00 [19491] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:14:14.088_243+00:00 [19491] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:14:14.088_248+00:00 [19491] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:14:14.088_484+00:00 [19491] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43036 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:14:14.338_706+00:00 [19491] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:14:14.338_718+00:00 [19491] [INFO] session 2 got connection from 127.0.0.1:43038 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:14:14.338_797+00:00 [19491] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:14:14.338_801+00:00 [19491] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:14:14.338_930+00:00 [19491] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:14:14.338_934+00:00 [19491] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:14:14.338_999+00:00 [19519] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:14:14.339_002+00:00 [19519] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:14:14.339_011+00:00 [19519] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:14:14.339_022+00:00 [19519] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:14:14.339_026+00:00 [19519] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:14:14.339_045+00:00 [19519] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:14:14.339_144+00:00 [19519] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:14:14.339_161+00:00 [19519] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:14:14.339_223+00:00 [19519] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:14:14.339_227+00:00 [19519] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:14:14.339_235+00:00 [19519] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:14:34.080_625+00:00 [19508] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43038 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:14:35.461_052+00:00 [19508] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:14:35.461_075+00:00 [19508] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:14:35.461_083+00:00 [19508] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:14:35.461_158+00:00 [19508] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:14:35.461_198+00:00 [19508] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:14:35.461_646+00:00 [19508] [INFO] 0x7f22a0002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:14:35.461_850+00:00 [19508] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:14:35.461_921+00:00 [19508] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:14:35.554_230+00:00 [19508] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:14:35.554_242+00:00 [19508] [INFO] session 3 got connection from 127.0.0.1:43040 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:14:35.554_317+00:00 [19508] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:14:35.554_325+00:00 [19508] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:14:35.554_534+00:00 [19508] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:14:35.554_555+00:00 [19508] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:14:35.554_564+00:00 [19508] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:14:35.554_577+00:00 [19508] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:14:35.554_844+00:00 [19508] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:14:35.555_046+00:00 [19519] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:14:35.555_069+00:00 [19519] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:14:35.555_086+00:00 [19519] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:14:53.197_202+00:00 [19519] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:14:53.197_211+00:00 [19519] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:14:53.197_234+00:00 [19519] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:14:53.197_239+00:00 [19519] [INFO] create snapshot idx 100000 log_term 2 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:15:14.142_124+00:00 [19932] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:15:14.143_581+00:00 [19932] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:15:14.143_609+00:00 [19932] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:15:14.143_617+00:00 [19932] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:15:14.143_639+00:00 [19932] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:15:14.143_643+00:00 [19932] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:15:14.143_646+00:00 [19932] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:15:14.143_677+00:00 [19932] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:15:14.143_917+00:00 [19968] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:15:16.114_883+00:00 [19939] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:15:16.114_895+00:00 [19939] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:15:16.114_911+00:00 [19939] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:15:16.114_927+00:00 [19939] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:15:16.114_934+00:00 [19939] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:15:16.114_938+00:00 [19939] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:15:16.114_958+00:00 [19939] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:15:16.115_012+00:00 [19967] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:15:16.115_021+00:00 [19967] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:15:16.115_032+00:00 [19967] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:15:35.961_564+00:00 [19939] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:15:35.961_584+00:00 [19939] [INFO] session 1 got connection from 127.0.0.1:43042 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:15:35.961_686+00:00 [19939] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:15:35.961_708+00:00 [19939] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:15:35.961_769+00:00 [19939] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:15:35.961_773+00:00 [19939] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:15:35.961_775+00:00 [19939] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:15:35.961_780+00:00 [19939] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:15:35.962_020+00:00 [19939] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43042 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:15:36.212_251+00:00 [19939] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:15:36.212_262+00:00 [19939] [INFO] session 2 got connection from 127.0.0.1:43044 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:15:36.212_345+00:00 [19939] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:15:36.212_348+00:00 [19939] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:15:36.212_475+00:00 [19939] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:15:36.212_479+00:00 [19939] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:15:36.212_541+00:00 [19967] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:15:36.212_545+00:00 [19967] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:15:36.212_553+00:00 [19967] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:15:36.212_564+00:00 [19967] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:15:36.212_568+00:00 [19967] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:15:36.212_589+00:00 [19967] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:15:36.212_684+00:00 [19967] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:15:36.212_697+00:00 [19967] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:15:36.212_758+00:00 [19967] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:15:36.212_763+00:00 [19967] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:15:36.212_772+00:00 [19967] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:15:55.960_509+00:00 [19959] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43044 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:15:56.933_352+00:00 [19959] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:15:56.933_383+00:00 [19959] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:15:56.933_391+00:00 [19959] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:15:56.933_458+00:00 [19959] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:15:56.933_500+00:00 [19959] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:15:56.933_937+00:00 [19959] [INFO] 0x7f6448002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:15:56.934_166+00:00 [19935] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:15:56.934_227+00:00 [19935] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:15:57.446_255+00:00 [19935] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:15:57.446_269+00:00 [19935] [INFO] session 3 got connection from 127.0.0.1:43046 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:15:57.446_372+00:00 [19935] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:15:57.446_379+00:00 [19935] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:15:57.446_569+00:00 [19935] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:15:57.446_592+00:00 [19935] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:15:57.446_601+00:00 [19935] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:15:57.446_615+00:00 [19935] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:15:57.446_841+00:00 [19935] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:15:57.447_021+00:00 [19967] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:15:57.447_040+00:00 [19967] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:15:57.447_054+00:00 [19967] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:16:14.924_704+00:00 [19967] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:16:14.924_717+00:00 [19967] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:16:14.924_743+00:00 [19967] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:16:14.924_748+00:00 [19967] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:30:12.257_966+00:00 [23296] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:30:12.259_333+00:00 [23296] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:30:12.259_364+00:00 [23296] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:30:12.259_370+00:00 [23296] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:30:12.259_394+00:00 [23296] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:30:12.259_398+00:00 [23296] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:30:12.259_401+00:00 [23296] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:30:12.259_431+00:00 [23296] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:30:12.259_571+00:00 [23332] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:30:14.274_619+00:00 [23303] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:30:14.274_632+00:00 [23303] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:30:14.274_647+00:00 [23303] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:30:14.274_674+00:00 [23303] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:30:14.274_683+00:00 [23303] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:30:14.274_691+00:00 [23303] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:30:14.274_712+00:00 [23303] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:30:14.274_764+00:00 [23331] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:30:14.274_772+00:00 [23331] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:30:14.274_782+00:00 [23331] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:30:33.834_145+00:00 [23303] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:30:33.834_165+00:00 [23303] [INFO] session 1 got connection from 127.0.0.1:43048 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:30:33.834_267+00:00 [23303] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:30:33.834_290+00:00 [23303] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:30:33.834_354+00:00 [23303] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:30:33.834_357+00:00 [23303] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:30:33.834_359+00:00 [23303] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:30:33.834_365+00:00 [23303] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:30:33.834_608+00:00 [23303] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43048 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:30:34.084_852+00:00 [23303] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:30:34.084_876+00:00 [23303] [INFO] session 2 got connection from 127.0.0.1:43050 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:30:34.084_976+00:00 [23303] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:30:34.084_980+00:00 [23303] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:30:34.085_108+00:00 [23303] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:30:34.085_112+00:00 [23303] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:30:34.085_178+00:00 [23331] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:30:34.085_181+00:00 [23331] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:30:34.085_190+00:00 [23331] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:30:34.085_201+00:00 [23331] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:30:34.085_206+00:00 [23331] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:30:34.085_226+00:00 [23331] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:30:34.085_324+00:00 [23331] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:30:34.085_336+00:00 [23331] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:30:34.085_394+00:00 [23331] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:30:34.085_398+00:00 [23331] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:30:34.085_407+00:00 [23331] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:30:54.077_916+00:00 [23326] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43050 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:30:54.813_520+00:00 [23326] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:30:54.813_533+00:00 [23326] [INFO] session 3 got connection from 127.0.0.1:43052 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:30:54.813_635+00:00 [23326] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:30:54.813_643+00:00 [23326] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:30:55.245_412+00:00 [23326] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:30:55.245_435+00:00 [23326] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:30:55.245_443+00:00 [23326] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:30:55.245_528+00:00 [23326] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:30:55.245_567+00:00 [23326] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:30:55.246_014+00:00 [23326] [INFO] 0x7f79e8013d30 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:30:55.246_230+00:00 [23326] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:30:55.246_238+00:00 [23326] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:30:55.246_240+00:00 [23326] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:30:55.246_251+00:00 [23326] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:30:55.246_293+00:00 [23326] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-27T12:30:55.246_349+00:00 [23326] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:55.246_435+00:00 [23326] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:30:55.246_439+00:00 [23326] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:30:55.246_446+00:00 [23326] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:30:55.246_449+00:00 [23326] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:30:55.246_482+00:00 [23326] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:30:55.246_589+00:00 [23326] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:30:55.246_898+00:00 [23331] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:30:55.246_919+00:00 [23331] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:30:55.246_930+00:00 [23331] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:30:55.247_063+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:55.747_006+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:56.297_113+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:56.897_224+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:57.547_395+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:58.247_796+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:58.997_750+00:00 [23302] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:59.077_586+00:00 [23302] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:30:59.077_601+00:00 [23302] [INFO] session 4 got connection from 127.0.0.1:43054 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:30:59.077_919+00:00 [23316] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:30:59.077_930+00:00 [23316] [INFO] session 5 got connection from 127.0.0.1:43056 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:30:59.126_135+00:00 [23305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:59.382_120+00:00 [23320] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:30:59.882_437+00:00 [23313] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:00.382_481+00:00 [23324] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:00.882_607+00:00 [23307] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:01.382_898+00:00 [23320] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:01.883_142+00:00 [23330] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:02.383_181+00:00 [23317] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:02.883_244+00:00 [23310] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:03.383_495+00:00 [23330] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:03.883_529+00:00 [23320] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:31:04.383_519+00:00 [23299] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:31:34.126_941+00:00 [23496] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:31:34.128_377+00:00 [23496] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:31:34.128_409+00:00 [23496] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:31:34.128_415+00:00 [23496] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:31:34.128_439+00:00 [23496] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:31:34.128_443+00:00 [23496] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:31:34.128_446+00:00 [23496] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:31:34.128_476+00:00 [23496] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:31:34.128_632+00:00 [23532] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:31:35.887_693+00:00 [23503] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:31:35.887_706+00:00 [23503] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:31:35.887_721+00:00 [23503] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:31:35.887_738+00:00 [23503] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:31:35.887_744+00:00 [23503] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:31:35.887_749+00:00 [23503] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:31:35.887_768+00:00 [23503] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:31:35.887_821+00:00 [23531] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:31:35.887_828+00:00 [23531] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:31:35.887_838+00:00 [23531] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:31:56.199_641+00:00 [23503] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:31:56.199_681+00:00 [23503] [INFO] session 1 got connection from 127.0.0.1:43058 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:31:56.199_763+00:00 [23503] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:31:56.199_781+00:00 [23503] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:31:56.199_837+00:00 [23503] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:31:56.199_840+00:00 [23503] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:31:56.199_842+00:00 [23503] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:31:56.199_847+00:00 [23503] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:31:56.200_158+00:00 [23506] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43058 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:31:56.450_215+00:00 [23506] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:31:56.450_225+00:00 [23506] [INFO] session 2 got connection from 127.0.0.1:43060 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:31:56.450_299+00:00 [23506] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:31:56.450_302+00:00 [23506] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:31:56.450_433+00:00 [23506] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:31:56.450_441+00:00 [23506] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:31:56.450_506+00:00 [23531] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:31:56.450_509+00:00 [23531] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:31:56.450_517+00:00 [23531] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:31:56.450_529+00:00 [23531] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:31:56.450_533+00:00 [23531] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:31:56.450_554+00:00 [23531] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:31:56.450_646+00:00 [23531] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:31:56.450_679+00:00 [23531] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:31:56.450_743+00:00 [23531] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:31:56.450_748+00:00 [23531] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:31:56.450_757+00:00 [23531] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:32:15.442_559+00:00 [23520] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43060 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:32:16.038_055+00:00 [23520] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:32:16.038_069+00:00 [23520] [INFO] session 3 got connection from 127.0.0.1:43062 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:32:16.038_170+00:00 [23520] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:32:16.038_178+00:00 [23520] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:32:16.441_207+00:00 [23520] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:32:16.441_233+00:00 [23520] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:32:16.441_243+00:00 [23520] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:32:16.441_336+00:00 [23520] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:32:16.441_380+00:00 [23520] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:32:16.441_865+00:00 [23520] [INFO] 0x7f5d38013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:32:16.442_077+00:00 [23520] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:16.442_140+00:00 [23520] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:32:16.442_143+00:00 [23520] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:32:16.442_145+00:00 [23520] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:32:16.442_155+00:00 [23520] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:32:16.442_322+00:00 [23500] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:32:16.442_327+00:00 [23500] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:32:16.442_335+00:00 [23500] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:32:16.442_339+00:00 [23500] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:32:16.442_385+00:00 [23500] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:32:16.442_511+00:00 [23500] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:32:16.442_723+00:00 [23531] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:32:16.442_745+00:00 [23531] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:32:16.442_761+00:00 [23531] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:32:16.442_933+00:00 [23500] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:16.942_876+00:00 [23500] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:17.493_039+00:00 [23521] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:18.093_156+00:00 [23521] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:18.743_351+00:00 [23521] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:19.443_685+00:00 [23519] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:20.193_592+00:00 [23519] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:20.442_130+00:00 [23519] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:32:20.442_144+00:00 [23519] [INFO] session 4 got connection from 127.0.0.1:43064 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:32:20.442_500+00:00 [23501] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:32:20.442_510+00:00 [23501] [INFO] session 5 got connection from 127.0.0.1:43066 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:32:20.443_067+00:00 [23510] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:20.699_063+00:00 [23517] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:21.199_072+00:00 [23514] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:21.699_110+00:00 [23501] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:22.199_441+00:00 [23521] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:22.699_576+00:00 [23504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:23.199_713+00:00 [23503] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:23.699_822+00:00 [23528] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:24.200_035+00:00 [23524] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:24.700_100+00:00 [23511] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:25.200_074+00:00 [23501] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:32:25.700_221+00:00 [23525] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:32:55.500_150+00:00 [23667] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:32:55.501_484+00:00 [23667] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:32:55.501_518+00:00 [23667] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:32:55.501_522+00:00 [23667] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:32:55.501_547+00:00 [23667] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:32:55.501_551+00:00 [23667] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:32:55.501_554+00:00 [23667] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:32:55.501_590+00:00 [23667] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:32:55.501_734+00:00 [23703] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:32:57.230_926+00:00 [23674] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:32:57.230_938+00:00 [23674] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:32:57.230_953+00:00 [23674] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:32:57.230_964+00:00 [23674] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:32:57.230_971+00:00 [23674] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:32:57.230_975+00:00 [23674] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:32:57.230_995+00:00 [23674] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:32:57.231_048+00:00 [23702] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:32:57.231_057+00:00 [23702] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:32:57.231_068+00:00 [23702] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:33:17.576_012+00:00 [23674] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:17.576_032+00:00 [23674] [INFO] session 1 got connection from 127.0.0.1:43070 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:33:17.576_130+00:00 [23674] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:33:17.576_153+00:00 [23674] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:33:17.576_211+00:00 [23674] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:33:17.576_215+00:00 [23674] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:33:17.576_216+00:00 [23674] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:33:17.576_222+00:00 [23674] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:33:17.576_458+00:00 [23674] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43070 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:33:17.826_553+00:00 [23674] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:17.826_564+00:00 [23674] [INFO] session 2 got connection from 127.0.0.1:43074 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:33:17.826_644+00:00 [23674] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:33:17.826_648+00:00 [23674] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:33:17.826_796+00:00 [23674] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:33:17.826_800+00:00 [23674] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:33:17.826_866+00:00 [23702] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:33:17.826_870+00:00 [23702] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:33:17.826_878+00:00 [23702] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:33:17.826_888+00:00 [23702] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:33:17.826_892+00:00 [23702] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:33:17.826_912+00:00 [23702] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:33:17.827_009+00:00 [23702] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:33:17.827_021+00:00 [23702] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:33:17.827_081+00:00 [23702] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:33:17.827_086+00:00 [23702] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:33:17.827_095+00:00 [23702] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:33:37.320_413+00:00 [23670] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43074 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:33:38.254_883+00:00 [23670] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:38.254_898+00:00 [23670] [INFO] session 3 got connection from 127.0.0.1:43076 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:33:38.255_024+00:00 [23690] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:33:38.255_033+00:00 [23690] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:33:38.354_347+00:00 [23670] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:33:38.354_372+00:00 [23670] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:33:38.354_380+00:00 [23670] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:33:38.354_462+00:00 [23670] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:33:38.354_502+00:00 [23670] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:33:38.354_982+00:00 [23670] [INFO] 0x7f4308013c50 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:33:38.355_193+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:38.355_263+00:00 [23670] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:33:38.355_266+00:00 [23670] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:33:38.355_268+00:00 [23670] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:33:38.355_278+00:00 [23670] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:33:38.355_438+00:00 [23670] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:33:38.355_442+00:00 [23670] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:33:38.355_449+00:00 [23670] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:33:38.355_454+00:00 [23670] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:33:38.355_504+00:00 [23670] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:33:38.355_608+00:00 [23670] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:33:38.355_763+00:00 [23702] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:33:38.355_780+00:00 [23702] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:33:38.355_793+00:00 [23702] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:33:38.355_924+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:38.856_034+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:39.406_158+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:40.006_335+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:40.656_482+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:41.356_842+00:00 [23670] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:42.106_861+00:00 [23682] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:42.320_030+00:00 [23682] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:42.320_045+00:00 [23682] [INFO] session 4 got connection from 127.0.0.1:43078 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:33:42.320_425+00:00 [23679] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:42.320_436+00:00 [23679] [INFO] session 5 got connection from 127.0.0.1:43080 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:33:42.321_269+00:00 [23690] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:42.576_705+00:00 [23682] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:43.076_884+00:00 [23688] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:43.576_957+00:00 [23677] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:44.077_195+00:00 [23698] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:44.577_252+00:00 [23690] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:45.077_257+00:00 [23682] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:45.577_554+00:00 [23674] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:46.077_786+00:00 [23686] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:46.577_827+00:00 [23687] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:47.078_135+00:00 [23694] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:33:47.578_160+00:00 [23684] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:33:50.186_903+00:00 [23695] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:33:50.186_919+00:00 [23695] [INFO] session 6 got connection from 127.0.0.1:43082 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:34:17.378_955+00:00 [23868] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:34:17.380_374+00:00 [23868] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:34:17.380_407+00:00 [23868] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:34:17.380_411+00:00 [23868] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:34:17.380_434+00:00 [23868] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:34:17.380_438+00:00 [23868] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:34:17.380_441+00:00 [23868] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:34:17.380_470+00:00 [23868] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:34:17.380_618+00:00 [23904] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:34:18.938_771+00:00 [23875] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:34:18.938_781+00:00 [23875] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:34:18.938_796+00:00 [23875] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:34:18.938_812+00:00 [23875] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:34:18.938_819+00:00 [23875] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:34:18.938_822+00:00 [23875] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:34:18.938_840+00:00 [23875] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:34:18.938_889+00:00 [23903] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:34:18.938_896+00:00 [23903] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:34:18.938_907+00:00 [23903] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:34:38.954_070+00:00 [23875] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:34:38.954_091+00:00 [23875] [INFO] session 1 got connection from 127.0.0.1:43084 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:34:38.954_193+00:00 [23875] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:34:38.954_215+00:00 [23875] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:34:38.954_274+00:00 [23875] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:34:38.954_277+00:00 [23875] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:34:38.954_280+00:00 [23875] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:34:38.954_285+00:00 [23875] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:34:38.954_522+00:00 [23875] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43084 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:34:39.204_801+00:00 [23875] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:34:39.204_812+00:00 [23875] [INFO] session 2 got connection from 127.0.0.1:43086 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:34:39.204_892+00:00 [23875] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:34:39.204_896+00:00 [23875] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:34:39.205_021+00:00 [23875] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:34:39.205_026+00:00 [23875] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:34:39.205_089+00:00 [23903] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:34:39.205_092+00:00 [23903] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:34:39.205_100+00:00 [23903] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:34:39.205_111+00:00 [23903] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:34:39.205_115+00:00 [23903] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:34:39.205_135+00:00 [23903] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:34:39.205_229+00:00 [23903] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:34:39.205_242+00:00 [23903] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:34:39.205_298+00:00 [23903] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:34:39.205_302+00:00 [23903] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:34:39.205_310+00:00 [23903] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:36:55.229_611+00:00 [24137] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:36:55.231_033+00:00 [24137] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:36:55.231_067+00:00 [24137] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:36:55.231_073+00:00 [24137] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:36:55.231_097+00:00 [24137] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:36:55.231_101+00:00 [24137] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:36:55.231_103+00:00 [24137] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:36:55.231_137+00:00 [24137] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:36:55.231_286+00:00 [24173] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:36:56.927_328+00:00 [24144] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:36:56.927_339+00:00 [24144] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:36:56.927_353+00:00 [24144] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:36:56.927_364+00:00 [24144] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:36:56.927_371+00:00 [24144] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:36:56.927_374+00:00 [24144] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:36:56.927_393+00:00 [24144] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:36:56.927_444+00:00 [24172] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:36:56.927_452+00:00 [24172] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:36:56.927_463+00:00 [24172] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:37:17.305_643+00:00 [24144] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:37:17.305_665+00:00 [24144] [INFO] session 1 got connection from 127.0.0.1:43088 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:37:17.305_769+00:00 [24144] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:37:17.305_789+00:00 [24144] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:37:17.305_850+00:00 [24144] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:37:17.305_853+00:00 [24144] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:37:17.305_856+00:00 [24144] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:37:17.305_862+00:00 [24144] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:37:17.306_088+00:00 [24144] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43088 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:37:17.556_217+00:00 [24144] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:37:17.556_229+00:00 [24144] [INFO] session 2 got connection from 127.0.0.1:43090 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:37:17.556_313+00:00 [24144] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:37:17.556_316+00:00 [24144] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:37:17.556_444+00:00 [24144] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:37:17.556_448+00:00 [24144] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:37:17.556_513+00:00 [24172] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:37:17.556_517+00:00 [24172] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:37:17.556_525+00:00 [24172] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:37:17.556_537+00:00 [24172] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:37:17.556_542+00:00 [24172] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:37:17.556_563+00:00 [24172] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:37:17.556_662+00:00 [24172] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:37:17.556_675+00:00 [24172] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:37:17.556_741+00:00 [24172] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:37:17.556_746+00:00 [24172] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:37:17.556_755+00:00 [24172] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:37:36.798_717+00:00 [24161] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43090 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:37:37.713_725+00:00 [24161] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:37:37.713_750+00:00 [24161] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:37:37.713_759+00:00 [24161] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:37:37.713_840+00:00 [24161] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:37:37.713_895+00:00 [24161] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:37:37.714_369+00:00 [24161] [INFO] 0x7f3fc4002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:37:37.714_572+00:00 [24161] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:37:37.714_636+00:00 [24161] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:37:38.509_805+00:00 [24161] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:37:38.509_819+00:00 [24161] [INFO] session 3 got connection from 127.0.0.1:43092 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:37:38.509_900+00:00 [24161] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:37:38.509_908+00:00 [24161] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:37:38.510_131+00:00 [24140] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:37:38.510_154+00:00 [24140] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:37:38.510_162+00:00 [24140] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:37:38.510_173+00:00 [24140] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:37:38.510_411+00:00 [24140] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:37:38.510_629+00:00 [24172] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:37:38.510_653+00:00 [24172] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:37:38.510_686+00:00 [24172] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:37:55.819_621+00:00 [24172] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:37:55.819_634+00:00 [24172] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:37:55.819_659+00:00 [24172] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:37:55.819_665+00:00 [24172] [INFO] create snapshot idx 100000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:39:36.913_237+00:00 [24931] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:39:36.915_325+00:00 [24931] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:39:36.915_359+00:00 [24931] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:39:36.915_363+00:00 [24931] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:39:36.915_387+00:00 [24931] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:39:36.915_391+00:00 [24931] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:39:36.915_394+00:00 [24931] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:39:36.915_422+00:00 [24931] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:39:36.915_573+00:00 [24967] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:39:38.536_601+00:00 [24938] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:39:38.536_610+00:00 [24938] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:39:38.536_623+00:00 [24938] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:39:38.536_633+00:00 [24938] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:39:38.536_639+00:00 [24938] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:39:38.536_643+00:00 [24938] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:39:38.536_659+00:00 [24938] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:39:38.536_704+00:00 [24966] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:39:38.536_710+00:00 [24966] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:39:38.536_719+00:00 [24966] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:39:58.738_327+00:00 [24938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:39:58.738_352+00:00 [24938] [INFO] session 1 got connection from 127.0.0.1:43094 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:39:58.738_465+00:00 [24938] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:39:58.738_490+00:00 [24938] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:39:58.738_556+00:00 [24938] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:39:58.738_559+00:00 [24938] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:39:58.738_562+00:00 [24938] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:39:58.738_568+00:00 [24938] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:39:58.738_843+00:00 [24938] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43094 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:39:58.988_892+00:00 [24938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:39:58.988_901+00:00 [24938] [INFO] session 2 got connection from 127.0.0.1:43096 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:39:58.988_975+00:00 [24938] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:39:58.988_978+00:00 [24938] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:39:58.989_099+00:00 [24938] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:39:58.989_103+00:00 [24938] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:39:58.989_162+00:00 [24966] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:39:58.989_165+00:00 [24966] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:39:58.989_172+00:00 [24966] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:39:58.989_183+00:00 [24966] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:39:58.989_186+00:00 [24966] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:39:58.989_204+00:00 [24966] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:39:58.989_288+00:00 [24966] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:39:58.989_299+00:00 [24966] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:39:58.989_345+00:00 [24966] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:39:58.989_349+00:00 [24966] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:39:58.989_356+00:00 [24966] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:40:18.230_230+00:00 [24957] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43096 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:40:19.260_528+00:00 [24957] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:40:19.260_551+00:00 [24957] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:40:19.260_558+00:00 [24957] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:40:19.260_635+00:00 [24957] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:40:19.260_676+00:00 [24957] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:40:19.261_090+00:00 [24957] [INFO] 0x7f3f38002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:40:19.261_289+00:00 [24957] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:40:19.261_362+00:00 [24957] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:40:19.748_044+00:00 [24935] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:40:19.748_064+00:00 [24935] [INFO] session 3 got connection from 127.0.0.1:43098 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:40:19.748_232+00:00 [24935] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:40:19.748_241+00:00 [24935] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:40:19.748_453+00:00 [24935] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:40:19.748_486+00:00 [24935] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:40:19.748_495+00:00 [24935] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:40:19.748_508+00:00 [24935] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:40:19.748_761+00:00 [24935] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:40:19.748_998+00:00 [24966] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:40:19.749_020+00:00 [24966] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:40:19.749_036+00:00 [24966] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:40:37.247_044+00:00 [24966] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:40:37.247_052+00:00 [24966] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:40:37.247_074+00:00 [24966] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:40:37.247_078+00:00 [24966] [INFO] create snapshot idx 100000 log_term 2 done: 22 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:40:58.294_165+00:00 [25321] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:40:58.295_598+00:00 [25321] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:40:58.295_630+00:00 [25321] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:40:58.295_636+00:00 [25321] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:40:58.295_661+00:00 [25321] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:40:58.295_666+00:00 [25321] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:40:58.295_669+00:00 [25321] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:40:58.295_709+00:00 [25321] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:40:58.295_860+00:00 [25357] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:41:00.043_936+00:00 [25328] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:41:00.043_948+00:00 [25328] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:41:00.043_962+00:00 [25328] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:41:00.043_978+00:00 [25328] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:41:00.043_985+00:00 [25328] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:41:00.043_989+00:00 [25328] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:41:00.044_008+00:00 [25328] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:41:00.044_060+00:00 [25356] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:41:00.044_068+00:00 [25356] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:41:00.044_078+00:00 [25356] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:41:20.119_968+00:00 [25328] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:41:20.119_992+00:00 [25328] [INFO] session 1 got connection from 127.0.0.1:43100 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:41:20.120_106+00:00 [25328] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:41:20.120_130+00:00 [25328] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:41:20.120_195+00:00 [25328] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:41:20.120_198+00:00 [25328] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:41:20.120_201+00:00 [25328] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:41:20.120_207+00:00 [25328] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:41:20.120_459+00:00 [25328] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43100 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:41:20.370_617+00:00 [25328] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:41:20.370_628+00:00 [25328] [INFO] session 2 got connection from 127.0.0.1:43102 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:41:20.370_734+00:00 [25328] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:41:20.370_738+00:00 [25328] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:41:20.370_868+00:00 [25328] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:41:20.370_872+00:00 [25328] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:41:20.370_937+00:00 [25356] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:41:20.370_941+00:00 [25356] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:41:20.370_949+00:00 [25356] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:41:20.370_960+00:00 [25356] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:41:20.370_964+00:00 [25356] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:41:20.370_986+00:00 [25356] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:41:20.371_082+00:00 [25356] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:41:20.371_094+00:00 [25356] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:41:20.371_153+00:00 [25356] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:41:20.371_157+00:00 [25356] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:41:20.371_166+00:00 [25356] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:41:39.863_509+00:00 [25339] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43102 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:41:40.780_767+00:00 [25339] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:41:40.780_804+00:00 [25339] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:41:40.780_816+00:00 [25339] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:41:40.780_946+00:00 [25339] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:41:40.781_013+00:00 [25339] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:41:40.781_668+00:00 [25339] [INFO] 0x7f9b10002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:41:40.781_954+00:00 [25339] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:41:40.782_051+00:00 [25339] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:41:41.202_417+00:00 [25339] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:41:41.202_431+00:00 [25339] [INFO] session 3 got connection from 127.0.0.1:43104 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:41:41.202_507+00:00 [25339] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:41:41.202_516+00:00 [25339] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:41:41.202_774+00:00 [25339] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:41:41.202_796+00:00 [25339] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:41:41.202_805+00:00 [25339] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:41:41.202_821+00:00 [25339] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:41:41.203_058+00:00 [25339] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:41:41.203_246+00:00 [25356] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:41:41.203_267+00:00 [25356] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:41:41.203_283+00:00 [25356] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:41:53.382_725+00:00 [25356] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:41:53.382_733+00:00 [25356] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:41:53.382_757+00:00 [25356] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:41:53.382_762+00:00 [25356] [INFO] create snapshot idx 100000 log_term 2 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:42:01.911_555+00:00 [25356] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:42:01.911_567+00:00 [25356] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:42:01.911_594+00:00 [25356] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:42:01.911_599+00:00 [25356] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:42:19.938_397+00:00 [25675] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:42:19.939_787+00:00 [25675] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:42:19.939_819+00:00 [25675] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:42:19.939_826+00:00 [25675] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:42:19.939_864+00:00 [25675] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:42:19.939_868+00:00 [25675] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:42:19.939_871+00:00 [25675] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:42:19.939_912+00:00 [25675] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:42:19.940_059+00:00 [25711] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:42:21.844_138+00:00 [25682] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:42:21.844_150+00:00 [25682] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:42:21.844_165+00:00 [25682] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:42:21.844_182+00:00 [25682] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:42:21.844_189+00:00 [25682] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:42:21.844_193+00:00 [25682] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:42:21.844_211+00:00 [25682] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:42:21.844_270+00:00 [25710] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:42:21.844_278+00:00 [25710] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:42:21.844_289+00:00 [25710] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:42:27.734_775+00:00 [25778] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:42:27.736_131+00:00 [25778] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:42:27.736_164+00:00 [25778] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:42:27.736_170+00:00 [25778] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:42:27.736_195+00:00 [25778] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:42:27.736_199+00:00 [25778] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:42:27.736_202+00:00 [25778] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:42:27.736_232+00:00 [25778] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:42:27.736_467+00:00 [25814] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:42:29.769_417+00:00 [25785] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:42:29.769_427+00:00 [25785] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:42:29.769_440+00:00 [25785] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:42:29.769_450+00:00 [25785] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:42:29.769_456+00:00 [25785] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:42:29.769_460+00:00 [25785] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:42:29.769_477+00:00 [25785] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:42:29.769_520+00:00 [25813] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:42:29.769_527+00:00 [25813] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:42:29.769_535+00:00 [25813] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:42:49.050_709+00:00 [25785] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:42:49.050_733+00:00 [25785] [INFO] session 1 got connection from 127.0.0.1:43106 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:42:49.050_841+00:00 [25785] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:42:49.050_865+00:00 [25785] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:42:49.050_929+00:00 [25785] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:42:49.050_933+00:00 [25785] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:42:49.050_935+00:00 [25785] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:42:49.050_940+00:00 [25785] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:42:49.051_188+00:00 [25785] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43106 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:42:49.301_397+00:00 [25785] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:42:49.301_409+00:00 [25785] [INFO] session 2 got connection from 127.0.0.1:43108 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:42:49.301_492+00:00 [25785] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:42:49.301_495+00:00 [25785] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:42:49.301_623+00:00 [25785] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:42:49.301_628+00:00 [25785] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:42:49.301_693+00:00 [25813] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:42:49.301_697+00:00 [25813] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:42:49.301_705+00:00 [25813] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:42:49.301_717+00:00 [25813] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:42:49.301_720+00:00 [25813] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:42:49.301_740+00:00 [25813] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:42:49.301_847+00:00 [25813] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:42:49.301_861+00:00 [25813] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:42:49.301_914+00:00 [25813] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:42:49.301_918+00:00 [25813] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:42:49.301_925+00:00 [25813] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:43:09.301_581+00:00 [25808] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43108 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:43:10.108_241+00:00 [25808] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:43:10.108_263+00:00 [25808] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:43:10.108_272+00:00 [25808] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:43:10.108_347+00:00 [25808] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:43:10.108_391+00:00 [25808] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:43:10.108_853+00:00 [25808] [INFO] 0x7f6ae0002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:43:10.109_045+00:00 [25808] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:43:10.109_118+00:00 [25808] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:43:10.371_113+00:00 [25808] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:43:10.371_128+00:00 [25808] [INFO] session 3 got connection from 127.0.0.1:43110 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:43:10.371_210+00:00 [25808] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:43:10.371_218+00:00 [25808] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:43:10.371_425+00:00 [25808] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:43:10.371_450+00:00 [25808] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:43:10.371_460+00:00 [25808] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:43:10.371_471+00:00 [25808] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:43:10.371_678+00:00 [25808] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:43:10.371_900+00:00 [25813] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:43:10.371_923+00:00 [25813] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:43:10.371_938+00:00 [25813] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:43:28.329_704+00:00 [25813] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:43:28.329_712+00:00 [25813] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:43:28.329_736+00:00 [25813] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:43:28.329_741+00:00 [25813] [INFO] create snapshot idx 100000 log_term 2 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:43:49.363_637+00:00 [26138] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:43:49.365_041+00:00 [26138] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:43:49.365_073+00:00 [26138] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:43:49.365_081+00:00 [26138] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:43:49.365_104+00:00 [26138] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:43:49.365_109+00:00 [26138] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:43:49.365_112+00:00 [26138] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:43:49.365_140+00:00 [26138] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:43:49.365_291+00:00 [26174] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:43:51.397_343+00:00 [26145] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:43:51.397_354+00:00 [26145] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:43:51.397_369+00:00 [26145] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:43:51.397_380+00:00 [26145] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:43:51.397_385+00:00 [26145] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:43:51.397_389+00:00 [26145] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:43:51.397_408+00:00 [26145] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:43:51.397_456+00:00 [26173] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:43:51.397_464+00:00 [26173] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:43:51.397_474+00:00 [26173] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:44:11.191_215+00:00 [26145] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:11.191_235+00:00 [26145] [INFO] session 1 got connection from 127.0.0.1:43112 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:11.191_342+00:00 [26145] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:44:11.191_368+00:00 [26145] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:44:11.191_431+00:00 [26145] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:44:11.191_435+00:00 [26145] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:44:11.191_437+00:00 [26145] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:44:11.191_447+00:00 [26145] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:44:11.191_650+00:00 [26145] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43112 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:44:11.442_180+00:00 [26145] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:11.442_191+00:00 [26145] [INFO] session 2 got connection from 127.0.0.1:43114 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:11.442_268+00:00 [26145] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:44:11.442_272+00:00 [26145] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:44:11.442_397+00:00 [26145] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:44:11.442_402+00:00 [26145] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:44:11.442_467+00:00 [26173] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:44:11.442_470+00:00 [26173] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:44:11.442_479+00:00 [26173] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:44:11.442_490+00:00 [26173] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:44:11.442_494+00:00 [26173] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:44:11.442_514+00:00 [26173] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:44:11.442_608+00:00 [26173] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:44:11.442_621+00:00 [26173] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:44:11.442_693+00:00 [26173] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:44:11.442_697+00:00 [26173] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:44:11.442_706+00:00 [26173] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:44:30.932_475+00:00 [26147] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43114 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:44:32.238_999+00:00 [26147] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:32.239_013+00:00 [26147] [INFO] session 3 got connection from 127.0.0.1:43116 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:32.239_127+00:00 [26141] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:44:32.239_136+00:00 [26141] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:44:32.388_882+00:00 [26147] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:44:32.388_904+00:00 [26147] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:44:32.388_911+00:00 [26147] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:44:32.388_994+00:00 [26147] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:44:32.389_032+00:00 [26147] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:44:32.389_475+00:00 [26147] [INFO] 0x7fe23c013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:44:32.389_679+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:32.389_740+00:00 [26147] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:44:32.389_742+00:00 [26147] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:44:32.389_744+00:00 [26147] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:44:32.389_753+00:00 [26147] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:44:32.389_904+00:00 [26147] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:44:32.389_908+00:00 [26147] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:44:32.389_916+00:00 [26147] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:44:32.389_920+00:00 [26147] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:44:32.389_963+00:00 [26147] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:44:32.390_080+00:00 [26147] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:44:32.390_268+00:00 [26173] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:44:32.390_289+00:00 [26173] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:44:32.390_306+00:00 [26173] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:44:32.390_445+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:32.890_450+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:33.440_546+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:34.040_725+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:34.690_913+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:35.391_214+00:00 [26147] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:35.932_457+00:00 [26147] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:35.932_472+00:00 [26147] [INFO] session 4 got connection from 127.0.0.1:43118 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:35.932_828+00:00 [26147] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:35.932_836+00:00 [26147] [INFO] session 5 got connection from 127.0.0.1:43120 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:35.933_575+00:00 [26170] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:35.933_730+00:00 [26171] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:35.933_738+00:00 [26171] [INFO] session 6 got connection from 127.0.0.1:43124 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:35.934_009+00:00 [26156] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:44:35.934_018+00:00 [26156] [INFO] session 7 got connection from 127.0.0.1:43126 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:44:36.061_152+00:00 [26158] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:36.317_641+00:00 [26154] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:36.818_084+00:00 [26172] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:37.318_180+00:00 [26159] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:37.818_497+00:00 [26142] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:38.318_956+00:00 [26142] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:38.819_221+00:00 [26167] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:39.319_140+00:00 [26146] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:39.819_707+00:00 [26160] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:40.319_638+00:00 [26168] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:40.819_787+00:00 [26165] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:44:41.320_355+00:00 [26143] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:44:51.957_176+00:00 [26173] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:44:51.957_183+00:00 [26173] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:44:51.957_204+00:00 [26173] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:44:51.957_208+00:00 [26173] [INFO] create snapshot idx 100000 log_term 2 done: 20 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:45:10.994_488+00:00 [26486] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:45:10.995_929+00:00 [26486] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:45:10.995_966+00:00 [26486] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:45:10.995_972+00:00 [26486] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:45:10.995_998+00:00 [26486] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:45:10.996_002+00:00 [26486] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:45:10.996_005+00:00 [26486] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:45:10.996_034+00:00 [26486] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:45:10.996_192+00:00 [26522] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:45:13.018_217+00:00 [26493] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:45:13.018_227+00:00 [26493] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:45:13.018_239+00:00 [26493] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:45:13.018_249+00:00 [26493] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:45:13.018_254+00:00 [26493] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:45:13.018_257+00:00 [26493] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:45:13.018_273+00:00 [26493] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:45:13.018_314+00:00 [26521] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:45:13.018_320+00:00 [26521] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:45:13.018_328+00:00 [26521] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:45:32.320_515+00:00 [26493] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:45:32.320_540+00:00 [26493] [INFO] session 1 got connection from 127.0.0.1:43130 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:45:32.320_650+00:00 [26493] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:45:32.320_674+00:00 [26493] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:45:32.320_740+00:00 [26493] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:45:32.320_744+00:00 [26493] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:45:32.320_746+00:00 [26493] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:45:32.320_752+00:00 [26493] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:45:32.320_999+00:00 [26493] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43130 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:45:32.571_158+00:00 [26493] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:45:32.571_169+00:00 [26493] [INFO] session 2 got connection from 127.0.0.1:43132 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:45:32.571_246+00:00 [26493] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:45:32.571_249+00:00 [26493] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:45:32.571_385+00:00 [26493] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:45:32.571_389+00:00 [26493] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:45:32.571_470+00:00 [26521] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:45:32.571_473+00:00 [26521] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:45:32.571_482+00:00 [26521] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:45:32.571_493+00:00 [26521] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:45:32.571_497+00:00 [26521] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:45:32.571_517+00:00 [26521] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:45:32.571_612+00:00 [26521] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:45:32.571_625+00:00 [26521] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:45:32.571_684+00:00 [26521] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:45:32.571_689+00:00 [26521] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:45:32.571_698+00:00 [26521] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:45:52.813_688+00:00 [26510] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43132 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:45:53.338_805+00:00 [26510] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:45:53.338_828+00:00 [26510] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:45:53.338_835+00:00 [26510] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:45:53.338_908+00:00 [26510] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:45:53.338_953+00:00 [26510] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:45:53.339_421+00:00 [26510] [INFO] 0x7f2be8002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:45:53.339_622+00:00 [26510] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:45:53.339_683+00:00 [26510] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:45:54.331_544+00:00 [26510] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:45:54.331_558+00:00 [26510] [INFO] session 3 got connection from 127.0.0.1:43134 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:45:54.331_631+00:00 [26510] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:45:54.331_639+00:00 [26510] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:45:54.331_859+00:00 [26510] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:45:54.331_881+00:00 [26510] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:45:54.331_890+00:00 [26510] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:45:54.331_902+00:00 [26510] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:45:54.332_106+00:00 [26510] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:45:54.332_351+00:00 [26521] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:45:54.332_374+00:00 [26521] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:45:54.332_388+00:00 [26521] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:46:04.461_408+00:00 [26521] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:46:04.461_422+00:00 [26521] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:46:04.461_449+00:00 [26521] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:46:04.461_455+00:00 [26521] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:46:11.136_351+00:00 [26521] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:46:11.136_364+00:00 [26521] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:46:11.136_391+00:00 [26521] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:46:11.136_396+00:00 [26521] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:46:32.895_390+00:00 [26840] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:46:32.896_960+00:00 [26840] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:46:32.896_992+00:00 [26840] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:46:32.896_998+00:00 [26840] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:46:32.897_021+00:00 [26840] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:46:32.897_026+00:00 [26840] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:46:32.897_029+00:00 [26840] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:46:32.897_058+00:00 [26840] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:46:32.897_207+00:00 [26876] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:46:34.268_269+00:00 [26847] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:46:34.268_280+00:00 [26847] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:46:34.268_296+00:00 [26847] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:46:34.268_314+00:00 [26847] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:46:34.268_321+00:00 [26847] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:46:34.268_325+00:00 [26847] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:46:34.268_345+00:00 [26847] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:46:34.268_403+00:00 [26875] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:46:34.268_412+00:00 [26875] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:46:34.268_423+00:00 [26875] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:06.125_287+00:00 [27054] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:47:06.126_681+00:00 [27054] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:47:06.126_717+00:00 [27054] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:47:06.126_723+00:00 [27054] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:47:06.126_746+00:00 [27054] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:47:06.126_750+00:00 [27054] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:47:06.126_753+00:00 [27054] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:47:06.126_788+00:00 [27054] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:47:06.126_947+00:00 [27090] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:47:07.705_009+00:00 [27061] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:47:07.705_022+00:00 [27061] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:47:07.705_037+00:00 [27061] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:47:07.705_049+00:00 [27061] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:47:07.705_056+00:00 [27061] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:47:07.705_060+00:00 [27061] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:47:07.705_080+00:00 [27061] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:47:07.705_134+00:00 [27089] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:47:07.705_143+00:00 [27089] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:47:07.705_154+00:00 [27089] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:27.441_513+00:00 [27061] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:27.441_537+00:00 [27061] [INFO] session 1 got connection from 127.0.0.1:43136 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:27.441_643+00:00 [27061] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:47:27.441_665+00:00 [27061] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:47:27.441_727+00:00 [27061] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:47:27.441_730+00:00 [27061] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:47:27.441_732+00:00 [27061] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:47:27.441_738+00:00 [27061] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:27.441_954+00:00 [27061] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43136 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:47:27.692_097+00:00 [27061] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:27.692_109+00:00 [27061] [INFO] session 2 got connection from 127.0.0.1:43138 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:27.692_194+00:00 [27061] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:47:27.692_198+00:00 [27061] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:47:27.692_324+00:00 [27061] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:47:27.692_329+00:00 [27061] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:47:27.692_394+00:00 [27089] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:47:27.692_398+00:00 [27089] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:47:27.692_407+00:00 [27089] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:47:27.692_418+00:00 [27089] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:47:27.692_423+00:00 [27089] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:47:27.692_444+00:00 [27089] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:27.692_536+00:00 [27089] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:47:27.692_547+00:00 [27089] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:47:27.692_604+00:00 [27089] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:47:27.692_608+00:00 [27089] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:47:27.692_615+00:00 [27089] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:48.194_122+00:00 [27082] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43138 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:47:49.402_292+00:00 [27082] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:49.402_304+00:00 [27082] [INFO] session 3 got connection from 127.0.0.1:43140 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:49.402_390+00:00 [27082] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:47:49.402_397+00:00 [27082] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:47:49.782_592+00:00 [27082] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:47:49.782_614+00:00 [27082] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:47:49.782_623+00:00 [27082] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:47:49.782_726+00:00 [27082] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:47:49.782_766+00:00 [27082] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:47:49.783_213+00:00 [27082] [INFO] 0x7fa3fc013df0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:47:49.783_420+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:49.783_487+00:00 [27082] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:47:49.783_490+00:00 [27082] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:47:49.783_491+00:00 [27082] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:47:49.783_501+00:00 [27082] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:47:49.783_664+00:00 [27082] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:47:49.783_668+00:00 [27082] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:47:49.783_675+00:00 [27082] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:47:49.783_680+00:00 [27082] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:47:49.783_716+00:00 [27082] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:47:49.783_826+00:00 [27082] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:47:49.783_998+00:00 [27089] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:47:49.784_014+00:00 [27089] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:47:49.784_196+00:00 [27089] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:47:49.784_339+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:50.284_236+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:50.834_300+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:51.434_413+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:52.084_609+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:52.784_959+00:00 [27082] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:53.193_714+00:00 [27082] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:53.193_727+00:00 [27082] [INFO] session 4 got connection from 127.0.0.1:43144 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:53.194_137+00:00 [27077] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:53.194_147+00:00 [27077] [INFO] session 5 got connection from 127.0.0.1:43146 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:53.194_293+00:00 [27077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:53.322_595+00:00 [27081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:53.578_599+00:00 [27061] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:54.078_599+00:00 [27064] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:54.578_643+00:00 [27077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:55.078_849+00:00 [27078] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:55.579_135+00:00 [27072] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:56.079_444+00:00 [27077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:56.579_662+00:00 [27069] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:57.079_650+00:00 [27058] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:57.579_660+00:00 [27058] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:58.079_991+00:00 [27087] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:47:58.186_875+00:00 [27064] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:47:58.186_886+00:00 [27064] [INFO] session 6 got connection from 127.0.0.1:43148 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:47:58.580_225+00:00 [27080] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:48:28.252_100+00:00 [27269] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:48:28.253_497+00:00 [27269] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:48:28.253_528+00:00 [27269] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:48:28.253_534+00:00 [27269] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:48:28.253_560+00:00 [27269] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:48:28.253_564+00:00 [27269] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:48:28.253_567+00:00 [27269] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:48:28.253_602+00:00 [27269] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:48:28.253_745+00:00 [27305] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:48:29.323_812+00:00 [27276] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:48:29.323_825+00:00 [27276] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:48:29.323_841+00:00 [27276] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:48:29.323_852+00:00 [27276] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:48:29.323_859+00:00 [27276] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:48:29.323_863+00:00 [27276] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:48:29.323_881+00:00 [27276] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:48:29.323_932+00:00 [27304] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:48:29.323_940+00:00 [27304] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:48:29.323_950+00:00 [27304] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:48:50.323_214+00:00 [27276] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:48:50.323_229+00:00 [27276] [INFO] session 1 got connection from 127.0.0.1:43152 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:48:50.323_329+00:00 [27276] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:48:50.323_352+00:00 [27276] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:48:50.323_413+00:00 [27276] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:48:50.323_416+00:00 [27276] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:48:50.323_418+00:00 [27276] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:48:50.323_424+00:00 [27276] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:48:50.323_674+00:00 [27276] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43152 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:48:50.573_703+00:00 [27276] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:48:50.573_715+00:00 [27276] [INFO] session 2 got connection from 127.0.0.1:43154 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:48:50.573_794+00:00 [27276] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:48:50.573_798+00:00 [27276] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:48:50.573_927+00:00 [27276] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:48:50.573_931+00:00 [27276] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:48:50.573_996+00:00 [27304] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:48:50.573_999+00:00 [27304] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:48:50.574_008+00:00 [27304] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:48:50.574_019+00:00 [27304] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:48:50.574_023+00:00 [27304] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:48:50.574_043+00:00 [27304] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:48:50.574_139+00:00 [27304] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:48:50.574_151+00:00 [27304] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:48:50.574_210+00:00 [27304] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:48:50.574_215+00:00 [27304] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:48:50.574_224+00:00 [27304] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:49:10.069_924+00:00 [27296] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43154 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:49:11.214_009+00:00 [27296] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:49:11.214_021+00:00 [27296] [INFO] session 3 got connection from 127.0.0.1:43156 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:49:11.214_120+00:00 [27272] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:49:11.214_127+00:00 [27272] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:49:11.302_295+00:00 [27296] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:49:11.302_319+00:00 [27296] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:49:11.302_327+00:00 [27296] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:49:11.302_417+00:00 [27296] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:49:11.302_459+00:00 [27296] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:49:11.302_965+00:00 [27296] [INFO] 0x7f26c0013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:49:11.303_156+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:11.303_216+00:00 [27296] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:49:11.303_218+00:00 [27296] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:49:11.303_220+00:00 [27296] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:49:11.303_231+00:00 [27296] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:49:11.303_386+00:00 [27296] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:49:11.303_390+00:00 [27296] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:49:11.303_397+00:00 [27296] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:49:11.303_401+00:00 [27296] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:49:11.303_437+00:00 [27296] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:49:11.303_544+00:00 [27296] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:49:11.303_737+00:00 [27304] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:49:11.303_759+00:00 [27304] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:49:11.303_775+00:00 [27304] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:49:11.303_927+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:11.803_960+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:12.354_049+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:12.954_210+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:13.604_395+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:14.304_737+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:15.054_771+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:15.069_580+00:00 [27296] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:49:15.069_594+00:00 [27296] [INFO] session 4 got connection from 127.0.0.1:43158 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:49:15.069_894+00:00 [27294] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:49:15.069_904+00:00 [27294] [INFO] session 5 got connection from 127.0.0.1:43160 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:49:15.070_374+00:00 [27272] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:49:15.070_383+00:00 [27272] [INFO] session 6 got connection from 127.0.0.1:43162 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:49:15.071_167+00:00 [27290] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:49:15.071_176+00:00 [27290] [INFO] session 7 got connection from 127.0.0.1:43164 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:49:15.183_237+00:00 [27279] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:15.439_436+00:00 [27286] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:15.939_586+00:00 [27287] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:16.439_583+00:00 [27298] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:16.939_783+00:00 [27296] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:17.439_780+00:00 [27285] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:17.939_844+00:00 [27277] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:18.440_365+00:00 [27277] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:18.940_423+00:00 [27282] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:19.440_508+00:00 [27301] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:19.940_576+00:00 [27303] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:49:20.440_909+00:00 [27292] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:49:31.104_552+00:00 [27304] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:49:31.104_561+00:00 [27304] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:49:31.104_582+00:00 [27304] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:49:31.104_587+00:00 [27304] [INFO] create snapshot idx 100000 log_term 2 done: 20 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:49:50.131_754+00:00 [27480] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:49:50.134_210+00:00 [27480] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:49:50.134_245+00:00 [27480] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:49:50.134_249+00:00 [27480] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:49:50.134_277+00:00 [27480] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:49:50.134_282+00:00 [27480] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:49:50.134_285+00:00 [27480] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:49:50.134_315+00:00 [27480] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:49:50.134_470+00:00 [27516] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:49:51.625_552+00:00 [27487] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:49:51.625_564+00:00 [27487] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:49:51.625_579+00:00 [27487] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:49:51.625_591+00:00 [27487] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:49:51.625_598+00:00 [27487] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:49:51.625_602+00:00 [27487] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:49:51.625_623+00:00 [27487] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:49:51.625_679+00:00 [27515] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:49:51.625_688+00:00 [27515] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:49:51.625_698+00:00 [27515] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:50:12.202_829+00:00 [27487] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:12.202_849+00:00 [27487] [INFO] session 1 got connection from 127.0.0.1:43166 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:12.202_950+00:00 [27487] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:50:12.202_973+00:00 [27487] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:50:12.203_033+00:00 [27487] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:50:12.203_037+00:00 [27487] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:50:12.203_039+00:00 [27487] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:50:12.203_044+00:00 [27487] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:50:12.203_283+00:00 [27487] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43166 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:50:12.453_808+00:00 [27487] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:12.453_820+00:00 [27487] [INFO] session 2 got connection from 127.0.0.1:43170 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:12.453_903+00:00 [27487] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:50:12.453_907+00:00 [27487] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:50:12.454_032+00:00 [27487] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:50:12.454_036+00:00 [27487] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:50:12.454_097+00:00 [27515] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:50:12.454_100+00:00 [27515] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:50:12.454_107+00:00 [27515] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:50:12.454_116+00:00 [27515] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:50:12.454_120+00:00 [27515] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:50:12.454_137+00:00 [27515] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:50:12.454_218+00:00 [27515] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:50:12.454_228+00:00 [27515] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:50:12.454_278+00:00 [27515] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:50:12.454_281+00:00 [27515] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:50:12.454_288+00:00 [27515] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:50:31.949_873+00:00 [27507] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43170 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:50:32.635_813+00:00 [27507] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:32.635_827+00:00 [27507] [INFO] session 3 got connection from 127.0.0.1:43172 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:32.635_950+00:00 [27507] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:50:32.635_958+00:00 [27507] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:50:33.342_647+00:00 [27504] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:50:33.342_692+00:00 [27504] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:50:33.342_703+00:00 [27504] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:50:33.342_777+00:00 [27504] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:50:33.342_819+00:00 [27504] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:50:33.343_283+00:00 [27504] [INFO] 0x7ff1b8000d60 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:50:33.343_479+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:33.343_540+00:00 [27504] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:50:33.343_544+00:00 [27504] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:50:33.343_546+00:00 [27504] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:50:33.343_556+00:00 [27504] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:50:33.343_713+00:00 [27504] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:50:33.343_717+00:00 [27504] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:50:33.343_725+00:00 [27504] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:50:33.343_729+00:00 [27504] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:50:33.343_778+00:00 [27504] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:50:33.343_887+00:00 [27504] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:50:33.344_072+00:00 [27515] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:50:33.344_094+00:00 [27515] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:50:33.344_110+00:00 [27515] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:50:33.344_281+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:33.844_322+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:34.394_419+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:34.994_595+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:35.644_693+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:36.345_322+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:36.949_920+00:00 [27504] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.949_934+00:00 [27504] [INFO] session 4 got connection from 127.0.0.1:43174 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:36.950_418+00:00 [27493] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.950_428+00:00 [27493] [INFO] session 5 got connection from 127.0.0.1:43176 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:36.950_770+00:00 [27503] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:36.950_839+00:00 [27484] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.950_847+00:00 [27484] [INFO] session 6 got connection from 127.0.0.1:43178 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:36.951_047+00:00 [27484] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.951_056+00:00 [27484] [INFO] session 7 got connection from 127.0.0.1:43180 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:36.951_456+00:00 [27514] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.951_463+00:00 [27514] [INFO] session 8 got connection from 127.0.0.1:43182 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:36.951_712+00:00 [27499] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:50:36.951_720+00:00 [27499] [INFO] session 9 got connection from 127.0.0.1:43184 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:50:37.078_610+00:00 [27509] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:37.335_183+00:00 [27496] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:37.835_175+00:00 [27511] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:38.335_547+00:00 [27504] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:38.835_958+00:00 [27497] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:39.336_015+00:00 [27511] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:39.836_159+00:00 [27497] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:40.336_154+00:00 [27497] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:40.836_296+00:00 [27495] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:41.336_358+00:00 [27514] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:41.836_875+00:00 [27512] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:50:42.336_964+00:00 [27507] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:50:51.435_594+00:00 [27515] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:50:51.435_607+00:00 [27515] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:50:51.435_632+00:00 [27515] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:50:51.435_638+00:00 [27515] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:51:12.002_980+00:00 [27691] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:51:12.004_368+00:00 [27691] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:51:12.004_401+00:00 [27691] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:51:12.004_410+00:00 [27691] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:51:12.004_434+00:00 [27691] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:51:12.004_438+00:00 [27691] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:51:12.004_441+00:00 [27691] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:51:12.004_477+00:00 [27691] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:51:12.004_629+00:00 [27727] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:51:13.714_781+00:00 [27698] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:51:13.714_794+00:00 [27698] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:51:13.714_809+00:00 [27698] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:51:13.714_822+00:00 [27698] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:51:13.714_829+00:00 [27698] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:51:13.714_834+00:00 [27698] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:51:13.714_857+00:00 [27698] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:51:13.714_915+00:00 [27726] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:51:13.714_923+00:00 [27726] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:51:13.714_934+00:00 [27726] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:51:34.074_833+00:00 [27698] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:34.074_854+00:00 [27698] [INFO] session 1 got connection from 127.0.0.1:43186 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:34.074_959+00:00 [27698] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:51:34.074_981+00:00 [27698] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:51:34.075_041+00:00 [27698] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:51:34.075_044+00:00 [27698] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:51:34.075_046+00:00 [27698] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:51:34.075_052+00:00 [27698] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:51:34.075_288+00:00 [27698] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43186 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:51:34.325_441+00:00 [27698] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:34.325_452+00:00 [27698] [INFO] session 2 got connection from 127.0.0.1:43188 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:34.325_530+00:00 [27698] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:51:34.325_534+00:00 [27698] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:51:34.325_658+00:00 [27698] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:51:34.325_662+00:00 [27698] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:51:34.325_727+00:00 [27726] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:51:34.325_730+00:00 [27726] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:51:34.325_739+00:00 [27726] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:51:34.325_750+00:00 [27726] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:51:34.325_754+00:00 [27726] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:51:34.325_775+00:00 [27726] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:51:34.325_872+00:00 [27726] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:51:34.325_886+00:00 [27726] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:51:34.325_946+00:00 [27726] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:51:34.325_951+00:00 [27726] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:51:34.325_959+00:00 [27726] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:51:53.821_639+00:00 [27703] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43188 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:51:54.458_816+00:00 [27703] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:54.458_830+00:00 [27703] [INFO] session 3 got connection from 127.0.0.1:43190 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:54.458_951+00:00 [27695] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:51:54.458_959+00:00 [27695] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:51:54.598_560+00:00 [27703] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:51:54.598_587+00:00 [27703] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:51:54.598_595+00:00 [27703] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:51:54.598_712+00:00 [27703] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:51:54.598_758+00:00 [27703] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:51:54.599_256+00:00 [27703] [INFO] 0x7f8488013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:51:54.599_457+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:54.599_525+00:00 [27703] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:51:54.599_529+00:00 [27703] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:51:54.599_530+00:00 [27703] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:51:54.599_540+00:00 [27703] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:51:54.599_699+00:00 [27703] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:51:54.599_703+00:00 [27703] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:51:54.599_710+00:00 [27703] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:51:54.599_715+00:00 [27703] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:51:54.599_761+00:00 [27703] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:51:54.599_857+00:00 [27703] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:51:54.600_019+00:00 [27726] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:51:54.600_037+00:00 [27726] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:51:54.600_051+00:00 [27726] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:51:54.600_184+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:55.100_215+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:55.650_388+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:56.250_548+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:56.900_653+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:57.601_012+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:58.351_094+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:58.821_657+00:00 [27703] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.821_671+00:00 [27703] [INFO] session 4 got connection from 127.0.0.1:43192 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.821_991+00:00 [27719] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.821_999+00:00 [27719] [INFO] session 5 got connection from 127.0.0.1:43194 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.822_464+00:00 [27725] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.822_473+00:00 [27725] [INFO] session 6 got connection from 127.0.0.1:43196 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.823_334+00:00 [27720] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:58.823_660+00:00 [27715] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.823_668+00:00 [27715] [INFO] session 7 got connection from 127.0.0.1:43198 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.823_994+00:00 [27712] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.824_002+00:00 [27712] [INFO] session 8 got connection from 127.0.0.1:43200 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.825_926+00:00 [27697] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.825_934+00:00 [27697] [INFO] session 9 got connection from 127.0.0.1:43202 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.826_005+00:00 [27697] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.826_011+00:00 [27697] [INFO] session 10 got connection from 127.0.0.1:43204 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:58.826_431+00:00 [27722] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:51:58.826_439+00:00 [27722] [INFO] session 11 got connection from 127.0.0.1:43206 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:51:59.078_277+00:00 [27706] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:51:59.578_470+00:00 [27717] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:00.078_797+00:00 [27695] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:00.579_232+00:00 [27725] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:01.079_745+00:00 [27714] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:01.579_911+00:00 [27716] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:02.079_770+00:00 [27703] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:02.579_816+00:00 [27725] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:03.080_021+00:00 [27710] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:03.579_986+00:00 [27700] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:52:04.080_556+00:00 [27700] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:52:05.952_266+00:00 [27715] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:52:05.952_278+00:00 [27715] [INFO] session 12 got connection from 127.0.0.1:43208 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:52:13.047_793+00:00 [27726] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:52:13.047_801+00:00 [27726] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:52:13.047_822+00:00 [27726] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:52:13.047_827+00:00 [27726] [INFO] create snapshot idx 100000 log_term 2 done: 20 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:52:33.885_367+00:00 [27907] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:52:33.886_774+00:00 [27907] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:52:33.886_814+00:00 [27907] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:52:33.886_818+00:00 [27907] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:52:33.886_843+00:00 [27907] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:52:33.886_847+00:00 [27907] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:52:33.886_850+00:00 [27907] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:52:33.886_880+00:00 [27907] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:52:33.887_030+00:00 [27943] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:52:35.515_100+00:00 [27914] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:52:35.515_112+00:00 [27914] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:52:35.515_126+00:00 [27914] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:52:35.515_138+00:00 [27914] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:52:35.515_145+00:00 [27914] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:52:35.515_149+00:00 [27914] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:52:35.515_167+00:00 [27914] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:52:35.515_223+00:00 [27942] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:52:35.515_230+00:00 [27942] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:52:35.515_240+00:00 [27942] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:52:55.207_242+00:00 [27914] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:52:55.207_265+00:00 [27914] [INFO] session 1 got connection from 127.0.0.1:43210 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:52:55.207_368+00:00 [27914] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:52:55.207_389+00:00 [27914] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:52:55.207_445+00:00 [27914] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:52:55.207_448+00:00 [27914] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:52:55.207_450+00:00 [27914] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:52:55.207_455+00:00 [27914] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:52:55.207_684+00:00 [27914] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43210 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:52:55.458_052+00:00 [27914] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:52:55.458_063+00:00 [27914] [INFO] session 2 got connection from 127.0.0.1:43212 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:52:55.458_150+00:00 [27914] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:52:55.458_154+00:00 [27914] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:52:55.458_281+00:00 [27914] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:52:55.458_285+00:00 [27914] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:52:55.458_350+00:00 [27942] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:52:55.458_353+00:00 [27942] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:52:55.458_362+00:00 [27942] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:52:55.458_373+00:00 [27942] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:52:55.458_378+00:00 [27942] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:52:55.458_398+00:00 [27942] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:52:55.458_526+00:00 [27942] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:52:55.458_544+00:00 [27942] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:52:55.458_609+00:00 [27942] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:52:55.458_613+00:00 [27942] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:52:55.458_622+00:00 [27942] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:53:15.204_204+00:00 [27914] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43212 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:53:15.942_907+00:00 [27914] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:53:15.942_928+00:00 [27914] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:53:15.942_936+00:00 [27914] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:53:15.943_010+00:00 [27914] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:53:15.943_047+00:00 [27914] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:53:15.943_494+00:00 [27914] [INFO] 0x7fac20002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:53:15.943_712+00:00 [27938] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:53:15.943_777+00:00 [27938] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:53:16.556_490+00:00 [27938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:53:16.556_504+00:00 [27938] [INFO] session 3 got connection from 127.0.0.1:43216 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:53:16.556_605+00:00 [27938] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:53:16.556_613+00:00 [27938] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:53:16.556_798+00:00 [27938] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:53:16.556_821+00:00 [27938] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:53:16.556_830+00:00 [27938] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:53:16.556_844+00:00 [27938] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:53:16.557_057+00:00 [27938] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:53:16.557_235+00:00 [27942] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:53:16.557_254+00:00 [27942] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:53:16.557_269+00:00 [27942] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:53:25.334_596+00:00 [27942] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:53:25.334_608+00:00 [27942] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:53:25.334_634+00:00 [27942] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:53:25.334_639+00:00 [27942] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:53:30.468_116+00:00 [27942] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:53:30.468_129+00:00 [27942] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:53:30.468_156+00:00 [27942] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:53:30.468_161+00:00 [27942] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:53:35.616_753+00:00 [27942] [INFO] creating a snapshot for index 300000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:53:35.616_767+00:00 [27942] [INFO] create snapshot idx 300000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:53:35.616_793+00:00 [27942] [INFO] snapshot idx 300000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:53:35.616_799+00:00 [27942] [INFO] create snapshot idx 300000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:53:55.297_984+00:00 [28126] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:53:55.300_020+00:00 [28126] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:53:55.300_050+00:00 [28126] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:53:55.300_059+00:00 [28126] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:53:55.300_083+00:00 [28126] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:53:55.300_087+00:00 [28126] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:53:55.300_090+00:00 [28126] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:53:55.300_121+00:00 [28126] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:53:55.300_645+00:00 [28162] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:53:57.102_323+00:00 [28133] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:53:57.102_335+00:00 [28133] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:53:57.102_350+00:00 [28133] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:53:57.102_361+00:00 [28133] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:53:57.102_368+00:00 [28133] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:53:57.102_371+00:00 [28133] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:53:57.102_389+00:00 [28133] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:53:57.102_442+00:00 [28161] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:53:57.102_450+00:00 [28161] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:53:57.102_460+00:00 [28161] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:54:16.870_184+00:00 [28133] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:54:16.870_200+00:00 [28133] [INFO] session 1 got connection from 127.0.0.1:43218 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:54:16.870_300+00:00 [28133] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:54:16.870_322+00:00 [28133] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:54:16.870_382+00:00 [28133] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:54:16.870_385+00:00 [28133] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:54:16.870_387+00:00 [28133] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:54:16.870_393+00:00 [28133] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:54:16.870_633+00:00 [28133] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43218 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:54:17.120_854+00:00 [28132] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:54:17.120_866+00:00 [28132] [INFO] session 2 got connection from 127.0.0.1:43220 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:54:17.120_943+00:00 [28132] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:54:17.120_946+00:00 [28132] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:54:17.121_081+00:00 [28132] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:54:17.121_088+00:00 [28132] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:54:17.121_154+00:00 [28161] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:54:17.121_158+00:00 [28161] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:54:17.121_166+00:00 [28161] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:54:17.121_177+00:00 [28161] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:54:17.121_182+00:00 [28161] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:54:17.121_203+00:00 [28161] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:54:17.121_298+00:00 [28161] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:54:17.121_311+00:00 [28161] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:54:17.121_371+00:00 [28161] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:54:17.121_376+00:00 [28161] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:54:17.121_385+00:00 [28161] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:54:36.867_112+00:00 [28158] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43220 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:54:37.386_094+00:00 [28158] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:54:37.386_117+00:00 [28158] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:54:37.386_125+00:00 [28158] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:54:37.386_200+00:00 [28158] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:54:37.386_241+00:00 [28158] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:54:37.386_712+00:00 [28158] [INFO] 0x7f917c002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:54:37.386_910+00:00 [28158] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:54:37.386_968+00:00 [28158] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:54:37.895_174+00:00 [28158] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:54:37.895_189+00:00 [28158] [INFO] session 3 got connection from 127.0.0.1:43222 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:54:37.895_265+00:00 [28158] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:54:37.895_273+00:00 [28158] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:54:37.895_477+00:00 [28158] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:54:37.895_502+00:00 [28158] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:54:37.895_512+00:00 [28158] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:54:37.895_524+00:00 [28158] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:54:37.895_749+00:00 [28158] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:54:37.895_964+00:00 [28161] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:54:37.895_987+00:00 [28161] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:54:37.896_004+00:00 [28161] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:54:51.673_278+00:00 [28161] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:54:51.673_294+00:00 [28161] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:54:51.673_322+00:00 [28161] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:54:51.673_416+00:00 [28161] [INFO] create snapshot idx 100000 log_term 2 done: 28 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:55:16.936_895+00:00 [28336] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:55:16.938_259+00:00 [28336] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:55:16.938_296+00:00 [28336] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:55:16.938_303+00:00 [28336] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:55:16.938_328+00:00 [28336] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:55:16.938_332+00:00 [28336] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:55:16.938_335+00:00 [28336] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:55:16.938_366+00:00 [28336] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:55:16.938_515+00:00 [28372] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:55:18.823_603+00:00 [28343] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:55:18.823_617+00:00 [28343] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:55:18.823_632+00:00 [28343] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:55:18.823_643+00:00 [28343] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:55:18.823_650+00:00 [28343] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:55:18.823_654+00:00 [28343] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:55:18.823_672+00:00 [28343] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:55:18.823_725+00:00 [28371] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:55:18.823_733+00:00 [28371] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:55:18.823_743+00:00 [28371] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:55:39.004_545+00:00 [28343] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:55:39.004_564+00:00 [28343] [INFO] session 1 got connection from 127.0.0.1:43224 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:55:39.004_662+00:00 [28343] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:55:39.004_684+00:00 [28343] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:55:39.004_740+00:00 [28343] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:55:39.004_744+00:00 [28343] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:55:39.004_746+00:00 [28343] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:55:39.004_752+00:00 [28343] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:55:39.005_009+00:00 [28343] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43224 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:55:39.255_127+00:00 [28343] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:55:39.255_139+00:00 [28343] [INFO] session 2 got connection from 127.0.0.1:43226 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:55:39.255_217+00:00 [28343] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:55:39.255_220+00:00 [28343] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:55:39.255_347+00:00 [28343] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:55:39.255_351+00:00 [28343] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:55:39.255_417+00:00 [28371] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:55:39.255_420+00:00 [28371] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:55:39.255_428+00:00 [28371] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:55:39.255_439+00:00 [28371] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:55:39.255_443+00:00 [28371] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:55:39.255_463+00:00 [28371] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:55:39.255_558+00:00 [28371] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:55:39.255_571+00:00 [28371] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:55:39.255_629+00:00 [28371] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:55:39.255_634+00:00 [28371] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:55:39.255_643+00:00 [28371] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:55:58.505_746+00:00 [28359] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43226 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:55:59.204_961+00:00 [28359] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:55:59.204_983+00:00 [28359] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:55:59.204_992+00:00 [28359] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:55:59.205_062+00:00 [28359] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:55:59.205_106+00:00 [28359] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:55:59.205_566+00:00 [28359] [INFO] 0x7f39d8002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:55:59.205_761+00:00 [28359] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:55:59.205_841+00:00 [28359] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:55:59.488_188+00:00 [28360] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:55:59.488_202+00:00 [28360] [INFO] session 3 got connection from 127.0.0.1:43228 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:55:59.488_304+00:00 [28360] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:55:59.488_313+00:00 [28360] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T12:55:59.488_493+00:00 [28360] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T12:55:59.488_514+00:00 [28360] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:55:59.488_522+00:00 [28360] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T12:55:59.488_534+00:00 [28360] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T12:55:59.488_740+00:00 [28360] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:55:59.488_922+00:00 [28371] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:55:59.488_945+00:00 [28371] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:55:59.488_959+00:00 [28371] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:56:13.388_307+00:00 [28371] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:56:13.388_319+00:00 [28371] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:56:13.388_436+00:00 [28371] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:56:13.388_442+00:00 [28371] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:56:38.575_655+00:00 [28543] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:56:38.577_050+00:00 [28543] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:56:38.577_084+00:00 [28543] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:56:38.577_091+00:00 [28543] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:56:38.577_114+00:00 [28543] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:56:38.577_118+00:00 [28543] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:56:38.577_121+00:00 [28543] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:56:38.577_154+00:00 [28543] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:56:38.577_305+00:00 [28579] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:56:40.065_523+00:00 [28550] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:56:40.065_534+00:00 [28550] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:56:40.065_549+00:00 [28550] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:56:40.065_561+00:00 [28550] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:56:40.065_568+00:00 [28550] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:56:40.065_573+00:00 [28550] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:56:40.065_592+00:00 [28550] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:56:40.065_644+00:00 [28578] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:56:40.065_652+00:00 [28578] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:56:40.065_662+00:00 [28578] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:57:00.148_167+00:00 [28550] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:00.148_187+00:00 [28550] [INFO] session 1 got connection from 127.0.0.1:43230 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:00.148_286+00:00 [28550] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:57:00.148_309+00:00 [28550] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:57:00.148_370+00:00 [28550] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:57:00.148_373+00:00 [28550] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:57:00.148_375+00:00 [28550] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:57:00.148_380+00:00 [28550] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:57:00.148_601+00:00 [28550] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43230 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:57:00.398_771+00:00 [28550] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:00.398_783+00:00 [28550] [INFO] session 2 got connection from 127.0.0.1:43232 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:00.398_866+00:00 [28550] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:57:00.398_869+00:00 [28550] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:57:00.399_002+00:00 [28550] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:57:00.399_007+00:00 [28550] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:57:00.399_072+00:00 [28578] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:57:00.399_075+00:00 [28578] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:57:00.399_084+00:00 [28578] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:57:00.399_095+00:00 [28578] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:57:00.399_099+00:00 [28578] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:57:00.399_119+00:00 [28578] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:57:00.399_215+00:00 [28578] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:57:00.399_228+00:00 [28578] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:57:00.399_289+00:00 [28578] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:57:00.399_294+00:00 [28578] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:57:00.399_302+00:00 [28578] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:57:19.894_594+00:00 [28569] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43232 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:57:20.433_417+00:00 [28567] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:20.433_428+00:00 [28567] [INFO] session 3 got connection from 127.0.0.1:43234 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:20.433_524+00:00 [28547] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:57:20.433_530+00:00 [28547] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:57:20.972_164+00:00 [28567] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:57:20.972_184+00:00 [28567] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:57:20.972_191+00:00 [28567] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:57:20.972_268+00:00 [28567] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:57:20.972_303+00:00 [28567] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:57:20.972_700+00:00 [28567] [INFO] 0x7ff7e0014320 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:57:20.972_878+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:20.972_933+00:00 [28567] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:57:20.972_936+00:00 [28567] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:57:20.972_937+00:00 [28567] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:57:20.972_945+00:00 [28567] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:57:20.973_076+00:00 [28567] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:57:20.973_079+00:00 [28567] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:57:20.973_085+00:00 [28567] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:57:20.973_089+00:00 [28567] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:57:20.973_127+00:00 [28567] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:57:20.973_188+00:00 [28567] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:57:20.973_465+00:00 [28578] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:57:20.973_483+00:00 [28578] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:57:20.973_492+00:00 [28578] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:57:20.973_591+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:21.473_621+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:22.023_663+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:22.623_806+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:23.273_952+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:23.974_093+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:24.724_304+00:00 [28567] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:24.894_876+00:00 [28567] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.894_890+00:00 [28567] [INFO] session 4 got connection from 127.0.0.1:43236 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.895_176+00:00 [28564] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.895_186+00:00 [28564] [INFO] session 5 got connection from 127.0.0.1:43238 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.895_557+00:00 [28574] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.895_567+00:00 [28574] [INFO] session 6 got connection from 127.0.0.1:43240 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.896_216+00:00 [28548] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:24.896_320+00:00 [28569] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.896_329+00:00 [28569] [INFO] session 7 got connection from 127.0.0.1:43242 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.896_730+00:00 [28556] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.896_738+00:00 [28556] [INFO] session 8 got connection from 127.0.0.1:43244 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.897_014+00:00 [28556] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.897_021+00:00 [28556] [INFO] session 9 got connection from 127.0.0.1:43246 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.897_625+00:00 [28574] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.897_633+00:00 [28574] [INFO] session 10 got connection from 127.0.0.1:43248 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.899_525+00:00 [28561] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.899_532+00:00 [28561] [INFO] session 11 got connection from 127.0.0.1:43250 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.901_090+00:00 [28553] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.901_098+00:00 [28553] [INFO] session 12 got connection from 127.0.0.1:43254 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:24.901_669+00:00 [28563] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:57:24.901_676+00:00 [28563] [INFO] session 13 got connection from 127.0.0.1:43258 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:57:25.151_780+00:00 [28573] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:25.651_914+00:00 [28569] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:26.152_741+00:00 [28571] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:26.652_445+00:00 [28566] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:27.152_460+00:00 [28558] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:27.653_510+00:00 [28558] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:28.153_029+00:00 [28552] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:28.653_500+00:00 [28569] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:29.153_255+00:00 [28574] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:29.653_786+00:00 [28558] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:57:30.153_608+00:00 [28565] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:57:41.182_922+00:00 [28578] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:57:41.182_932+00:00 [28578] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:57:41.182_957+00:00 [28578] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:57:41.182_963+00:00 [28578] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:57:59.955_369+00:00 [28766] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:57:59.957_008+00:00 [28766] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:57:59.957_046+00:00 [28766] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:57:59.957_054+00:00 [28766] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:57:59.957_083+00:00 [28766] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:57:59.957_087+00:00 [28766] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:57:59.957_090+00:00 [28766] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:57:59.957_127+00:00 [28766] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:57:59.957_284+00:00 [28802] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:58:01.735_363+00:00 [28773] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:58:01.735_376+00:00 [28773] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:58:01.735_392+00:00 [28773] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:58:01.735_404+00:00 [28773] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:58:01.735_411+00:00 [28773] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:58:01.735_415+00:00 [28773] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:58:01.735_435+00:00 [28773] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:58:01.735_491+00:00 [28801] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:58:01.735_500+00:00 [28801] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:58:01.735_511+00:00 [28801] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:58:21.277_145+00:00 [28773] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:21.277_167+00:00 [28773] [INFO] session 1 got connection from 127.0.0.1:43260 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:21.277_283+00:00 [28773] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:58:21.277_307+00:00 [28773] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:58:21.277_372+00:00 [28773] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:58:21.277_375+00:00 [28773] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:58:21.277_377+00:00 [28773] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:58:21.277_383+00:00 [28773] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:58:21.277_627+00:00 [28773] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43260 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:58:21.527_742+00:00 [28773] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:21.527_752+00:00 [28773] [INFO] session 2 got connection from 127.0.0.1:43264 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:21.527_833+00:00 [28773] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:58:21.527_836+00:00 [28773] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:58:21.527_964+00:00 [28773] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:58:21.527_968+00:00 [28773] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:58:21.528_033+00:00 [28801] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:58:21.528_036+00:00 [28801] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:58:21.528_045+00:00 [28801] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:58:21.528_056+00:00 [28801] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:58:21.528_061+00:00 [28801] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:58:21.528_081+00:00 [28801] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:58:21.528_176+00:00 [28801] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:58:21.528_189+00:00 [28801] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:58:21.528_249+00:00 [28801] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:58:21.528_254+00:00 [28801] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:58:21.528_282+00:00 [28801] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:58:42.024_700+00:00 [28792] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43264 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:58:42.993_268+00:00 [28792] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:42.993_281+00:00 [28792] [INFO] session 3 got connection from 127.0.0.1:43266 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:42.993_379+00:00 [28792] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T12:58:42.993_387+00:00 [28792] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T12:58:43.049_472+00:00 [28792] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:58:43.049_494+00:00 [28792] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:58:43.049_501+00:00 [28792] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:58:43.049_584+00:00 [28792] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T12:58:43.049_626+00:00 [28792] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T12:58:43.050_083+00:00 [28792] [INFO] 0x7f06d8013df0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T12:58:43.050_281+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:43.050_347+00:00 [28792] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T12:58:43.050_350+00:00 [28792] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T12:58:43.050_352+00:00 [28792] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T12:58:43.050_362+00:00 [28792] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:58:43.050_515+00:00 [28792] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T12:58:43.050_519+00:00 [28792] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T12:58:43.050_527+00:00 [28792] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:58:43.050_531+00:00 [28792] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T12:58:43.050_573+00:00 [28792] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T12:58:43.050_699+00:00 [28792] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T12:58:43.050_892+00:00 [28801] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:58:43.050_913+00:00 [28801] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:58:43.050_929+00:00 [28801] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:58:43.051_068+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:43.551_101+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:44.101_148+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:44.701_373+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:45.351_477+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:46.051_766+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:46.801_775+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:47.024_917+00:00 [28792] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.024_930+00:00 [28792] [INFO] session 4 got connection from 127.0.0.1:43270 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.025_296+00:00 [28774] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.025_306+00:00 [28774] [INFO] session 5 got connection from 127.0.0.1:43272 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.025_773+00:00 [28781] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.025_782+00:00 [28781] [INFO] session 6 got connection from 127.0.0.1:43274 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.026_132+00:00 [28790] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.026_141+00:00 [28790] [INFO] session 7 got connection from 127.0.0.1:43276 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.026_808+00:00 [28776] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.026_818+00:00 [28776] [INFO] session 8 got connection from 127.0.0.1:43278 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.027_321+00:00 [28770] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.027_333+00:00 [28770] [INFO] session 9 got connection from 127.0.0.1:43280 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.032_414+00:00 [28795] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.032_424+00:00 [28795] [INFO] session 10 got connection from 127.0.0.1:43282 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.039_489+00:00 [28800] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:47.039_849+00:00 [28800] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.039_858+00:00 [28800] [INFO] session 11 got connection from 127.0.0.1:43284 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.039_906+00:00 [28772] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.039_912+00:00 [28772] [INFO] session 12 got connection from 127.0.0.1:43286 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.040_304+00:00 [28772] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:58:47.040_312+00:00 [28772] [INFO] session 13 got connection from 127.0.0.1:43288 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:58:47.282_116+00:00 [28777] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:47.781_922+00:00 [28799] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:48.282_081+00:00 [28800] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:48.782_085+00:00 [28793] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:49.282_108+00:00 [28790] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:49.782_762+00:00 [28785] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:50.282_342+00:00 [28774] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:50.782_423+00:00 [28792] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:51.282_453+00:00 [28775] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:51.782_513+00:00 [28778] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T12:58:52.282_565+00:00 [28775] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T12:59:02.965_565+00:00 [28801] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T12:59:02.965_578+00:00 [28801] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T12:59:02.965_607+00:00 [28801] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T12:59:02.965_612+00:00 [28801] [INFO] create snapshot idx 100000 log_term 2 done: 29 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T12:59:22.086_035+00:00 [28992] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T12:59:22.087_450+00:00 [28992] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T12:59:22.087_484+00:00 [28992] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T12:59:22.087_488+00:00 [28992] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T12:59:22.087_516+00:00 [28992] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T12:59:22.087_520+00:00 [28992] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T12:59:22.087_523+00:00 [28992] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T12:59:22.087_555+00:00 [28992] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T12:59:22.087_706+00:00 [29028] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T12:59:24.068_804+00:00 [28999] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T12:59:24.068_817+00:00 [28999] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T12:59:24.068_833+00:00 [28999] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T12:59:24.068_847+00:00 [28999] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T12:59:24.068_855+00:00 [28999] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T12:59:24.068_860+00:00 [28999] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T12:59:24.068_880+00:00 [28999] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T12:59:24.068_944+00:00 [29027] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:59:24.068_953+00:00 [29027] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:59:24.068_963+00:00 [29027] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:59:43.660_192+00:00 [28999] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:59:43.660_215+00:00 [28999] [INFO] session 1 got connection from 127.0.0.1:43290 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:59:43.660_319+00:00 [28999] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T12:59:43.660_341+00:00 [28999] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:59:43.660_400+00:00 [28999] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:59:43.660_404+00:00 [28999] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T12:59:43.660_406+00:00 [28999] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:59:43.660_411+00:00 [28999] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:59:43.660_654+00:00 [28999] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43290 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T12:59:43.910_827+00:00 [28999] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T12:59:43.910_838+00:00 [28999] [INFO] session 2 got connection from 127.0.0.1:43292 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T12:59:43.910_921+00:00 [28999] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T12:59:43.910_925+00:00 [28999] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T12:59:43.911_053+00:00 [28999] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:59:43.911_057+00:00 [28999] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T12:59:43.911_120+00:00 [29027] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:59:43.911_123+00:00 [29027] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T12:59:43.911_131+00:00 [29027] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:59:43.911_142+00:00 [29027] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:59:43.911_146+00:00 [29027] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T12:59:43.911_166+00:00 [29027] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T12:59:43.911_268+00:00 [29027] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T12:59:43.911_281+00:00 [29027] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T12:59:43.911_340+00:00 [29027] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T12:59:43.911_344+00:00 [29027] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T12:59:43.911_353+00:00 [29027] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:00:03.653_516+00:00 [29018] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43292 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:00:04.656_120+00:00 [29018] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:04.656_134+00:00 [29018] [INFO] session 3 got connection from 127.0.0.1:43294 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:04.656_253+00:00 [28995] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:00:04.656_262+00:00 [28995] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:00:04.767_866+00:00 [29018] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:00:04.767_888+00:00 [29018] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:00:04.767_895+00:00 [29018] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:00:04.767_975+00:00 [29018] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:00:04.768_012+00:00 [29018] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:00:04.768_445+00:00 [29018] [INFO] 0x7fe348013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:00:04.768_649+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:04.768_711+00:00 [29018] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:00:04.768_713+00:00 [29018] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:00:04.768_715+00:00 [29018] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:00:04.768_725+00:00 [29018] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:00:04.768_862+00:00 [29018] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:00:04.768_865+00:00 [29018] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:00:04.768_872+00:00 [29018] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:00:04.768_876+00:00 [29018] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:00:04.768_909+00:00 [29018] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:00:04.768_970+00:00 [29018] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:00:04.769_222+00:00 [29027] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:00:04.769_241+00:00 [29027] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:00:04.769_250+00:00 [29027] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:00:04.769_348+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:05.269_407+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:05.819_445+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:06.419_604+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:07.069_749+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:07.770_105+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:08.520_076+00:00 [29018] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:08.653_755+00:00 [29018] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.653_770+00:00 [29018] [INFO] session 4 got connection from 127.0.0.1:43296 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.654_085+00:00 [29007] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.654_095+00:00 [29007] [INFO] session 5 got connection from 127.0.0.1:43298 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.654_461+00:00 [29023] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.654_470+00:00 [29023] [INFO] session 6 got connection from 127.0.0.1:43300 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.655_263+00:00 [29003] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:08.655_307+00:00 [29003] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.655_314+00:00 [29003] [INFO] session 7 got connection from 127.0.0.1:43302 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.655_824+00:00 [29022] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.655_832+00:00 [29022] [INFO] session 8 got connection from 127.0.0.1:43304 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.656_141+00:00 [29024] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.656_149+00:00 [29024] [INFO] session 9 got connection from 127.0.0.1:43306 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.656_662+00:00 [29012] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.656_670+00:00 [29012] [INFO] session 10 got connection from 127.0.0.1:43308 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.658_153+00:00 [28997] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.658_162+00:00 [28997] [INFO] session 11 got connection from 127.0.0.1:43310 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.659_514+00:00 [29012] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.659_524+00:00 [29012] [INFO] session 12 got connection from 127.0.0.1:43312 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.660_186+00:00 [29001] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:00:08.660_194+00:00 [29001] [INFO] session 13 got connection from 127.0.0.1:43314 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:00:08.910_854+00:00 [29012] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:09.410_787+00:00 [29001] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:09.910_834+00:00 [28996] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:10.411_254+00:00 [29022] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:10.911_674+00:00 [29001] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:11.411_243+00:00 [29026] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:11.911_462+00:00 [29002] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:12.411_608+00:00 [29008] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:12.911_662+00:00 [29013] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:13.411_748+00:00 [29019] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:00:13.911_957+00:00 [28996] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:00:24.357_916+00:00 [29027] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:00:24.357_930+00:00 [29027] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:00:24.357_959+00:00 [29027] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:00:24.357_964+00:00 [29027] [INFO] create snapshot idx 100000 log_term 2 done: 29 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:03:56.241_099+00:00 [29279] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:03:56.242_502+00:00 [29279] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:03:56.242_536+00:00 [29279] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:03:56.242_541+00:00 [29279] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:03:56.242_563+00:00 [29279] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:03:56.242_567+00:00 [29279] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:03:56.242_570+00:00 [29279] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:03:56.242_600+00:00 [29279] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:03:56.242_792+00:00 [29315] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:03:57.569_818+00:00 [29286] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:03:57.569_830+00:00 [29286] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:03:57.569_846+00:00 [29286] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:03:57.569_863+00:00 [29286] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:03:57.569_870+00:00 [29286] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:03:57.569_874+00:00 [29286] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:03:57.569_894+00:00 [29286] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:03:57.569_949+00:00 [29314] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:03:57.569_957+00:00 [29314] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:03:57.569_967+00:00 [29314] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:15.055_026+00:00 [29409] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:04:15.056_474+00:00 [29409] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:04:15.056_514+00:00 [29409] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:04:15.056_522+00:00 [29409] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:04:15.056_549+00:00 [29409] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:04:15.056_554+00:00 [29409] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:04:15.056_558+00:00 [29409] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:04:15.056_597+00:00 [29409] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:04:15.056_782+00:00 [29445] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:04:16.716_811+00:00 [29416] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:04:16.716_823+00:00 [29416] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:04:16.716_838+00:00 [29416] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:04:16.716_850+00:00 [29416] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:04:16.716_856+00:00 [29416] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:04:16.716_859+00:00 [29416] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:04:16.716_878+00:00 [29416] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:04:16.716_930+00:00 [29444] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:04:16.716_938+00:00 [29444] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:04:16.716_948+00:00 [29444] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:37.131_331+00:00 [29416] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:04:37.131_355+00:00 [29416] [INFO] session 1 got connection from 127.0.0.1:43316 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:04:37.131_468+00:00 [29416] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:04:37.131_492+00:00 [29416] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:04:37.131_552+00:00 [29416] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:04:37.131_555+00:00 [29416] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:04:37.131_557+00:00 [29416] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:04:37.131_563+00:00 [29416] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:37.131_795+00:00 [29416] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43316 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:04:37.382_158+00:00 [29416] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:04:37.382_170+00:00 [29416] [INFO] session 2 got connection from 127.0.0.1:43318 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:04:37.382_260+00:00 [29416] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:04:37.382_263+00:00 [29416] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:04:37.382_397+00:00 [29416] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:04:37.382_401+00:00 [29416] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:04:37.382_466+00:00 [29444] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:04:37.382_469+00:00 [29444] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:04:37.382_478+00:00 [29444] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:04:37.382_489+00:00 [29444] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:04:37.382_493+00:00 [29444] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:04:37.382_511+00:00 [29444] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:37.382_603+00:00 [29444] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:04:37.382_616+00:00 [29444] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:04:37.382_690+00:00 [29444] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:04:37.382_694+00:00 [29444] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:04:37.382_703+00:00 [29444] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:56.874_014+00:00 [29435] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43318 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:04:57.883_873+00:00 [29435] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:04:57.883_887+00:00 [29435] [INFO] session 3 got connection from 127.0.0.1:43320 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:04:57.883_995+00:00 [29413] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:04:57.884_003+00:00 [29413] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:04:58.125_857+00:00 [29435] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:04:58.125_881+00:00 [29435] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:04:58.125_890+00:00 [29435] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:04:58.125_975+00:00 [29435] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:04:58.126_015+00:00 [29435] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:04:58.126_855+00:00 [29435] [INFO] 0x7f8840013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:04:58.127_045+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:04:58.127_106+00:00 [29435] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:04:58.127_109+00:00 [29435] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:04:58.127_111+00:00 [29435] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:04:58.127_121+00:00 [29435] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:04:58.127_274+00:00 [29435] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:04:58.127_277+00:00 [29435] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:04:58.127_283+00:00 [29435] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:04:58.127_286+00:00 [29435] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:04:58.127_329+00:00 [29435] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:04:58.127_421+00:00 [29435] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:04:58.127_577+00:00 [29444] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:04:58.127_594+00:00 [29444] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:04:58.127_608+00:00 [29444] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:04:58.127_743+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:04:58.627_833+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:04:59.178_014+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:04:59.778_181+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:00.428_309+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:01.128_505+00:00 [29435] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:01.873_638+00:00 [29435] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:05:01.873_652+00:00 [29435] [INFO] session 4 got connection from 127.0.0.1:43322 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:05:01.874_123+00:00 [29420] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:05:01.874_139+00:00 [29420] [INFO] session 5 got connection from 127.0.0.1:43324 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:05:01.874_419+00:00 [29432] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:02.002_333+00:00 [29429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:02.258_504+00:00 [29426] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:02.758_511+00:00 [29437] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:03.258_535+00:00 [29440] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:03.758_615+00:00 [29439] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:04.258_790+00:00 [29436] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:04.759_051+00:00 [29427] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:05.259_033+00:00 [29429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:05.759_146+00:00 [29412] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:06.259_196+00:00 [29442] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:06.759_196+00:00 [29427] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:05:07.259_517+00:00 [29438] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:05:36.919_670+00:00 [29623] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:05:36.921_061+00:00 [29623] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:05:36.921_127+00:00 [29623] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:05:36.921_133+00:00 [29623] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:05:36.921_155+00:00 [29623] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:05:36.921_159+00:00 [29623] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:05:36.921_162+00:00 [29623] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:05:36.921_217+00:00 [29623] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:05:36.921_377+00:00 [29659] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:05:38.928_389+00:00 [29630] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:05:38.928_400+00:00 [29630] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:05:38.928_415+00:00 [29630] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:05:38.928_435+00:00 [29630] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:05:38.928_441+00:00 [29630] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:05:38.928_445+00:00 [29630] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:05:38.928_464+00:00 [29630] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:05:38.928_516+00:00 [29658] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:05:38.928_525+00:00 [29658] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:05:38.928_536+00:00 [29658] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:05:58.737_825+00:00 [29630] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:05:58.737_847+00:00 [29630] [INFO] session 1 got connection from 127.0.0.1:43326 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:05:58.737_961+00:00 [29630] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:05:58.737_985+00:00 [29630] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:05:58.738_047+00:00 [29630] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:05:58.738_051+00:00 [29630] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:05:58.738_053+00:00 [29630] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:05:58.738_059+00:00 [29630] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:05:58.738_305+00:00 [29630] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43326 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:05:58.988_455+00:00 [29630] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:05:58.988_467+00:00 [29630] [INFO] session 2 got connection from 127.0.0.1:43328 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:05:58.988_550+00:00 [29630] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:05:58.988_554+00:00 [29630] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:05:58.988_681+00:00 [29630] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:05:58.988_685+00:00 [29630] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:05:58.988_748+00:00 [29658] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:05:58.988_751+00:00 [29658] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:05:58.988_760+00:00 [29658] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:05:58.988_772+00:00 [29658] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:05:58.988_776+00:00 [29658] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:05:58.988_795+00:00 [29658] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:05:58.988_892+00:00 [29658] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:05:58.988_904+00:00 [29658] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:05:58.988_977+00:00 [29658] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:05:58.988_982+00:00 [29658] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:05:58.988_992+00:00 [29658] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:06:18.235_474+00:00 [29641] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43328 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:06:19.388_496+00:00 [29641] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:06:19.388_520+00:00 [29641] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:06:19.388_529+00:00 [29641] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:06:19.388_608+00:00 [29641] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:06:19.388_661+00:00 [29641] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:06:19.389_109+00:00 [29641] [INFO] 0x7f16a8002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:06:19.389_276+00:00 [29641] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:06:19.389_339+00:00 [29641] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:06:19.503_178+00:00 [29647] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:06:19.503_190+00:00 [29647] [INFO] session 3 got connection from 127.0.0.1:43330 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:06:19.503_276+00:00 [29647] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:06:19.503_282+00:00 [29647] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:06:19.503_431+00:00 [29647] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:06:19.503_450+00:00 [29647] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:06:19.503_457+00:00 [29647] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:06:19.503_466+00:00 [29647] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:06:19.503_630+00:00 [29647] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:06:19.503_789+00:00 [29658] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:06:19.503_808+00:00 [29658] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:06:19.503_824+00:00 [29658] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:06:31.708_264+00:00 [29658] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:06:31.708_277+00:00 [29658] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:06:31.708_302+00:00 [29658] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:06:31.708_307+00:00 [29658] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:06:40.201_577+00:00 [29658] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:06:40.201_590+00:00 [29658] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:06:40.201_617+00:00 [29658] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:06:40.201_622+00:00 [29658] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:06:58.308_289+00:00 [29844] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:06:58.309_686+00:00 [29844] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:06:58.309_719+00:00 [29844] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:06:58.309_723+00:00 [29844] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:06:58.309_749+00:00 [29844] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:06:58.309_754+00:00 [29844] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:06:58.309_756+00:00 [29844] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:06:58.309_787+00:00 [29844] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:06:58.309_938+00:00 [29880] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:06:59.642_014+00:00 [29851] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:06:59.642_028+00:00 [29851] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:06:59.642_043+00:00 [29851] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:06:59.642_055+00:00 [29851] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:06:59.642_061+00:00 [29851] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:06:59.642_065+00:00 [29851] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:06:59.642_086+00:00 [29851] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:06:59.642_142+00:00 [29879] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:06:59.642_151+00:00 [29879] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:06:59.642_163+00:00 [29879] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:07:20.384_123+00:00 [29851] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:07:20.384_146+00:00 [29851] [INFO] session 1 got connection from 127.0.0.1:43332 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:07:20.384_248+00:00 [29851] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:07:20.384_271+00:00 [29851] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:07:20.384_331+00:00 [29851] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:07:20.384_334+00:00 [29851] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:07:20.384_336+00:00 [29851] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:07:20.384_342+00:00 [29851] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:07:20.384_576+00:00 [29851] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43332 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:07:20.635_004+00:00 [29851] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:07:20.635_015+00:00 [29851] [INFO] session 2 got connection from 127.0.0.1:43334 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:07:20.635_095+00:00 [29851] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:07:20.635_098+00:00 [29851] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:07:20.635_312+00:00 [29851] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:07:20.635_317+00:00 [29851] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:07:20.635_381+00:00 [29879] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:07:20.635_384+00:00 [29879] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:07:20.635_393+00:00 [29879] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:07:20.635_404+00:00 [29879] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:07:20.635_408+00:00 [29879] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:07:20.635_428+00:00 [29879] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:07:20.635_511+00:00 [29879] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:07:20.635_523+00:00 [29879] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:07:20.635_576+00:00 [29879] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:07:20.635_580+00:00 [29879] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:07:20.635_588+00:00 [29879] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:07:39.876_974+00:00 [29856] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43334 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:07:41.076_633+00:00 [29856] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:07:41.076_667+00:00 [29856] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:07:41.076_676+00:00 [29856] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:07:41.076_741+00:00 [29856] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:07:41.076_787+00:00 [29856] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:07:41.077_255+00:00 [29856] [INFO] 0x7feaf4002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:07:41.077_449+00:00 [29856] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:07:41.077_521+00:00 [29856] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:07:41.430_585+00:00 [29856] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:07:41.430_599+00:00 [29856] [INFO] session 3 got connection from 127.0.0.1:43336 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:07:41.430_696+00:00 [29856] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:07:41.430_703+00:00 [29856] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:07:41.430_945+00:00 [29872] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:07:41.430_969+00:00 [29872] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:07:41.430_977+00:00 [29872] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:07:41.430_996+00:00 [29872] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:07:41.431_216+00:00 [29872] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:07:41.431_401+00:00 [29879] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:07:41.431_423+00:00 [29879] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:07:41.431_438+00:00 [29879] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:07:51.554_654+00:00 [29879] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:07:51.554_675+00:00 [29879] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:07:51.554_702+00:00 [29879] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:07:51.554_708+00:00 [29879] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:07:58.272_665+00:00 [29879] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:07:58.272_677+00:00 [29879] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:07:58.272_703+00:00 [29879] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:07:58.272_709+00:00 [29879] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:08:19.950_991+00:00 [30055] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:08:19.952_604+00:00 [30055] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:08:19.952_637+00:00 [30055] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:08:19.952_642+00:00 [30055] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:08:19.952_665+00:00 [30055] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:08:19.952_669+00:00 [30055] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:08:19.952_672+00:00 [30055] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:08:19.952_704+00:00 [30055] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:08:19.952_856+00:00 [30091] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:08:21.531_965+00:00 [30062] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:08:21.531_976+00:00 [30062] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:08:21.531_990+00:00 [30062] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:08:21.532_007+00:00 [30062] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:08:21.532_014+00:00 [30062] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:08:21.532_018+00:00 [30062] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:08:21.532_036+00:00 [30062] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:08:21.532_088+00:00 [30090] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:08:21.532_096+00:00 [30090] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:08:21.532_106+00:00 [30090] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:08:42.027_754+00:00 [30062] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:08:42.027_782+00:00 [30062] [INFO] session 1 got connection from 127.0.0.1:43338 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:08:42.028_190+00:00 [30062] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:08:42.028_224+00:00 [30062] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:08:42.028_309+00:00 [30062] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:08:42.028_313+00:00 [30062] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:08:42.028_316+00:00 [30062] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:08:42.028_323+00:00 [30062] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:08:42.028_591+00:00 [30062] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43338 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:08:42.277_970+00:00 [30062] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:08:42.277_983+00:00 [30062] [INFO] session 2 got connection from 127.0.0.1:43340 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:08:42.278_072+00:00 [30062] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:08:42.278_076+00:00 [30062] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:08:42.278_215+00:00 [30062] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:08:42.278_220+00:00 [30062] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:08:42.278_287+00:00 [30090] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:08:42.278_291+00:00 [30090] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:08:42.278_299+00:00 [30090] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:08:42.278_312+00:00 [30090] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:08:42.278_316+00:00 [30090] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:08:42.278_338+00:00 [30090] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:08:42.278_433+00:00 [30090] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:08:42.278_446+00:00 [30090] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:08:42.278_507+00:00 [30090] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:08:42.278_512+00:00 [30090] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:08:42.278_522+00:00 [30090] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:09:01.769_851+00:00 [30081] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43340 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:09:03.049_222+00:00 [30081] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:03.049_236+00:00 [30081] [INFO] session 3 got connection from 127.0.0.1:43342 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:03.049_341+00:00 [30059] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:09:03.049_349+00:00 [30059] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:09:03.329_198+00:00 [30081] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:09:03.329_222+00:00 [30081] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:09:03.329_231+00:00 [30081] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:09:03.329_317+00:00 [30081] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:09:03.329_357+00:00 [30081] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:09:03.329_795+00:00 [30081] [INFO] 0x7f9060013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:09:03.329_985+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:03.330_048+00:00 [30081] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:09:03.330_051+00:00 [30081] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:09:03.330_053+00:00 [30081] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:09:03.330_062+00:00 [30081] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:09:03.330_218+00:00 [30081] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:09:03.330_222+00:00 [30081] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:09:03.330_229+00:00 [30081] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:09:03.330_233+00:00 [30081] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:09:03.330_280+00:00 [30081] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:09:03.330_388+00:00 [30081] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:09:03.330_585+00:00 [30090] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:09:03.330_606+00:00 [30090] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:09:03.330_623+00:00 [30090] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:09:03.330_797+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:03.830_908+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:04.381_278+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:04.981_207+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:05.631_346+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:06.331_670+00:00 [30081] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:06.769_966+00:00 [30081] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.769_980+00:00 [30081] [INFO] session 4 got connection from 127.0.0.1:43344 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.770_444+00:00 [30068] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.770_455+00:00 [30068] [INFO] session 5 got connection from 127.0.0.1:43346 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.770_536+00:00 [30068] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:06.770_853+00:00 [30078] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.770_863+00:00 [30078] [INFO] session 6 got connection from 127.0.0.1:43348 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.771_041+00:00 [30078] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.771_049+00:00 [30078] [INFO] session 7 got connection from 127.0.0.1:43350 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.771_290+00:00 [30080] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.771_297+00:00 [30080] [INFO] session 8 got connection from 127.0.0.1:43352 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.771_657+00:00 [30080] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.771_665+00:00 [30080] [INFO] session 9 got connection from 127.0.0.1:43354 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.772_977+00:00 [30076] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.772_985+00:00 [30076] [INFO] session 10 got connection from 127.0.0.1:43356 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.773_711+00:00 [30072] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:06.773_719+00:00 [30072] [INFO] session 11 got connection from 127.0.0.1:43358 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:06.898_829+00:00 [30072] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:07.154_980+00:00 [30078] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:07.655_149+00:00 [30076] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:08.155_421+00:00 [30068] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:08.655_514+00:00 [30077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:09.155_717+00:00 [30061] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:09.655_663+00:00 [30087] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:10.155_907+00:00 [30063] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:10.655_956+00:00 [30058] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:11.156_346+00:00 [30077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:11.656_374+00:00 [30077] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:09:12.156_576+00:00 [30087] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:09:12.707_808+00:00 [30087] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:09:12.707_823+00:00 [30087] [INFO] session 12 got connection from 127.0.0.1:43360 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:09:20.934_986+00:00 [30090] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:09:20.935_000+00:00 [30090] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:09:20.935_027+00:00 [30090] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:09:20.935_032+00:00 [30090] [INFO] create snapshot idx 100000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:09:41.833_071+00:00 [30279] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:09:41.834_464+00:00 [30279] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:09:41.834_505+00:00 [30279] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:09:41.834_509+00:00 [30279] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:09:41.834_532+00:00 [30279] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:09:41.834_536+00:00 [30279] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:09:41.834_539+00:00 [30279] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:09:41.834_570+00:00 [30279] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:09:41.834_751+00:00 [30315] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:09:43.880_826+00:00 [30286] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:09:43.880_838+00:00 [30286] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:09:43.880_853+00:00 [30286] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:09:43.880_865+00:00 [30286] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:09:43.880_871+00:00 [30286] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:09:43.880_874+00:00 [30286] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:09:43.880_892+00:00 [30286] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:09:43.880_947+00:00 [30314] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:09:43.880_955+00:00 [30314] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:09:43.880_965+00:00 [30314] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:10:03.158_803+00:00 [30286] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:03.158_827+00:00 [30286] [INFO] session 1 got connection from 127.0.0.1:43362 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:03.158_937+00:00 [30286] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:10:03.158_961+00:00 [30286] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:10:03.159_027+00:00 [30286] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:10:03.159_031+00:00 [30286] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:10:03.159_033+00:00 [30286] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:10:03.159_039+00:00 [30286] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:10:03.159_326+00:00 [30286] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43362 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:10:03.409_591+00:00 [30286] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:03.409_603+00:00 [30286] [INFO] session 2 got connection from 127.0.0.1:43364 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:03.409_686+00:00 [30286] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:10:03.409_689+00:00 [30286] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:10:03.409_811+00:00 [30286] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:10:03.409_815+00:00 [30286] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:10:03.409_879+00:00 [30314] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:10:03.409_882+00:00 [30314] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:10:03.409_890+00:00 [30314] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:10:03.409_901+00:00 [30314] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:10:03.409_905+00:00 [30314] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:10:03.409_924+00:00 [30314] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:10:03.410_017+00:00 [30314] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:10:03.410_034+00:00 [30314] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:10:03.410_092+00:00 [30314] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:10:03.410_097+00:00 [30314] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:10:03.410_105+00:00 [30314] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:10:23.903_058+00:00 [30283] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43364 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:10:24.643_121+00:00 [30283] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:24.643_135+00:00 [30283] [INFO] session 3 got connection from 127.0.0.1:43366 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:24.643_238+00:00 [30283] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:10:24.643_246+00:00 [30283] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:10:25.175_277+00:00 [30283] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:10:25.175_302+00:00 [30283] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:10:25.175_311+00:00 [30283] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:10:25.175_390+00:00 [30283] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:10:25.175_434+00:00 [30283] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:10:25.175_886+00:00 [30283] [INFO] 0x7f88a0013c50 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:10:25.176_090+00:00 [30283] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:25.176_179+00:00 [30283] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:10:25.176_182+00:00 [30283] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:10:25.176_184+00:00 [30283] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:10:25.176_194+00:00 [30283] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:10:25.176_368+00:00 [30305] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:10:25.176_380+00:00 [30305] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:10:25.176_386+00:00 [30305] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:10:25.176_389+00:00 [30305] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:10:25.176_424+00:00 [30305] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:10:25.176_544+00:00 [30305] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:10:25.176_749+00:00 [30314] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:10:25.176_771+00:00 [30314] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:10:25.176_787+00:00 [30314] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:10:25.176_946+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:25.676_979+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:26.227_075+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:26.827_157+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:27.477_374+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:28.177_528+00:00 [30305] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:28.903_586+00:00 [30305] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.903_598+00:00 [30305] [INFO] session 4 got connection from 127.0.0.1:43368 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.904_016+00:00 [30287] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.904_026+00:00 [30287] [INFO] session 5 got connection from 127.0.0.1:43370 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.904_187+00:00 [30287] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:28.904_261+00:00 [30287] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.904_267+00:00 [30287] [INFO] session 6 got connection from 127.0.0.1:43372 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.904_546+00:00 [30299] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.904_554+00:00 [30299] [INFO] session 7 got connection from 127.0.0.1:43374 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.904_775+00:00 [30309] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.904_783+00:00 [30309] [INFO] session 8 got connection from 127.0.0.1:43376 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.905_262+00:00 [30288] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.905_270+00:00 [30288] [INFO] session 9 got connection from 127.0.0.1:43378 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.906_553+00:00 [30300] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.906_562+00:00 [30300] [INFO] session 10 got connection from 127.0.0.1:43380 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.907_646+00:00 [30295] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.907_654+00:00 [30295] [INFO] session 11 got connection from 127.0.0.1:43382 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.908_093+00:00 [30303] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.908_101+00:00 [30303] [INFO] session 12 got connection from 127.0.0.1:43384 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:28.909_054+00:00 [30298] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:10:28.909_063+00:00 [30298] [INFO] session 13 got connection from 127.0.0.1:43388 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:10:29.032_762+00:00 [30312] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:29.288_728+00:00 [30307] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:29.788_885+00:00 [30303] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:30.289_755+00:00 [30304] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:30.789_334+00:00 [30308] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:31.289_197+00:00 [30282] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:31.789_306+00:00 [30294] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:32.289_472+00:00 [30283] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:32.790_332+00:00 [30289] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:33.290_738+00:00 [30297] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:33.790_054+00:00 [30290] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:10:34.290_993+00:00 [30305] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:10:48.343_137+00:00 [30314] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:10:48.343_146+00:00 [30314] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:10:48.343_172+00:00 [30314] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:10:48.343_177+00:00 [30314] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:11:03.965_172+00:00 [30497] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:11:03.966_566+00:00 [30497] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:11:03.966_599+00:00 [30497] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:11:03.966_609+00:00 [30497] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:11:03.966_632+00:00 [30497] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:11:03.966_637+00:00 [30497] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:11:03.966_639+00:00 [30497] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:11:03.966_690+00:00 [30497] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:11:03.966_857+00:00 [30533] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:11:05.291_907+00:00 [30504] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:11:05.291_918+00:00 [30504] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:11:05.291_935+00:00 [30504] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:11:05.291_947+00:00 [30504] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:11:05.291_953+00:00 [30504] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:11:05.291_957+00:00 [30504] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:11:05.291_977+00:00 [30504] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:11:05.292_038+00:00 [30532] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:11:05.292_047+00:00 [30532] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:11:05.292_058+00:00 [30532] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:11:25.290_813+00:00 [30504] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:11:25.290_838+00:00 [30504] [INFO] session 1 got connection from 127.0.0.1:43390 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:11:25.290_952+00:00 [30504] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:11:25.290_977+00:00 [30504] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:11:25.291_045+00:00 [30504] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:11:25.291_049+00:00 [30504] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:11:25.291_051+00:00 [30504] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:11:25.291_057+00:00 [30504] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:11:25.291_303+00:00 [30504] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43390 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:11:25.541_549+00:00 [30504] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:11:25.541_560+00:00 [30504] [INFO] session 2 got connection from 127.0.0.1:43392 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:11:25.541_642+00:00 [30504] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:11:25.541_646+00:00 [30504] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:11:25.541_772+00:00 [30504] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:11:25.541_777+00:00 [30504] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:11:25.541_842+00:00 [30532] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:11:25.541_846+00:00 [30532] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:11:25.541_854+00:00 [30532] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:11:25.541_865+00:00 [30532] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:11:25.541_870+00:00 [30532] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:11:25.541_889+00:00 [30532] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:11:25.542_004+00:00 [30532] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:11:25.542_022+00:00 [30532] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:11:25.542_092+00:00 [30532] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:11:25.542_098+00:00 [30532] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:11:25.542_106+00:00 [30532] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:11:45.784_065+00:00 [30526] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43392 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:11:46.674_864+00:00 [30526] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:11:46.674_889+00:00 [30526] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:11:46.674_897+00:00 [30526] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:11:46.674_969+00:00 [30526] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:11:46.675_015+00:00 [30526] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:11:46.675_875+00:00 [30526] [INFO] 0x7f9c3c002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:11:46.676_075+00:00 [30526] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:11:46.676_138+00:00 [30526] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:11:47.320_846+00:00 [30526] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:11:47.320_859+00:00 [30526] [INFO] session 3 got connection from 127.0.0.1:43394 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:11:47.320_938+00:00 [30526] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:11:47.320_946+00:00 [30526] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:11:47.321_160+00:00 [30526] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:11:47.321_182+00:00 [30526] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:11:47.321_191+00:00 [30526] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:11:47.321_203+00:00 [30526] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:11:47.321_407+00:00 [30526] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:11:47.321_636+00:00 [30532] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:11:47.321_658+00:00 [30532] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:11:47.321_672+00:00 [30532] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:11:55.531_103+00:00 [30532] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:11:55.531_115+00:00 [30532] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:11:55.531_142+00:00 [30532] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:11:55.531_148+00:00 [30532] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:12:00.265_518+00:00 [30532] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:12:00.265_531+00:00 [30532] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:12:00.265_558+00:00 [30532] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:12:00.265_564+00:00 [30532] [INFO] create snapshot idx 200000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:12:05.018_452+00:00 [30532] [INFO] creating a snapshot for index 300000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:12:05.018_466+00:00 [30532] [INFO] create snapshot idx 300000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:12:05.018_493+00:00 [30532] [INFO] snapshot idx 300000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:12:05.018_499+00:00 [30532] [INFO] create snapshot idx 300000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:12:09.770_748+00:00 [30532] [INFO] creating a snapshot for index 400000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:12:09.770_760+00:00 [30532] [INFO] create snapshot idx 400000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:12:09.770_786+00:00 [30532] [INFO] snapshot idx 400000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:12:09.770_791+00:00 [30532] [INFO] create snapshot idx 400000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:12:25.883_350+00:00 [30732] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:12:25.884_830+00:00 [30732] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:12:25.884_874+00:00 [30732] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:12:25.884_878+00:00 [30732] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:12:25.884_905+00:00 [30732] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:12:25.884_909+00:00 [30732] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:12:25.884_912+00:00 [30732] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:12:25.884_944+00:00 [30732] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:12:25.885_100+00:00 [30768] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:12:27.451_173+00:00 [30739] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:12:27.451_186+00:00 [30739] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:12:27.451_201+00:00 [30739] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:12:27.451_212+00:00 [30739] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:12:27.451_219+00:00 [30739] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:12:27.451_222+00:00 [30739] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:12:27.451_240+00:00 [30739] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:12:27.451_292+00:00 [30767] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:12:27.451_300+00:00 [30767] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:12:27.451_316+00:00 [30767] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:12:47.959_469+00:00 [30739] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:12:47.959_484+00:00 [30739] [INFO] session 1 got connection from 127.0.0.1:43396 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:12:47.959_584+00:00 [30739] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:12:47.959_606+00:00 [30739] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:12:47.959_666+00:00 [30739] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:12:47.959_670+00:00 [30739] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:12:47.959_671+00:00 [30739] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:12:47.959_677+00:00 [30739] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:12:47.959_916+00:00 [30739] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43396 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:12:48.210_083+00:00 [30739] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:12:48.210_096+00:00 [30739] [INFO] session 2 got connection from 127.0.0.1:43398 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:12:48.210_180+00:00 [30739] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:12:48.210_184+00:00 [30739] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:12:48.210_314+00:00 [30739] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:12:48.210_319+00:00 [30739] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:12:48.210_384+00:00 [30767] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:12:48.210_387+00:00 [30767] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:12:48.210_396+00:00 [30767] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:12:48.210_407+00:00 [30767] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:12:48.210_411+00:00 [30767] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:12:48.210_432+00:00 [30767] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:12:48.210_529+00:00 [30767] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:12:48.210_542+00:00 [30767] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:12:48.210_601+00:00 [30767] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:12:48.210_606+00:00 [30767] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:12:48.210_615+00:00 [30767] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:13:07.452_547+00:00 [30763] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43398 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:13:08.734_209+00:00 [30763] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:08.734_223+00:00 [30763] [INFO] session 3 got connection from 127.0.0.1:43400 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:08.734_324+00:00 [30763] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:13:08.734_333+00:00 [30763] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:13:08.957_088+00:00 [30763] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:13:08.957_113+00:00 [30763] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:13:08.957_122+00:00 [30763] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:13:08.957_219+00:00 [30763] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:13:08.957_264+00:00 [30763] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:13:08.957_737+00:00 [30763] [INFO] 0x7ff700013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:13:08.957_932+00:00 [30763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:08.957_994+00:00 [30763] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:13:08.957_997+00:00 [30763] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:13:08.957_999+00:00 [30763] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:13:08.958_008+00:00 [30763] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:13:08.958_171+00:00 [30763] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:13:08.958_175+00:00 [30763] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:13:08.958_182+00:00 [30763] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:13:08.958_187+00:00 [30763] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:13:08.958_235+00:00 [30763] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:13:08.958_340+00:00 [30763] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:13:08.958_491+00:00 [30767] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:13:08.958_509+00:00 [30767] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:13:08.958_523+00:00 [30767] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:13:08.958_657+00:00 [30763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:09.458_762+00:00 [30742] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:10.008_750+00:00 [30742] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:10.608_844+00:00 [30742] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:11.259_026+00:00 [30742] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:11.959_397+00:00 [30742] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:12.453_101+00:00 [30742] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.453_118+00:00 [30742] [INFO] session 4 got connection from 127.0.0.1:43402 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.453_448+00:00 [30741] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.453_457+00:00 [30741] [INFO] session 5 got connection from 127.0.0.1:43404 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.453_871+00:00 [30749] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:12.453_916+00:00 [30749] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.453_923+00:00 [30749] [INFO] session 6 got connection from 127.0.0.1:43406 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.454_049+00:00 [30762] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.454_055+00:00 [30762] [INFO] session 7 got connection from 127.0.0.1:43408 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.454_230+00:00 [30754] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.454_237+00:00 [30754] [INFO] session 8 got connection from 127.0.0.1:43410 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.454_500+00:00 [30737] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.454_507+00:00 [30737] [INFO] session 9 got connection from 127.0.0.1:43412 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.455_040+00:00 [30736] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.455_048+00:00 [30736] [INFO] session 10 got connection from 127.0.0.1:43414 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.457_124+00:00 [30743] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.457_132+00:00 [30743] [INFO] session 11 got connection from 127.0.0.1:43416 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.457_622+00:00 [30752] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.457_630+00:00 [30752] [INFO] session 12 got connection from 127.0.0.1:43418 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.458_688+00:00 [30737] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:13:12.458_697+00:00 [30737] [INFO] session 13 got connection from 127.0.0.1:43420 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:13:12.582_054+00:00 [30756] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:12.837_922+00:00 [30735] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:13.337_942+00:00 [30738] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:13.838_902+00:00 [30757] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:14.338_620+00:00 [30756] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:14.838_475+00:00 [30737] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:15.338_514+00:00 [30764] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:15.838_866+00:00 [30738] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:16.338_971+00:00 [30740] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:16.838_982+00:00 [30749] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:17.339_110+00:00 [30762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:13:17.839_207+00:00 [30758] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:13:30.294_535+00:00 [30767] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:13:30.294_544+00:00 [30767] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:13:30.294_915+00:00 [30767] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:13:30.294_937+00:00 [30767] [INFO] create snapshot idx 100000 log_term 2 done: 386 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:13:47.516_298+00:00 [30951] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:13:47.517_702+00:00 [30951] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:13:47.517_736+00:00 [30951] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:13:47.517_744+00:00 [30951] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:13:47.517_768+00:00 [30951] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:13:47.517_772+00:00 [30951] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:13:47.517_775+00:00 [30951] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:13:47.517_812+00:00 [30951] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:13:47.518_209+00:00 [30987] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:13:48.998_056+00:00 [30958] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:13:48.998_068+00:00 [30958] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:13:48.998_083+00:00 [30958] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:13:48.998_096+00:00 [30958] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:13:48.998_103+00:00 [30958] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:13:48.998_107+00:00 [30958] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:13:48.998_127+00:00 [30958] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:13:48.998_190+00:00 [30986] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:13:48.998_199+00:00 [30986] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:13:48.998_210+00:00 [30986] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:14:09.588_056+00:00 [30958] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:09.588_076+00:00 [30958] [INFO] session 1 got connection from 127.0.0.1:43422 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:09.588_171+00:00 [30958] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:14:09.588_193+00:00 [30958] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:14:09.588_251+00:00 [30958] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:14:09.588_255+00:00 [30958] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:14:09.588_257+00:00 [30958] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:14:09.588_262+00:00 [30958] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:14:09.588_503+00:00 [30958] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43422 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:14:09.838_696+00:00 [30958] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:09.838_707+00:00 [30958] [INFO] session 2 got connection from 127.0.0.1:43424 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:09.838_790+00:00 [30958] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:14:09.838_793+00:00 [30958] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:14:09.838_920+00:00 [30958] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:14:09.838_925+00:00 [30958] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:14:09.838_988+00:00 [30986] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:14:09.838_992+00:00 [30986] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:14:09.839_000+00:00 [30986] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:14:09.839_011+00:00 [30986] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:14:09.839_016+00:00 [30986] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:14:09.839_035+00:00 [30986] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:14:09.839_132+00:00 [30986] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:14:09.839_144+00:00 [30986] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:14:09.839_202+00:00 [30986] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:14:09.839_206+00:00 [30986] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:14:09.839_216+00:00 [30986] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:14:29.333_708+00:00 [30968] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43424 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:14:30.480_704+00:00 [30968] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:30.480_719+00:00 [30968] [INFO] session 3 got connection from 127.0.0.1:43426 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:30.480_834+00:00 [30955] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:14:30.480_842+00:00 [30955] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:14:30.732_744+00:00 [30968] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:14:30.732_767+00:00 [30968] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:14:30.732_775+00:00 [30968] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:14:30.732_858+00:00 [30968] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:14:30.732_899+00:00 [30968] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:14:30.733_311+00:00 [30968] [INFO] 0x7f5b34013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:14:30.733_573+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:30.733_637+00:00 [30968] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:14:30.733_640+00:00 [30968] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:14:30.733_642+00:00 [30968] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:14:30.733_652+00:00 [30968] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:14:30.733_822+00:00 [30968] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:14:30.733_827+00:00 [30968] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:14:30.733_834+00:00 [30968] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:14:30.733_838+00:00 [30968] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:14:30.733_881+00:00 [30968] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:14:30.733_990+00:00 [30968] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:14:30.734_174+00:00 [30986] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:14:30.734_195+00:00 [30986] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:14:30.734_212+00:00 [30986] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:14:30.734_368+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:31.234_461+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:31.784_582+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:32.384_742+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:33.034_878+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:33.735_208+00:00 [30978] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:34.334_227+00:00 [30978] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.334_239+00:00 [30978] [INFO] session 4 got connection from 127.0.0.1:43428 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.334_574+00:00 [30966] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.334_583+00:00 [30966] [INFO] session 5 got connection from 127.0.0.1:43430 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.334_899+00:00 [30982] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.334_908+00:00 [30982] [INFO] session 6 got connection from 127.0.0.1:43432 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.335_480+00:00 [30969] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.335_488+00:00 [30969] [INFO] session 7 got connection from 127.0.0.1:43434 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.336_023+00:00 [30980] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:34.336_419+00:00 [30955] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.336_433+00:00 [30955] [INFO] session 8 got connection from 127.0.0.1:43436 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.336_805+00:00 [30983] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.336_812+00:00 [30983] [INFO] session 9 got connection from 127.0.0.1:43438 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.337_520+00:00 [30983] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.337_528+00:00 [30983] [INFO] session 10 got connection from 127.0.0.1:43440 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.338_517+00:00 [30967] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.338_525+00:00 [30967] [INFO] session 11 got connection from 127.0.0.1:43442 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.340_041+00:00 [30984] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.340_049+00:00 [30984] [INFO] session 12 got connection from 127.0.0.1:43444 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.340_500+00:00 [30974] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:14:34.340_509+00:00 [30974] [INFO] session 13 got connection from 127.0.0.1:43446 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:14:34.464_786+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:34.719_361+00:00 [30954] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:35.219_949+00:00 [30968] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:35.720_213+00:00 [30958] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:36.220_587+00:00 [30960] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:36.720_292+00:00 [30972] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:37.220_407+00:00 [30969] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:37.721_059+00:00 [30976] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:38.220_604+00:00 [30981] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:38.721_050+00:00 [30965] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:39.221_067+00:00 [30977] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:14:39.721_074+00:00 [30961] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:14:50.913_716+00:00 [30986] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:14:50.913_728+00:00 [30986] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:14:50.913_757+00:00 [30986] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:14:50.913_762+00:00 [30986] [INFO] create snapshot idx 100000 log_term 2 done: 28 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:15:09.390_649+00:00 [31184] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:15:09.392_381+00:00 [31184] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:15:09.392_422+00:00 [31184] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:15:09.392_431+00:00 [31184] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:15:09.392_458+00:00 [31184] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:15:09.392_462+00:00 [31184] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:15:09.392_466+00:00 [31184] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:15:09.392_501+00:00 [31184] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:15:09.392_676+00:00 [31220] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:15:10.933_713+00:00 [31191] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:15:10.933_725+00:00 [31191] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:15:10.933_740+00:00 [31191] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:15:10.933_751+00:00 [31191] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:15:10.933_758+00:00 [31191] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:15:10.933_761+00:00 [31191] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:15:10.933_780+00:00 [31191] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:15:10.933_832+00:00 [31219] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:15:10.933_840+00:00 [31219] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:15:10.933_851+00:00 [31219] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:15:30.966_331+00:00 [31191] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:15:30.966_354+00:00 [31191] [INFO] session 1 got connection from 127.0.0.1:43448 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:15:30.966_474+00:00 [31191] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:15:30.966_498+00:00 [31191] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:15:30.966_564+00:00 [31191] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:15:30.966_567+00:00 [31191] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:15:30.966_569+00:00 [31191] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:15:30.966_576+00:00 [31191] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:15:30.966_877+00:00 [31191] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43448 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:15:31.216_870+00:00 [31191] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:15:31.216_883+00:00 [31191] [INFO] session 2 got connection from 127.0.0.1:43450 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:15:31.216_965+00:00 [31191] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:15:31.216_969+00:00 [31191] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:15:31.217_096+00:00 [31191] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:15:31.217_101+00:00 [31191] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:15:31.217_166+00:00 [31219] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:15:31.217_169+00:00 [31219] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:15:31.217_177+00:00 [31219] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:15:31.217_189+00:00 [31219] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:15:31.217_193+00:00 [31219] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:15:31.217_212+00:00 [31219] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:15:31.217_307+00:00 [31219] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:15:31.217_320+00:00 [31219] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:15:31.217_379+00:00 [31219] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:15:31.217_384+00:00 [31219] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:15:31.217_393+00:00 [31219] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:15:50.959_869+00:00 [31210] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43450 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:15:51.747_641+00:00 [31210] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:15:51.747_667+00:00 [31210] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:15:51.747_676+00:00 [31210] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:15:51.747_758+00:00 [31210] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:15:51.747_805+00:00 [31210] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:15:51.748_277+00:00 [31210] [INFO] 0x7f9c54002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:15:51.748_478+00:00 [31210] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:15:51.748_541+00:00 [31210] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:15:52.312_887+00:00 [31210] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:15:52.312_901+00:00 [31210] [INFO] session 3 got connection from 127.0.0.1:43452 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:15:52.312_978+00:00 [31210] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:15:52.312_987+00:00 [31210] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:15:52.313_191+00:00 [31210] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:15:52.313_213+00:00 [31210] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:15:52.313_222+00:00 [31210] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:15:52.313_233+00:00 [31210] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:15:52.313_443+00:00 [31210] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:15:52.313_626+00:00 [31219] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:15:52.313_647+00:00 [31219] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:15:52.313_662+00:00 [31219] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:16:06.585_075+00:00 [31219] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:16:06.585_238+00:00 [31219] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:16:06.585_266+00:00 [31219] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:16:06.585_272+00:00 [31219] [INFO] create snapshot idx 100000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:16:31.029_164+00:00 [31430] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:16:31.030_526+00:00 [31430] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:16:31.030_565+00:00 [31430] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:16:31.030_570+00:00 [31430] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:16:31.030_597+00:00 [31430] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:16:31.030_601+00:00 [31430] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:16:31.030_604+00:00 [31430] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:16:31.030_633+00:00 [31430] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:16:31.030_810+00:00 [31466] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:16:33.023_838+00:00 [31437] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:16:33.023_849+00:00 [31437] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:16:33.023_865+00:00 [31437] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:16:33.023_877+00:00 [31437] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:16:33.023_884+00:00 [31437] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:16:33.023_888+00:00 [31437] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:16:33.023_908+00:00 [31437] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:16:33.023_959+00:00 [31465] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:16:33.023_966+00:00 [31465] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:16:33.023_977+00:00 [31465] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:16:52.604_705+00:00 [31437] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:16:52.604_725+00:00 [31437] [INFO] session 1 got connection from 127.0.0.1:43454 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:16:52.604_825+00:00 [31437] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:16:52.604_847+00:00 [31437] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:16:52.604_907+00:00 [31437] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:16:52.604_910+00:00 [31437] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:16:52.604_912+00:00 [31437] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:16:52.604_918+00:00 [31437] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:16:52.605_170+00:00 [31437] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43454 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:16:52.855_306+00:00 [31437] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:16:52.855_317+00:00 [31437] [INFO] session 2 got connection from 127.0.0.1:43458 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:16:52.855_396+00:00 [31437] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:16:52.855_400+00:00 [31437] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:16:52.855_524+00:00 [31437] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:16:52.855_528+00:00 [31437] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:16:52.855_592+00:00 [31465] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:16:52.855_595+00:00 [31465] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:16:52.855_604+00:00 [31465] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:16:52.855_615+00:00 [31465] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:16:52.855_667+00:00 [31465] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:16:52.855_691+00:00 [31465] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:16:52.855_801+00:00 [31465] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:16:52.855_820+00:00 [31465] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:16:52.855_889+00:00 [31465] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:16:52.855_892+00:00 [31465] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:16:52.855_897+00:00 [31465] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:17:12.598_004+00:00 [31463] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43458 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:17:13.858_711+00:00 [31463] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:17:13.858_735+00:00 [31463] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:17:13.858_744+00:00 [31463] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:17:13.858_820+00:00 [31463] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:17:13.858_868+00:00 [31463] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:17:13.859_320+00:00 [31463] [INFO] 0x7f3d24002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:17:13.859_523+00:00 [31463] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:17:13.859_585+00:00 [31463] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:17:14.354_200+00:00 [31463] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:17:14.354_215+00:00 [31463] [INFO] session 3 got connection from 127.0.0.1:43460 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:17:14.354_290+00:00 [31463] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:17:14.354_298+00:00 [31463] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:17:14.354_515+00:00 [31463] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:17:14.354_538+00:00 [31463] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:17:14.354_548+00:00 [31463] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:17:14.354_560+00:00 [31463] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:17:14.354_807+00:00 [31463] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:17:14.354_999+00:00 [31465] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:17:14.355_022+00:00 [31465] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:17:14.355_039+00:00 [31465] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:17:27.993_148+00:00 [31465] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:17:27.993_164+00:00 [31465] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:17:27.993_192+00:00 [31465] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:17:27.993_198+00:00 [31465] [INFO] create snapshot idx 100000 log_term 2 done: 28 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:20:15.455_329+00:00 [31733] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:20:15.456_694+00:00 [31733] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:20:15.456_727+00:00 [31733] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:20:15.456_734+00:00 [31733] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:20:15.456_758+00:00 [31733] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:20:15.456_761+00:00 [31733] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:20:15.456_764+00:00 [31733] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:20:15.456_794+00:00 [31733] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:20:15.456_953+00:00 [31769] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:20:17.501_026+00:00 [31740] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:20:17.501_037+00:00 [31740] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:20:17.501_052+00:00 [31740] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:20:17.501_064+00:00 [31740] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:20:17.501_071+00:00 [31740] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:20:17.501_075+00:00 [31740] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:20:17.501_094+00:00 [31740] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:20:17.501_147+00:00 [31768] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:20:17.501_155+00:00 [31768] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:20:17.501_166+00:00 [31768] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:20:36.777_276+00:00 [31740] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:20:36.777_299+00:00 [31740] [INFO] session 1 got connection from 127.0.0.1:43462 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:20:36.777_408+00:00 [31740] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:20:36.777_430+00:00 [31740] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:20:36.777_490+00:00 [31740] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:20:36.777_494+00:00 [31740] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:20:36.777_496+00:00 [31740] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:20:36.777_502+00:00 [31740] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:20:36.777_746+00:00 [31740] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43462 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:20:37.027_906+00:00 [31740] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:20:37.027_918+00:00 [31740] [INFO] session 2 got connection from 127.0.0.1:43464 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:20:37.028_002+00:00 [31740] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:20:37.028_005+00:00 [31740] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:20:37.028_163+00:00 [31740] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:20:37.028_168+00:00 [31740] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:20:37.028_232+00:00 [31768] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:20:37.028_236+00:00 [31768] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:20:37.028_244+00:00 [31768] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:20:37.028_256+00:00 [31768] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:20:37.028_260+00:00 [31768] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:20:37.028_281+00:00 [31768] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:20:37.028_378+00:00 [31768] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:20:37.028_390+00:00 [31768] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:20:37.028_466+00:00 [31768] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:20:37.028_471+00:00 [31768] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:20:37.028_480+00:00 [31768] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:20:57.024_546+00:00 [31745] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43464 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:20:58.291_625+00:00 [31745] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:20:58.291_649+00:00 [31745] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:20:58.291_658+00:00 [31745] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:20:58.291_731+00:00 [31745] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:20:58.291_778+00:00 [31745] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:20:58.292_225+00:00 [31745] [INFO] 0x7fd0f8002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:20:58.292_423+00:00 [31745] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:20:58.292_490+00:00 [31745] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:20:58.527_264+00:00 [31745] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:20:58.527_278+00:00 [31745] [INFO] session 3 got connection from 127.0.0.1:43466 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:20:58.527_354+00:00 [31745] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:20:58.527_362+00:00 [31745] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:20:58.527_562+00:00 [31745] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:20:58.527_584+00:00 [31745] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:20:58.527_594+00:00 [31745] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:20:58.527_605+00:00 [31745] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:20:58.527_821+00:00 [31745] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:20:58.528_029+00:00 [31768] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:20:58.528_047+00:00 [31768] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:20:58.528_059+00:00 [31768] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:21:16.061_694+00:00 [31768] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:21:16.061_707+00:00 [31768] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:21:16.061_732+00:00 [31768] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:21:16.061_738+00:00 [31768] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:21:37.086_921+00:00 [31979] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:21:37.088_314+00:00 [31979] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:21:37.088_354+00:00 [31979] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:21:37.088_358+00:00 [31979] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:21:37.088_383+00:00 [31979] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:21:37.088_387+00:00 [31979] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:21:37.088_390+00:00 [31979] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:21:37.088_424+00:00 [31979] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:21:37.088_577+00:00 [32015] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:21:38.594_623+00:00 [31986] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:21:38.594_634+00:00 [31986] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:21:38.594_648+00:00 [31986] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:21:38.594_674+00:00 [31986] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:21:38.594_682+00:00 [31986] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:21:38.594_687+00:00 [31986] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:21:38.594_709+00:00 [31986] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:21:38.594_761+00:00 [32014] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:21:38.594_768+00:00 [32014] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:21:38.594_778+00:00 [32014] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:21:58.656_378+00:00 [31986] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:21:58.656_397+00:00 [31986] [INFO] session 1 got connection from 127.0.0.1:43468 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:21:58.656_503+00:00 [31986] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:21:58.656_526+00:00 [31986] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:21:58.656_586+00:00 [31986] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:21:58.656_590+00:00 [31986] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:21:58.656_592+00:00 [31986] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:21:58.656_598+00:00 [31986] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:21:58.656_950+00:00 [31986] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43468 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:21:58.906_908+00:00 [31986] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:21:58.906_919+00:00 [31986] [INFO] session 2 got connection from 127.0.0.1:43470 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:21:58.907_002+00:00 [31986] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:21:58.907_006+00:00 [31986] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:21:58.907_132+00:00 [31986] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:21:58.907_136+00:00 [31986] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:21:58.907_202+00:00 [32014] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:21:58.907_205+00:00 [32014] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:21:58.907_213+00:00 [32014] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:21:58.907_225+00:00 [32014] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:21:58.907_229+00:00 [32014] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:21:58.907_249+00:00 [32014] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:21:58.907_347+00:00 [32014] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:21:58.907_360+00:00 [32014] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:21:58.907_422+00:00 [32014] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:21:58.907_426+00:00 [32014] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:21:58.907_435+00:00 [32014] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:22:18.655_641+00:00 [31996] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43470 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:22:19.615_136+00:00 [31996] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:22:19.615_158+00:00 [31996] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:22:19.615_166+00:00 [31996] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:22:19.615_243+00:00 [31996] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:22:19.615_292+00:00 [31996] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:22:19.615_741+00:00 [31996] [INFO] 0x7fca18002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:22:19.615_945+00:00 [31996] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:22:19.616_009+00:00 [31996] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:22:19.809_785+00:00 [31996] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:22:19.809_799+00:00 [31996] [INFO] session 3 got connection from 127.0.0.1:43472 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:22:19.809_873+00:00 [31996] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:22:19.809_881+00:00 [31996] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:22:19.810_076+00:00 [31996] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:22:19.810_098+00:00 [31996] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:22:19.810_107+00:00 [31996] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:22:19.810_118+00:00 [31996] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:22:19.810_319+00:00 [31996] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:22:19.810_506+00:00 [32014] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:22:19.810_529+00:00 [32014] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:22:19.810_546+00:00 [32014] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:22:32.117_103+00:00 [32014] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:22:32.117_116+00:00 [32014] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:22:32.117_141+00:00 [32014] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:22:32.117_146+00:00 [32014] [INFO] create snapshot idx 100000 log_term 2 done: 24 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:22:40.612_071+00:00 [32014] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:22:40.612_079+00:00 [32014] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:22:40.612_102+00:00 [32014] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:22:40.612_106+00:00 [32014] [INFO] create snapshot idx 200000 log_term 2 done: 22 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:22:58.731_053+00:00 [32201] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:22:58.732_458+00:00 [32201] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:22:58.732_490+00:00 [32201] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:22:58.732_496+00:00 [32201] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:22:58.732_518+00:00 [32201] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:22:58.732_522+00:00 [32201] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:22:58.732_525+00:00 [32201] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:22:58.732_556+00:00 [32201] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:22:58.732_702+00:00 [32237] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:23:00.583_774+00:00 [32208] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:23:00.583_790+00:00 [32208] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:23:00.583_809+00:00 [32208] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:23:00.583_834+00:00 [32208] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:23:00.583_842+00:00 [32208] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:23:00.583_845+00:00 [32208] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:23:00.583_864+00:00 [32208] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:23:00.583_925+00:00 [32236] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:23:00.583_945+00:00 [32236] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:23:00.583_957+00:00 [32236] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:23:20.303_482+00:00 [32208] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:23:20.303_507+00:00 [32208] [INFO] session 1 got connection from 127.0.0.1:43474 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:23:20.303_635+00:00 [32208] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:23:20.303_664+00:00 [32208] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:23:20.303_732+00:00 [32208] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:23:20.303_736+00:00 [32208] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:23:20.303_738+00:00 [32208] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:23:20.303_743+00:00 [32208] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:23:20.304_005+00:00 [32208] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43474 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:23:20.554_003+00:00 [32208] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:23:20.554_013+00:00 [32208] [INFO] session 2 got connection from 127.0.0.1:43476 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:23:20.554_091+00:00 [32208] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:23:20.554_095+00:00 [32208] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:23:20.554_222+00:00 [32208] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:23:20.554_226+00:00 [32208] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:23:20.554_288+00:00 [32236] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:23:20.554_291+00:00 [32236] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:23:20.554_297+00:00 [32236] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:23:20.554_307+00:00 [32236] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:23:20.554_310+00:00 [32236] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:23:20.554_326+00:00 [32236] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:23:20.554_407+00:00 [32236] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:23:20.554_417+00:00 [32236] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:23:20.554_464+00:00 [32236] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:23:20.554_467+00:00 [32236] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:23:20.554_473+00:00 [32236] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:23:40.804_529+00:00 [32226] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43476 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:23:42.201_687+00:00 [32226] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:23:42.201_710+00:00 [32226] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:23:42.201_719+00:00 [32226] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:23:42.201_801+00:00 [32226] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:23:42.201_849+00:00 [32226] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:23:42.202_335+00:00 [32226] [INFO] 0x7ff858002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:23:42.202_540+00:00 [32226] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:23:42.202_606+00:00 [32226] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:23:42.389_946+00:00 [32226] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:23:42.389_958+00:00 [32226] [INFO] session 3 got connection from 127.0.0.1:43478 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:23:42.390_025+00:00 [32226] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:23:42.390_032+00:00 [32226] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:23:42.390_192+00:00 [32226] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:23:42.390_211+00:00 [32226] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:23:42.390_218+00:00 [32226] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:23:42.390_228+00:00 [32226] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:23:42.390_440+00:00 [32226] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:23:42.390_651+00:00 [32236] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:23:42.390_685+00:00 [32236] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:23:42.390_701+00:00 [32236] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:23:52.465_548+00:00 [32236] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:23:52.465_560+00:00 [32236] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:23:52.465_585+00:00 [32236] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:23:52.465_590+00:00 [32236] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:23:59.165_416+00:00 [32236] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:23:59.165_430+00:00 [32236] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:23:59.165_456+00:00 [32236] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:23:59.165_461+00:00 [32236] [INFO] create snapshot idx 200000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:24:20.883_504+00:00 [32422] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:24:20.884_952+00:00 [32422] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:24:20.884_984+00:00 [32422] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:24:20.884_993+00:00 [32422] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:24:20.885_014+00:00 [32422] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:24:20.885_018+00:00 [32422] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:24:20.885_021+00:00 [32422] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:24:20.885_055+00:00 [32422] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:24:20.885_204+00:00 [32458] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:24:22.284_240+00:00 [32429] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:24:22.284_251+00:00 [32429] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:24:22.284_265+00:00 [32429] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:24:22.284_275+00:00 [32429] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:24:22.284_281+00:00 [32429] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:24:22.284_285+00:00 [32429] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:24:22.284_303+00:00 [32429] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:24:22.284_354+00:00 [32457] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:24:22.284_362+00:00 [32457] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:24:22.284_371+00:00 [32457] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:24:42.205_085+00:00 [32429] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:24:42.205_107+00:00 [32429] [INFO] session 1 got connection from 127.0.0.1:43480 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:24:42.205_214+00:00 [32429] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:24:42.205_238+00:00 [32429] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:24:42.205_302+00:00 [32429] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:24:42.205_305+00:00 [32429] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:24:42.205_308+00:00 [32429] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:24:42.205_313+00:00 [32429] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:24:42.205_555+00:00 [32429] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43480 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:24:42.455_869+00:00 [32429] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:24:42.455_881+00:00 [32429] [INFO] session 2 got connection from 127.0.0.1:43482 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:24:42.455_965+00:00 [32429] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:24:42.455_968+00:00 [32429] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:24:42.456_094+00:00 [32429] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:24:42.456_099+00:00 [32429] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:24:42.456_163+00:00 [32457] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:24:42.456_166+00:00 [32457] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:24:42.456_174+00:00 [32457] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:24:42.456_187+00:00 [32457] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:24:42.456_193+00:00 [32457] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:24:42.456_217+00:00 [32457] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:24:42.456_342+00:00 [32457] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:24:42.456_355+00:00 [32457] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:24:42.456_405+00:00 [32457] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:24:42.456_408+00:00 [32457] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:24:42.456_416+00:00 [32457] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:25:02.952_486+00:00 [32448] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43482 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:25:03.722_120+00:00 [32448] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:03.722_134+00:00 [32448] [INFO] session 3 got connection from 127.0.0.1:43484 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:03.722_234+00:00 [32448] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:25:03.722_242+00:00 [32448] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:25:04.105_646+00:00 [32448] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:25:04.105_671+00:00 [32448] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:25:04.105_679+00:00 [32448] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:25:04.105_771+00:00 [32448] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:25:04.105_812+00:00 [32448] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:25:04.106_304+00:00 [32448] [INFO] 0x7f5720013df0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:25:04.106_509+00:00 [32448] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:04.106_577+00:00 [32448] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:25:04.106_580+00:00 [32448] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:25:04.106_583+00:00 [32448] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:25:04.106_592+00:00 [32448] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:25:04.106_786+00:00 [32441] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:25:04.106_792+00:00 [32441] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:25:04.106_800+00:00 [32441] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:25:04.106_803+00:00 [32441] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:25:04.106_840+00:00 [32441] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:25:04.106_950+00:00 [32441] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:25:04.107_129+00:00 [32457] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:25:04.107_147+00:00 [32457] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:25:04.107_160+00:00 [32457] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:25:04.107_296+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:04.607_348+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:05.157_389+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:05.757_569+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:06.407_726+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:07.108_033+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:07.857_992+00:00 [32441] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:07.952_563+00:00 [32441] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.952_577+00:00 [32441] [INFO] session 4 got connection from 127.0.0.1:43486 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.952_895+00:00 [32454] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.952_905+00:00 [32454] [INFO] session 5 got connection from 127.0.0.1:43488 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.953_420+00:00 [32437] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.953_431+00:00 [32437] [INFO] session 6 got connection from 127.0.0.1:43490 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.953_766+00:00 [32450] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.953_775+00:00 [32450] [INFO] session 7 got connection from 127.0.0.1:43492 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.954_784+00:00 [32455] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.954_793+00:00 [32455] [INFO] session 8 got connection from 127.0.0.1:43496 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.955_191+00:00 [32442] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.955_199+00:00 [32442] [INFO] session 9 got connection from 127.0.0.1:43498 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.956_965+00:00 [32438] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.956_973+00:00 [32438] [INFO] session 10 got connection from 127.0.0.1:43500 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.957_386+00:00 [32442] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:07.957_394+00:00 [32442] [INFO] session 11 got connection from 127.0.0.1:43502 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:07.986_374+00:00 [32456] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:08.242_203+00:00 [32452] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:08.742_499+00:00 [32438] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:09.243_304+00:00 [32443] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:09.743_402+00:00 [32431] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:10.243_476+00:00 [32427] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:10.743_984+00:00 [32430] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:11.244_524+00:00 [32439] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:11.745_400+00:00 [32442] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:12.245_980+00:00 [32438] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:12.745_658+00:00 [32451] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:25:13.153_858+00:00 [32448] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:13.153_872+00:00 [32448] [INFO] session 12 got connection from 127.0.0.1:43504 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:13.245_755+00:00 [32443] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:25:14.434_016+00:00 [32426] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:25:14.434_027+00:00 [32426] [INFO] session 13 got connection from 127.0.0.1:43506 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:25:21.986_392+00:00 [32457] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:25:21.986_404+00:00 [32457] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:25:21.986_428+00:00 [32457] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:25:21.986_434+00:00 [32457] [INFO] create snapshot idx 100000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:25:43.015_856+00:00 [32629] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:25:43.017_234+00:00 [32629] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:25:43.017_267+00:00 [32629] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:25:43.017_277+00:00 [32629] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:25:43.017_300+00:00 [32629] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:25:43.017_304+00:00 [32629] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:25:43.017_306+00:00 [32629] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:25:43.017_343+00:00 [32629] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:25:43.017_490+00:00 [32665] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:25:44.590_564+00:00 [32636] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:25:44.590_576+00:00 [32636] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:25:44.590_593+00:00 [32636] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:25:44.590_604+00:00 [32636] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:25:44.590_611+00:00 [32636] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:25:44.590_615+00:00 [32636] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:25:44.590_634+00:00 [32636] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:25:44.590_723+00:00 [32664] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:25:44.590_732+00:00 [32664] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:25:44.590_742+00:00 [32664] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:26:05.087_320+00:00 [32636] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:26:05.087_341+00:00 [32636] [INFO] session 1 got connection from 127.0.0.1:43508 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:26:05.087_442+00:00 [32636] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:26:05.087_465+00:00 [32636] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:26:05.087_525+00:00 [32636] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:26:05.087_528+00:00 [32636] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:26:05.087_530+00:00 [32636] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:26:05.087_536+00:00 [32636] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:26:05.087_781+00:00 [32636] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43508 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:26:05.337_987+00:00 [32636] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:26:05.337_998+00:00 [32636] [INFO] session 2 got connection from 127.0.0.1:43510 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:26:05.338_077+00:00 [32636] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:26:05.338_080+00:00 [32636] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:26:05.338_205+00:00 [32636] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:26:05.338_209+00:00 [32636] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:26:05.338_274+00:00 [32664] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:26:05.338_277+00:00 [32664] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:26:05.338_286+00:00 [32664] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:26:05.338_297+00:00 [32664] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:26:05.338_301+00:00 [32664] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:26:05.338_321+00:00 [32664] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:26:05.338_413+00:00 [32664] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:26:05.338_426+00:00 [32664] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:26:05.338_482+00:00 [32664] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:26:05.338_487+00:00 [32664] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:26:05.338_495+00:00 [32664] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:26:24.584_443+00:00 [32657] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43510 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:26:25.813_602+00:00 [32657] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:26:25.813_627+00:00 [32657] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:26:25.813_635+00:00 [32657] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:26:25.813_710+00:00 [32657] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:26:25.813_764+00:00 [32657] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:26:25.814_256+00:00 [32657] [INFO] 0x7f4aa4002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:26:25.814_448+00:00 [32657] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:26:25.814_527+00:00 [32657] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:26:26.103_463+00:00 [32632] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:26:26.103_477+00:00 [32632] [INFO] session 3 got connection from 127.0.0.1:43512 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:26:26.103_578+00:00 [32632] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:26:26.103_586+00:00 [32632] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:26:26.103_770+00:00 [32632] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:26:26.103_792+00:00 [32632] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:26:26.103_801+00:00 [32632] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:26:26.103_813+00:00 [32632] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:26:26.104_041+00:00 [32632] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:26:26.104_263+00:00 [32664] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:26:26.104_285+00:00 [32664] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:26:26.104_302+00:00 [32664] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:26:34.779_615+00:00 [32664] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:26:34.779_628+00:00 [32664] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:26:34.779_655+00:00 [32664] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:26:34.779_660+00:00 [32664] [INFO] create snapshot idx 100000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:26:39.990_755+00:00 [32664] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:26:39.990_766+00:00 [32664] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:26:39.990_792+00:00 [32664] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:26:39.990_797+00:00 [32664] [INFO] create snapshot idx 200000 log_term 2 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:26:45.213_715+00:00 [32664] [INFO] creating a snapshot for index 300000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:26:45.213_728+00:00 [32664] [INFO] create snapshot idx 300000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:26:45.213_755+00:00 [32664] [INFO] snapshot idx 300000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:26:45.213_760+00:00 [32664] [INFO] create snapshot idx 300000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:27:04.683_288+00:00 [32856] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:27:04.684_671+00:00 [32856] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:27:04.684_706+00:00 [32856] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:27:04.684_711+00:00 [32856] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:27:04.684_733+00:00 [32856] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:27:04.684_737+00:00 [32856] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:27:04.684_740+00:00 [32856] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:27:04.684_771+00:00 [32856] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:27:04.684_923+00:00 [32892] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:27:06.234_980+00:00 [32863] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:27:06.234_991+00:00 [32863] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:27:06.235_006+00:00 [32863] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:27:06.235_023+00:00 [32863] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:27:06.235_030+00:00 [32863] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:27:06.235_034+00:00 [32863] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:27:06.235_052+00:00 [32863] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:27:06.235_102+00:00 [32891] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:27:06.235_110+00:00 [32891] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:27:06.235_120+00:00 [32891] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:27:26.005_648+00:00 [32863] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:27:26.005_669+00:00 [32863] [INFO] session 1 got connection from 127.0.0.1:43514 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:27:26.005_774+00:00 [32863] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:27:26.005_797+00:00 [32863] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:27:26.005_862+00:00 [32863] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:27:26.005_866+00:00 [32863] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:27:26.005_868+00:00 [32863] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:27:26.005_874+00:00 [32863] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:27:26.006_123+00:00 [32863] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43514 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:27:26.256_421+00:00 [32863] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:27:26.256_433+00:00 [32863] [INFO] session 2 got connection from 127.0.0.1:43518 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:27:26.256_517+00:00 [32863] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:27:26.256_521+00:00 [32863] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:27:26.256_644+00:00 [32863] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:27:26.256_648+00:00 [32863] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:27:26.256_719+00:00 [32891] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:27:26.256_724+00:00 [32891] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:27:26.256_735+00:00 [32891] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:27:26.256_751+00:00 [32891] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:27:26.256_761+00:00 [32891] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:27:26.256_784+00:00 [32891] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:27:26.256_904+00:00 [32891] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:27:26.256_926+00:00 [32891] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:27:26.256_985+00:00 [32891] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:27:26.256_989+00:00 [32891] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:27:26.256_998+00:00 [32891] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:27:46.502_863+00:00 [32885] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43518 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:27:47.616_019+00:00 [32885] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:27:47.616_042+00:00 [32885] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:27:47.616_051+00:00 [32885] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:27:47.616_120+00:00 [32885] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:27:47.616_170+00:00 [32885] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:27:47.616_604+00:00 [32885] [INFO] 0x7fd0b0002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:27:47.616_807+00:00 [32885] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:27:47.616_878+00:00 [32885] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:27:47.807_616+00:00 [32885] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:27:47.807_630+00:00 [32885] [INFO] session 3 got connection from 127.0.0.1:43520 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:27:47.807_705+00:00 [32885] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:27:47.807_712+00:00 [32885] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:27:47.807_912+00:00 [32885] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:27:47.807_936+00:00 [32885] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:27:47.807_945+00:00 [32885] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:27:47.807_956+00:00 [32885] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:27:47.808_169+00:00 [32885] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:27:47.808_394+00:00 [32891] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:27:47.808_416+00:00 [32891] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:27:47.808_430+00:00 [32891] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:27:56.280_286+00:00 [32891] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:27:56.280_300+00:00 [32891] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:27:56.280_327+00:00 [32891] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:27:56.280_333+00:00 [32891] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:28:01.075_810+00:00 [32891] [INFO] creating a snapshot for index 200000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:28:01.075_823+00:00 [32891] [INFO] create snapshot idx 200000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:28:01.075_849+00:00 [32891] [INFO] snapshot idx 200000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:28:01.075_854+00:00 [32891] [INFO] create snapshot idx 200000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:28:05.870_924+00:00 [32891] [INFO] creating a snapshot for index 300000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:28:05.870_937+00:00 [32891] [INFO] create snapshot idx 300000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:28:05.870_962+00:00 [32891] [INFO] snapshot idx 300000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:28:05.870_967+00:00 [32891] [INFO] create snapshot idx 300000 log_term 2 done: 24 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:28:10.672_866+00:00 [32891] [INFO] creating a snapshot for index 400000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:28:10.672_879+00:00 [32891] [INFO] create snapshot idx 400000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:28:10.672_905+00:00 [32891] [INFO] snapshot idx 400000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:28:10.672_911+00:00 [32891] [INFO] create snapshot idx 400000 log_term 2 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:28:26.602_729+00:00 [33091] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:28:26.604_138+00:00 [33091] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:28:26.604_171+00:00 [33091] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:28:26.604_178+00:00 [33091] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:28:26.604_201+00:00 [33091] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:28:26.604_206+00:00 [33091] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:28:26.604_209+00:00 [33091] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:28:26.604_246+00:00 [33091] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:28:26.604_396+00:00 [33127] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:28:28.169_461+00:00 [33098] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:28:28.169_473+00:00 [33098] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:28:28.169_488+00:00 [33098] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:28:28.169_499+00:00 [33098] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:28:28.169_505+00:00 [33098] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:28:28.169_509+00:00 [33098] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:28:28.169_527+00:00 [33098] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:28:28.169_581+00:00 [33126] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:28:28.169_589+00:00 [33126] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:28:28.169_599+00:00 [33126] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:28:48.174_538+00:00 [33098] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:28:48.174_555+00:00 [33098] [INFO] session 1 got connection from 127.0.0.1:43522 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:28:48.174_679+00:00 [33098] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:28:48.174_707+00:00 [33098] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:28:48.174_775+00:00 [33098] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:28:48.174_778+00:00 [33098] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:28:48.174_780+00:00 [33098] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:28:48.174_785+00:00 [33098] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:28:48.175_014+00:00 [33098] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43522 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:28:48.425_135+00:00 [33098] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:28:48.425_147+00:00 [33098] [INFO] session 2 got connection from 127.0.0.1:43524 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:28:48.425_235+00:00 [33098] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:28:48.425_238+00:00 [33098] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:28:48.425_367+00:00 [33098] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:28:48.425_371+00:00 [33098] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:28:48.425_436+00:00 [33126] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:28:48.425_440+00:00 [33126] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:28:48.425_448+00:00 [33126] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:28:48.425_459+00:00 [33126] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:28:48.425_464+00:00 [33126] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:28:48.425_483+00:00 [33126] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:28:48.425_579+00:00 [33126] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:28:48.425_596+00:00 [33126] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:28:48.425_656+00:00 [33126] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:28:48.425_661+00:00 [33126] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:28:48.425_670+00:00 [33126] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:29:08.171_205+00:00 [33117] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43524 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:29:08.953_699+00:00 [33117] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:29:08.953_722+00:00 [33117] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:29:08.953_729+00:00 [33117] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:29:08.953_811+00:00 [33117] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:29:08.953_855+00:00 [33117] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:29:08.954_303+00:00 [33117] [INFO] 0x7f72f4002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:29:08.954_499+00:00 [33117] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:29:08.954_571+00:00 [33117] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:29:09.737_345+00:00 [33117] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:29:09.737_360+00:00 [33117] [INFO] session 3 got connection from 127.0.0.1:43528 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:29:09.737_436+00:00 [33117] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:29:09.737_445+00:00 [33117] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:29:09.737_655+00:00 [33117] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:29:09.737_678+00:00 [33117] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:29:09.737_687+00:00 [33117] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:29:09.737_698+00:00 [33117] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:29:09.737_869+00:00 [33117] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:29:09.738_029+00:00 [33126] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:29:09.738_048+00:00 [33126] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:29:09.738_062+00:00 [33126] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:29:23.419_276+00:00 [33126] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:29:23.419_289+00:00 [33126] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:29:23.419_317+00:00 [33126] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:29:23.419_322+00:00 [33126] [INFO] create snapshot idx 100000 log_term 2 done: 27 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:29:48.239_081+00:00 [33303] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:29:48.240_479+00:00 [33303] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:29:48.240_523+00:00 [33303] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:29:48.240_528+00:00 [33303] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:29:48.240_553+00:00 [33303] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:29:48.240_558+00:00 [33303] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:29:48.240_561+00:00 [33303] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:29:48.240_590+00:00 [33303] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:29:48.240_746+00:00 [33339] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:29:50.229_807+00:00 [33310] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:29:50.229_819+00:00 [33310] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:29:50.229_835+00:00 [33310] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:29:50.229_847+00:00 [33310] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:29:50.229_853+00:00 [33310] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:29:50.229_858+00:00 [33310] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:29:50.229_878+00:00 [33310] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:29:50.229_934+00:00 [33338] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:29:50.229_943+00:00 [33338] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:29:50.229_954+00:00 [33338] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:30:10.310_860+00:00 [33310] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:30:10.310_886+00:00 [33310] [INFO] session 1 got connection from 127.0.0.1:43530 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:30:10.311_043+00:00 [33310] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:30:10.311_075+00:00 [33310] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:30:10.311_157+00:00 [33310] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:30:10.311_163+00:00 [33310] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:30:10.311_166+00:00 [33310] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:30:10.311_174+00:00 [33310] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:30:10.311_433+00:00 [33310] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43530 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:30:10.561_448+00:00 [33310] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:30:10.561_460+00:00 [33310] [INFO] session 2 got connection from 127.0.0.1:43532 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:30:10.561_555+00:00 [33310] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:30:10.561_559+00:00 [33310] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:30:10.561_699+00:00 [33310] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:30:10.561_704+00:00 [33310] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:30:10.561_772+00:00 [33338] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:30:10.561_775+00:00 [33338] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:30:10.561_784+00:00 [33338] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:30:10.561_795+00:00 [33338] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:30:10.561_799+00:00 [33338] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:30:10.561_818+00:00 [33338] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:30:10.561_916+00:00 [33338] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:30:10.561_929+00:00 [33338] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:30:10.561_987+00:00 [33338] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:30:10.561_991+00:00 [33338] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:30:10.562_000+00:00 [33338] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:30:30.308_248+00:00 [33329] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43532 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:30:31.165_140+00:00 [33329] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:30:31.165_164+00:00 [33329] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:30:31.165_172+00:00 [33329] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:30:31.165_255+00:00 [33329] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:30:31.165_305+00:00 [33329] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:30:31.165_797+00:00 [33329] [INFO] 0x7f7520002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:30:31.165_996+00:00 [33329] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:30:31.166_059+00:00 [33329] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:30:31.555_418+00:00 [33329] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:30:31.555_434+00:00 [33329] [INFO] session 3 got connection from 127.0.0.1:43534 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:30:31.555_512+00:00 [33329] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:30:31.555_521+00:00 [33329] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:30:31.555_724+00:00 [33329] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:30:31.555_747+00:00 [33329] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:30:31.555_757+00:00 [33329] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:30:31.555_768+00:00 [33329] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:30:31.555_978+00:00 [33329] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:30:31.556_172+00:00 [33338] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:30:31.556_196+00:00 [33338] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:30:31.556_214+00:00 [33338] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:30:45.303_470+00:00 [33338] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:30:45.303_485+00:00 [33338] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:30:45.303_515+00:00 [33338] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:30:45.303_520+00:00 [33338] [INFO] create snapshot idx 100000 log_term 2 done: 29 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:31:10.378_000+00:00 [33518] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:31:10.379_432+00:00 [33518] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:31:10.379_463+00:00 [33518] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:31:10.379_469+00:00 [33518] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:31:10.379_491+00:00 [33518] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:31:10.379_495+00:00 [33518] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:31:10.379_498+00:00 [33518] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:31:10.379_527+00:00 [33518] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:31:10.379_676+00:00 [33554] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:31:11.744_768+00:00 [33525] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:31:11.744_780+00:00 [33525] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:31:11.744_795+00:00 [33525] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:31:11.744_806+00:00 [33525] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:31:11.744_813+00:00 [33525] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:31:11.744_817+00:00 [33525] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:31:11.744_835+00:00 [33525] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:31:11.744_890+00:00 [33553] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:31:11.744_898+00:00 [33553] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:31:11.744_908+00:00 [33553] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:31:32.190_399+00:00 [33525] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:31:32.190_423+00:00 [33525] [INFO] session 1 got connection from 127.0.0.1:43536 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:31:32.190_547+00:00 [33525] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:31:32.190_572+00:00 [33525] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:31:32.190_638+00:00 [33525] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:31:32.190_642+00:00 [33525] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:31:32.190_644+00:00 [33525] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:31:32.190_650+00:00 [33525] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:31:32.190_926+00:00 [33525] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43536 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:31:32.440_966+00:00 [33525] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:31:32.440_977+00:00 [33525] [INFO] session 2 got connection from 127.0.0.1:43538 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:31:32.441_059+00:00 [33525] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:31:32.441_063+00:00 [33525] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:31:32.441_191+00:00 [33525] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:31:32.441_195+00:00 [33525] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:31:32.441_260+00:00 [33553] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:31:32.441_264+00:00 [33553] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:31:32.441_272+00:00 [33553] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:31:32.441_283+00:00 [33553] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:31:32.441_287+00:00 [33553] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:31:32.441_306+00:00 [33553] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:31:32.441_428+00:00 [33553] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:31:32.441_446+00:00 [33553] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:31:32.441_508+00:00 [33553] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:31:32.441_513+00:00 [33553] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:31:32.441_522+00:00 [33553] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:31:52.190_740+00:00 [33537] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43538 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:31:52.863_470+00:00 [33537] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:31:52.863_492+00:00 [33537] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:31:52.863_500+00:00 [33537] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:31:52.863_563+00:00 [33537] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:31:52.863_607+00:00 [33537] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:31:52.864_020+00:00 [33537] [INFO] 0x7fcba0002b80 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:31:52.864_200+00:00 [33537] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:31:52.864_264+00:00 [33537] [INFO] [PRE-VOTE RESP] peer 3 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:31:53.780_272+00:00 [33537] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:31:53.780_288+00:00 [33537] [INFO] session 3 got connection from 127.0.0.1:43540 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:31:53.780_365+00:00 [33537] [INFO] [PRE-VOTE REQ] my role candidate, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:31:53.780_373+00:00 [33537] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-27T13:31:53.780_580+00:00 [33537] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-27T13:31:53.780_601+00:00 [33537] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:31:53.780_610+00:00 [33537] [INFO] [VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-27T13:31:53.780_621+00:00 [33537] [INFO] decision: O (grant), voted_for 3, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-27T13:31:53.780_823+00:00 [33537] [INFO] receive a config change from leader at 4	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:31:53.781_014+00:00 [33553] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:31:53.781_038+00:00 [33553] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:31:53.781_055+00:00 [33553] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:32:07.715_052+00:00 [33553] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:32:07.715_066+00:00 [33553] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:32:07.715_243+00:00 [33553] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:32:07.715_250+00:00 [33553] [INFO] create snapshot idx 100000 log_term 2 done: 178 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-27T13:32:32.260_418+00:00 [33752] [====] Start logger: ./srv2.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-27T13:32:32.261_809+00:00 [33752] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-27T13:32:32.261_842+00:00 [33752] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-27T13:32:32.261_847+00:00 [33752] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-27T13:32:32.261_874+00:00 [33752] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-27T13:32:32.261_878+00:00 [33752] [INFO] peer 2: DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-27T13:32:32.261_881+00:00 [33752] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-27T13:32:32.261_911+00:00 [33752] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-27T13:32:32.262_057+00:00 [33788] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-27T13:32:34.079_131+00:00 [33759] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:32:34.079_144+00:00 [33759] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-27T13:32:34.079_160+00:00 [33759] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:32:34.079_171+00:00 [33759] [INFO] [VOTE INIT] my id 2, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:32:34.079_178+00:00 [33759] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:32:34.079_182+00:00 [33759] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-27T13:32:34.079_200+00:00 [33759] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-27T13:32:34.079_252+00:00 [33787] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:32:34.079_260+00:00 [33787] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:32:34.079_271+00:00 [33787] [INFO] new configuration: log idx 1, prev log idx 0
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 2, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:32:54.323_685+00:00 [33759] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:32:54.323_700+00:00 [33759] [INFO] session 1 got connection from 127.0.0.1:43542 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:32:54.323_809+00:00 [33759] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-27T13:32:54.323_836+00:00 [33759] [INFO] new config log idx 1, prev log idx 0, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:32:54.323_912+00:00 [33759] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:32:54.323_916+00:00 [33759] [INFO] peer 2 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-27T13:32:54.323_918+00:00 [33759] [INFO] add peer 1, tcp://localhost:12347, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:32:54.323_923+00:00 [33759] [INFO] new configuration: log idx 1, prev log idx 0
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:32:54.324_226+00:00 [33759] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:43542 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:32:54.574_333+00:00 [33759] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:32:54.574_346+00:00 [33759] [INFO] session 2 got connection from 127.0.0.1:43544 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:32:54.574_434+00:00 [33759] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-27T13:32:54.574_437+00:00 [33759] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-27T13:32:54.574_561+00:00 [33759] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:32:54.574_565+00:00 [33759] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-27T13:32:54.574_630+00:00 [33787] [INFO] config at index 1 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:32:54.574_634+00:00 [33787] [INFO] skipped config 1, latest config 1	[handle_commit.cxx:405, commit_conf()]
2022-04-27T13:32:54.574_642+00:00 [33787] [INFO] config at index 2 is committed, prev config log idx 1	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:32:54.574_654+00:00 [33787] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:32:54.574_674+00:00 [33787] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-27T13:32:54.574_698+00:00 [33787] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:32:54.574_824+00:00 [33787] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:32:54.574_841+00:00 [33787] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:32:54.574_898+00:00 [33787] [INFO] server 3 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-27T13:32:54.574_902+00:00 [33787] [INFO] add peer 3, tcp://localhost:12346, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-27T13:32:54.574_909+00:00 [33787] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:33:13.571_080+00:00 [33778] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:43544 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-27T13:33:14.147_027+00:00 [33778] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:14.147_042+00:00 [33778] [INFO] session 3 got connection from 127.0.0.1:43546 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:14.147_142+00:00 [33778] [INFO] [PRE-VOTE REQ] my role follower, from peer 3, log term: req 1 / mine 1
last idx: req 3 / mine 3, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-27T13:33:14.147_150+00:00 [33778] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-27T13:33:14.625_897+00:00 [33778] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-27T13:33:14.625_920+00:00 [33778] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-27T13:33:14.625_929+00:00 [33778] [INFO] reset RPC client for peer 3	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:33:14.626_015+00:00 [33778] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-27T13:33:14.626_053+00:00 [33778] [INFO] [PRE-VOTE INIT] my id 2, my role candidate, term 1, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-27T13:33:14.626_509+00:00 [33778] [INFO] 0x7f16fc013cc0 connected to localhost:12346 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-27T13:33:14.626_740+00:00 [33778] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:14.626_806+00:00 [33778] [INFO] [PRE-VOTE RESP] peer 3 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-27T13:33:14.626_809+00:00 [33778] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-27T13:33:14.626_811+00:00 [33778] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-27T13:33:14.626_821+00:00 [33778] [INFO] [VOTE INIT] my id 2, my role candidate, term 2, log idx 3, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-27T13:33:14.626_980+00:00 [33778] [INFO] [VOTE RESP] peer 3 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-27T13:33:14.626_984+00:00 [33778] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-27T13:33:14.626_991+00:00 [33778] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-27T13:33:14.626_996+00:00 [33778] [INFO] state machine commit index 3, precommit index 3, last log index 3	[raft_server.cxx:953, become_leader()]
2022-04-27T13:33:14.627_036+00:00 [33778] [INFO] [BECOME LEADER] appended new config at 4	[raft_server.cxx:993, become_leader()]
2022-04-27T13:33:14.627_146+00:00 [33778] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-27T13:33:14.627_318+00:00 [33787] [INFO] config at index 4 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-27T13:33:14.627_339+00:00 [33787] [INFO] new config log idx 4, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-27T13:33:14.627_354+00:00 [33787] [INFO] new configuration: log idx 4, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 2, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-27T13:33:14.627_507+00:00 [33778] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:15.127_594+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:15.677_640+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:16.277_946+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:16.927_911+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:17.628_256+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:18.378_294+00:00 [33770] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:18.571_735+00:00 [33770] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.571_750+00:00 [33770] [INFO] session 4 got connection from 127.0.0.1:43548 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.572_078+00:00 [33771] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.572_087+00:00 [33771] [INFO] session 5 got connection from 127.0.0.1:43550 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.572_355+00:00 [33755] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.572_363+00:00 [33755] [INFO] session 6 got connection from 127.0.0.1:43552 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.572_993+00:00 [33764] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:18.573_287+00:00 [33775] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.573_295+00:00 [33775] [INFO] session 7 got connection from 127.0.0.1:43554 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.573_720+00:00 [33759] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.573_728+00:00 [33759] [INFO] session 8 got connection from 127.0.0.1:43556 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.574_304+00:00 [33773] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.574_312+00:00 [33773] [INFO] session 9 got connection from 127.0.0.1:43558 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.575_353+00:00 [33770] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.575_363+00:00 [33770] [INFO] session 10 got connection from 127.0.0.1:43560 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.576_130+00:00 [33756] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.576_138+00:00 [33756] [INFO] session 11 got connection from 127.0.0.1:43562 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.576_443+00:00 [33772] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.576_451+00:00 [33772] [INFO] session 12 got connection from 127.0.0.1:43564 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.576_948+00:00 [33761] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-27T13:33:18.576_956+00:00 [33761] [INFO] session 13 got connection from 127.0.0.1:43566 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-27T13:33:18.829_082+00:00 [33763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:19.329_154+00:00 [33764] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:19.829_247+00:00 [33775] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:20.329_675+00:00 [33780] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:20.829_465+00:00 [33773] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:21.329_479+00:00 [33766] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:21.829_681+00:00 [33761] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:22.330_043+00:00 [33760] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:22.830_296+00:00 [33783] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:23.330_327+00:00 [33763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-27T13:33:23.830_449+00:00 [33775] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-27T13:33:34.210_996+00:00 [33787] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-27T13:33:34.211_009+00:00 [33787] [INFO] create snapshot idx 100000 log_term 2	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-27T13:33:34.211_103+00:00 [33787] [INFO] snapshot idx 100000 log_term 2 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-27T13:33:34.211_211+00:00 [33787] [INFO] create snapshot idx 100000 log_term 2 done: 130 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
