2022-04-29T05:25:25.004_562+00:00 [48025] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:25:25.006_657+00:00 [48025] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:25:25.006_721+00:00 [48025] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:25:25.006_729+00:00 [48025] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:25:25.006_757+00:00 [48025] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:25:25.006_762+00:00 [48025] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:25:25.006_765+00:00 [48025] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:25:25.006_805+00:00 [48025] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:25:25.007_331+00:00 [48064] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:25:26.215_016+00:00 [48035] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:25:26.215_027+00:00 [48035] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:25:26.215_043+00:00 [48035] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:25:26.215_054+00:00 [48035] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:25:26.215_060+00:00 [48035] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:25:26.215_064+00:00 [48035] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:25:26.215_083+00:00 [48035] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:25:26.215_136+00:00 [48063] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:25:26.215_145+00:00 [48063] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:25:26.215_155+00:00 [48063] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:25:36.813_411+00:00 [48035] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:25:36.813_435+00:00 [48035] [INFO] session 1 got connection from 127.0.0.1:42094 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:25:36.813_545+00:00 [48035] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:25:36.813_571+00:00 [48035] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:25:36.813_637+00:00 [48035] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:25:36.813_672+00:00 [48035] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:25:36.813_675+00:00 [48035] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:25:36.813_677+00:00 [48035] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:25:36.813_685+00:00 [48035] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:25:36.814_467+00:00 [48035] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42094 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:25:37.314_843+00:00 [48035] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:25:37.314_860+00:00 [48035] [INFO] session 2 got connection from 127.0.0.1:42096 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:25:37.314_973+00:00 [48035] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:25:37.314_977+00:00 [48035] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:25:37.315_150+00:00 [48035] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:25:37.315_155+00:00 [48035] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:25:37.315_223+00:00 [48063] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:25:37.315_226+00:00 [48063] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:25:37.315_235+00:00 [48063] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:25:37.315_237+00:00 [48063] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:25:37.315_244+00:00 [48063] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:25:37.315_258+00:00 [48063] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:25:37.315_262+00:00 [48063] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:25:37.315_283+00:00 [48063] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:25:56.311_875+00:00 [48052] [INFO] 0x7ff3b8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:25:56.312_006+00:00 [48052] [INFO] 0x7ff3ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:26:41.385_160+00:00 [48683] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:26:41.386_510+00:00 [48683] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:26:41.386_543+00:00 [48683] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:26:41.386_548+00:00 [48683] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:26:41.386_577+00:00 [48683] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:26:41.386_583+00:00 [48683] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:26:41.386_587+00:00 [48683] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:26:41.386_632+00:00 [48683] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:26:41.386_813+00:00 [48720] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:26:42.622_835+00:00 [48691] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:26:42.622_846+00:00 [48691] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:26:42.622_862+00:00 [48691] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:26:42.622_880+00:00 [48691] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:26:42.622_888+00:00 [48691] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:26:42.622_892+00:00 [48691] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:26:42.622_910+00:00 [48691] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:26:42.622_963+00:00 [48719] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:26:42.622_970+00:00 [48719] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:26:42.622_980+00:00 [48719] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:26:53.449_741+00:00 [48691] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:26:53.449_761+00:00 [48691] [INFO] session 1 got connection from 127.0.0.1:42098 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:26:53.449_861+00:00 [48691] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:26:53.449_887+00:00 [48691] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:26:53.449_947+00:00 [48691] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:26:53.449_983+00:00 [48691] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:26:53.449_986+00:00 [48691] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:26:53.449_988+00:00 [48691] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:26:53.449_996+00:00 [48691] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:26:53.450_742+00:00 [48691] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42098 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:26:53.951_058+00:00 [48691] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:26:53.951_087+00:00 [48691] [INFO] session 2 got connection from 127.0.0.1:42100 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:26:53.951_209+00:00 [48691] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:26:53.951_214+00:00 [48691] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:26:53.951_411+00:00 [48691] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:26:53.951_416+00:00 [48691] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:26:53.951_488+00:00 [48719] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:26:53.951_491+00:00 [48719] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:26:53.951_500+00:00 [48719] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:26:53.951_502+00:00 [48719] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:26:53.951_509+00:00 [48719] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:26:53.951_523+00:00 [48719] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:26:53.951_528+00:00 [48719] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:26:53.951_547+00:00 [48719] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:27:12.691_879+00:00 [48711] [INFO] 0x7f1068001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:27:12.692_010+00:00 [48711] [INFO] 0x7f106c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:27:12.692_109+00:00 [48711] [INFO] 0x7f10600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:27:12.692_269+00:00 [48711] [INFO] 0x7f10540014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:27:26.662_027+00:00 [48719] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:27:26.662_040+00:00 [48719] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:27:26.662_067+00:00 [48719] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:27:26.662_073+00:00 [48719] [INFO] create snapshot idx 100000 log_term 1 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:27:57.764_703+00:00 [49308] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:27:57.766_049+00:00 [49308] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:27:57.766_089+00:00 [49308] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:27:57.766_094+00:00 [49308] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:27:57.766_118+00:00 [49308] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:27:57.766_122+00:00 [49308] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:27:57.766_125+00:00 [49308] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:27:57.766_156+00:00 [49308] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:27:57.766_311+00:00 [49345] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:27:59.593_435+00:00 [49316] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:27:59.593_448+00:00 [49316] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:27:59.593_464+00:00 [49316] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:27:59.593_476+00:00 [49316] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:27:59.593_483+00:00 [49316] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:27:59.593_487+00:00 [49316] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:27:59.593_506+00:00 [49316] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:27:59.593_566+00:00 [49344] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:27:59.593_575+00:00 [49344] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:27:59.593_585+00:00 [49344] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:28:09.825_188+00:00 [49316] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:28:09.825_206+00:00 [49316] [INFO] session 1 got connection from 127.0.0.1:42102 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:28:09.825_303+00:00 [49316] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:28:09.825_329+00:00 [49316] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:28:09.825_390+00:00 [49316] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:28:09.825_425+00:00 [49316] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:28:09.825_428+00:00 [49316] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:28:09.825_430+00:00 [49316] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:28:09.825_438+00:00 [49316] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:28:09.826_106+00:00 [49316] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42102 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:28:10.326_427+00:00 [49316] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:28:10.326_443+00:00 [49316] [INFO] session 2 got connection from 127.0.0.1:42106 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:28:10.326_559+00:00 [49316] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:28:10.326_565+00:00 [49316] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:28:10.326_789+00:00 [49316] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:28:10.326_795+00:00 [49316] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:28:10.326_874+00:00 [49344] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:28:10.326_878+00:00 [49344] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:28:10.326_886+00:00 [49344] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:28:10.326_888+00:00 [49344] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:28:10.326_895+00:00 [49344] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:28:10.326_909+00:00 [49344] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:28:10.326_914+00:00 [49344] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:28:10.326_935+00:00 [49344] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:28:29.821_877+00:00 [49335] [INFO] 0x7fb854001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:29.822_007+00:00 [49335] [INFO] 0x7fb84c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:29.822_110+00:00 [49335] [INFO] 0x7fb8500014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:29.822_203+00:00 [49335] [INFO] 0x7fb8440014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:29.822_491+00:00 [49335] [INFO] 0x7fb8380014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:29.822_651+00:00 [49335] [INFO] 0x7fb8300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:33.643_972+00:00 [49327] [INFO] 0x7fb8380189c0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:28:41.929_612+00:00 [49344] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:28:41.929_622+00:00 [49344] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:28:41.929_763+00:00 [49344] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:28:41.929_768+00:00 [49344] [INFO] create snapshot idx 100000 log_term 1 done: 141 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:29:14.896_051+00:00 [49845] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:29:14.897_408+00:00 [49845] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:29:14.897_440+00:00 [49845] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:29:14.897_445+00:00 [49845] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:29:14.897_469+00:00 [49845] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:29:14.897_473+00:00 [49845] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:29:14.897_476+00:00 [49845] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:29:14.897_508+00:00 [49845] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:29:14.897_661+00:00 [49882] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:29:16.029_725+00:00 [49853] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:29:16.029_737+00:00 [49853] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:29:16.029_753+00:00 [49853] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:29:16.029_764+00:00 [49853] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:29:16.029_770+00:00 [49853] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:29:16.029_774+00:00 [49853] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:29:16.029_792+00:00 [49853] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:29:16.029_845+00:00 [49881] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:29:16.029_854+00:00 [49881] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:29:16.029_864+00:00 [49881] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:29:26.707_389+00:00 [49853] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:29:26.707_413+00:00 [49853] [INFO] session 1 got connection from 127.0.0.1:42108 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:29:26.707_526+00:00 [49853] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:29:26.707_553+00:00 [49853] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:29:26.707_620+00:00 [49853] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:29:26.707_656+00:00 [49853] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:29:26.707_660+00:00 [49853] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:29:26.707_662+00:00 [49853] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:29:26.707_671+00:00 [49853] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:29:26.708_433+00:00 [49853] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42108 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:29:27.209_002+00:00 [49853] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:29:27.209_019+00:00 [49853] [INFO] session 2 got connection from 127.0.0.1:42110 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:29:27.209_139+00:00 [49853] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:29:27.209_143+00:00 [49853] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:29:27.209_321+00:00 [49853] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:29:27.209_327+00:00 [49853] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:29:27.209_402+00:00 [49881] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:29:27.209_405+00:00 [49881] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:29:27.209_413+00:00 [49881] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:29:27.209_416+00:00 [49881] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:29:27.209_423+00:00 [49881] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:29:27.209_437+00:00 [49881] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:29:27.209_442+00:00 [49881] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:29:27.209_464+00:00 [49881] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:30:48.929_780+00:00 [50540] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:30:48.931_173+00:00 [50540] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:30:48.931_205+00:00 [50540] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:30:48.931_209+00:00 [50540] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:30:48.931_234+00:00 [50540] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:30:48.931_238+00:00 [50540] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:30:48.931_240+00:00 [50540] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:30:48.931_271+00:00 [50540] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:30:48.931_422+00:00 [50577] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:30:50.937_465+00:00 [50548] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:30:50.937_476+00:00 [50548] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:30:50.937_490+00:00 [50548] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:30:50.937_500+00:00 [50548] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:30:50.937_506+00:00 [50548] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:30:50.937_510+00:00 [50548] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:30:50.937_528+00:00 [50548] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:30:50.937_579+00:00 [50576] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:30:50.937_586+00:00 [50576] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:30:50.937_597+00:00 [50576] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:31:00.735_583+00:00 [50548] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:31:00.735_597+00:00 [50548] [INFO] session 1 got connection from 127.0.0.1:42112 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:31:00.735_684+00:00 [50548] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:31:00.735_706+00:00 [50548] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:31:00.735_760+00:00 [50548] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:31:00.735_788+00:00 [50548] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:31:00.735_791+00:00 [50548] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:31:00.735_792+00:00 [50548] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:31:00.735_799+00:00 [50548] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:31:00.736_451+00:00 [50548] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42112 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:31:01.236_728+00:00 [50548] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:31:01.236_744+00:00 [50548] [INFO] session 2 got connection from 127.0.0.1:42114 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:31:01.236_853+00:00 [50548] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:31:01.236_857+00:00 [50548] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:31:01.237_006+00:00 [50548] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:31:01.237_010+00:00 [50548] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:31:01.237_079+00:00 [50576] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:31:01.237_082+00:00 [50576] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:31:01.237_091+00:00 [50576] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:31:01.237_093+00:00 [50576] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:31:01.237_100+00:00 [50576] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:31:01.237_113+00:00 [50576] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:31:01.237_118+00:00 [50576] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:31:01.237_137+00:00 [50576] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:31:20.986_906+00:00 [50567] [INFO] 0x7fbd68001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:31:20.987_036+00:00 [50567] [INFO] 0x7fbd600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:32:06.054_591+00:00 [50923] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:32:06.055_960+00:00 [50923] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:32:06.056_000+00:00 [50923] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:32:06.056_004+00:00 [50923] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:32:06.056_028+00:00 [50923] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:32:06.056_032+00:00 [50923] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:32:06.056_035+00:00 [50923] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:32:06.056_062+00:00 [50923] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:32:06.056_216+00:00 [50960] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:32:07.439_292+00:00 [50931] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:32:07.439_304+00:00 [50931] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:32:07.439_320+00:00 [50931] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:32:07.439_332+00:00 [50931] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:32:07.439_339+00:00 [50931] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:32:07.439_342+00:00 [50931] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:32:07.439_366+00:00 [50931] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:32:07.439_419+00:00 [50959] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:32:07.439_427+00:00 [50959] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:32:07.439_437+00:00 [50959] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:32:17.865_706+00:00 [50931] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:32:17.865_730+00:00 [50931] [INFO] session 1 got connection from 127.0.0.1:42116 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:32:17.865_838+00:00 [50931] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:32:17.865_863+00:00 [50931] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:32:17.865_924+00:00 [50931] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:32:17.865_959+00:00 [50931] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:32:17.865_962+00:00 [50931] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:32:17.865_964+00:00 [50931] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:32:17.865_972+00:00 [50931] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:32:17.866_691+00:00 [50931] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42116 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:32:18.367_117+00:00 [50931] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:32:18.367_132+00:00 [50931] [INFO] session 2 got connection from 127.0.0.1:42118 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:32:18.367_240+00:00 [50931] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:32:18.367_243+00:00 [50931] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:32:18.367_410+00:00 [50931] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:32:18.367_414+00:00 [50931] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:32:18.367_482+00:00 [50959] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:32:18.367_485+00:00 [50959] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:32:18.367_494+00:00 [50959] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:32:18.367_496+00:00 [50959] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:32:18.367_504+00:00 [50959] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:32:18.367_517+00:00 [50959] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:32:18.367_522+00:00 [50959] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:32:18.367_541+00:00 [50959] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:32:37.611_666+00:00 [50950] [INFO] 0x7f8f00001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:32:37.611_799+00:00 [50950] [INFO] 0x7f8ef40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:32:37.611_899+00:00 [50950] [INFO] 0x7f8eec0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:32:37.612_056+00:00 [50950] [INFO] 0x7f8ee00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:32:51.443_782+00:00 [50959] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:32:51.443_795+00:00 [50959] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:32:51.443_822+00:00 [50959] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:32:51.443_828+00:00 [50959] [INFO] create snapshot idx 100000 log_term 1 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:33:22.676_293+00:00 [51287] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:33:22.677_647+00:00 [51287] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:33:22.677_684+00:00 [51287] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:33:22.677_690+00:00 [51287] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:33:22.677_714+00:00 [51287] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:33:22.677_719+00:00 [51287] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:33:22.677_722+00:00 [51287] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:33:22.677_750+00:00 [51287] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:33:22.677_897+00:00 [51324] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:33:23.872_979+00:00 [51295] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:33:23.872_991+00:00 [51295] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:33:23.873_006+00:00 [51295] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:33:23.873_017+00:00 [51295] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:33:23.873_024+00:00 [51295] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:33:23.873_028+00:00 [51295] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:33:23.873_046+00:00 [51295] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:33:23.873_097+00:00 [51323] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:33:23.873_105+00:00 [51323] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:33:23.873_116+00:00 [51323] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:33:34.488_319+00:00 [51295] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:33:34.488_340+00:00 [51295] [INFO] session 1 got connection from 127.0.0.1:42120 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:33:34.488_431+00:00 [51295] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:33:34.488_453+00:00 [51295] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:33:34.488_506+00:00 [51295] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:33:34.488_536+00:00 [51295] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:33:34.488_538+00:00 [51295] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:33:34.488_540+00:00 [51295] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:33:34.488_547+00:00 [51295] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:33:34.489_235+00:00 [51295] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42120 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:33:34.989_665+00:00 [51295] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:33:34.989_681+00:00 [51295] [INFO] session 2 got connection from 127.0.0.1:42122 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:33:34.989_787+00:00 [51295] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:33:34.989_791+00:00 [51295] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:33:34.989_957+00:00 [51295] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:33:34.989_962+00:00 [51295] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:33:34.990_032+00:00 [51323] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:33:34.990_036+00:00 [51323] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:33:34.990_045+00:00 [51323] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:33:34.990_047+00:00 [51323] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:33:34.990_054+00:00 [51323] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:33:34.990_068+00:00 [51323] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:33:34.990_072+00:00 [51323] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:33:34.990_093+00:00 [51323] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:33:53.983_330+00:00 [51313] [INFO] 0x7f7bbc001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:53.983_460+00:00 [51313] [INFO] 0x7f7bb40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:53.983_558+00:00 [51313] [INFO] 0x7f7bb80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:53.983_654+00:00 [51313] [INFO] 0x7f7bac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:53.983_992+00:00 [51310] [INFO] 0x7f7b980014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:53.984_152+00:00 [51310] [INFO] 0x7f7b840014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:33:56.277_597+00:00 [51316] [INFO] 0x7f7bbc0195b0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:34:06.224_212+00:00 [51323] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:34:06.224_225+00:00 [51323] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:34:06.224_250+00:00 [51323] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:34:06.224_256+00:00 [51323] [INFO] create snapshot idx 100000 log_term 1 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:34:39.058_811+00:00 [51645] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:34:39.060_172+00:00 [51645] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:34:39.060_208+00:00 [51645] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:34:39.060_214+00:00 [51645] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:34:39.060_240+00:00 [51645] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:34:39.060_244+00:00 [51645] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:34:39.060_247+00:00 [51645] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:34:39.060_288+00:00 [51645] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:34:39.060_435+00:00 [51682] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:34:40.773_616+00:00 [51653] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:34:40.773_630+00:00 [51653] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:34:40.773_644+00:00 [51653] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:34:40.773_654+00:00 [51653] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:34:40.773_661+00:00 [51653] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:34:40.773_664+00:00 [51653] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:34:40.773_683+00:00 [51653] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:34:40.773_735+00:00 [51681] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:34:40.773_743+00:00 [51681] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:34:40.773_752+00:00 [51681] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:34:51.369_438+00:00 [51653] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:34:51.369_462+00:00 [51653] [INFO] session 1 got connection from 127.0.0.1:42124 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:34:51.369_576+00:00 [51653] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:34:51.369_603+00:00 [51653] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:34:51.369_665+00:00 [51653] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:34:51.369_699+00:00 [51653] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:34:51.369_701+00:00 [51653] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:34:51.369_703+00:00 [51653] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:34:51.369_713+00:00 [51653] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:34:51.370_460+00:00 [51653] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42124 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:34:51.870_913+00:00 [51653] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:34:51.870_929+00:00 [51653] [INFO] session 2 got connection from 127.0.0.1:42126 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:34:51.871_040+00:00 [51653] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:34:51.871_045+00:00 [51653] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:34:51.871_217+00:00 [51653] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:34:51.871_222+00:00 [51653] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:34:51.871_291+00:00 [51681] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:34:51.871_295+00:00 [51681] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:34:51.871_303+00:00 [51681] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:34:51.871_305+00:00 [51681] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:34:51.871_313+00:00 [51681] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:34:51.871_327+00:00 [51681] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:34:51.871_332+00:00 [51681] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:34:51.871_353+00:00 [51681] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:35:10.866_240+00:00 [51672] [INFO] 0x7f0b70001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.866_371+00:00 [51672] [INFO] 0x7f0b680014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.866_468+00:00 [51672] [INFO] 0x7f0b6c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.866_563+00:00 [51672] [INFO] 0x7f0b600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.866_658+00:00 [51672] [INFO] 0x7f0b640014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.866_908+00:00 [51672] [INFO] 0x7f0b580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.867_070+00:00 [51672] [INFO] 0x7f0b380014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:10.867_219+00:00 [51672] [INFO] 0x7f0b300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:12.215_698+00:00 [51659] [INFO] 0x7f0b60016930 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:35:22.712_653+00:00 [51681] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:35:22.712_660+00:00 [51681] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:35:22.712_676+00:00 [51681] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:35:22.712_680+00:00 [51681] [INFO] create snapshot idx 100000 log_term 1 done: 15 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:35:55.946_764+00:00 [52068] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:35:55.948_185+00:00 [52068] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:35:55.948_222+00:00 [52068] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:35:55.948_228+00:00 [52068] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:35:55.948_258+00:00 [52068] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:35:55.948_263+00:00 [52068] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:35:55.948_266+00:00 [52068] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:35:55.948_300+00:00 [52068] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:35:55.948_477+00:00 [52105] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:35:57.617_535+00:00 [52076] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:35:57.617_548+00:00 [52076] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:35:57.617_564+00:00 [52076] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:35:57.617_585+00:00 [52076] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:35:57.617_592+00:00 [52076] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:35:57.617_596+00:00 [52076] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:35:57.617_615+00:00 [52076] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:35:57.617_673+00:00 [52104] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:35:57.617_682+00:00 [52104] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:35:57.617_692+00:00 [52104] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:36:07.757_667+00:00 [52076] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:36:07.757_691+00:00 [52076] [INFO] session 1 got connection from 127.0.0.1:42128 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:36:07.757_802+00:00 [52076] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:36:07.757_828+00:00 [52076] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:36:07.757_891+00:00 [52076] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:36:07.757_926+00:00 [52076] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:36:07.757_929+00:00 [52076] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:36:07.757_931+00:00 [52076] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:36:07.757_940+00:00 [52076] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:36:07.758_657+00:00 [52076] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42128 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:36:08.259_141+00:00 [52076] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:36:08.259_157+00:00 [52076] [INFO] session 2 got connection from 127.0.0.1:42130 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:36:08.259_267+00:00 [52076] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:36:08.259_271+00:00 [52076] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:36:08.259_444+00:00 [52076] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:36:08.259_448+00:00 [52076] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:36:08.259_520+00:00 [52104] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:36:08.259_523+00:00 [52104] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:36:08.259_532+00:00 [52104] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:36:08.259_534+00:00 [52104] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:36:08.259_541+00:00 [52104] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:36:08.259_555+00:00 [52104] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:36:08.259_560+00:00 [52104] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:36:08.259_580+00:00 [52104] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:36:27.755_065+00:00 [52095] [INFO] 0x7fe538001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_196+00:00 [52095] [INFO] 0x7fe5300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_294+00:00 [52095] [INFO] 0x7fe5280014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_390+00:00 [52095] [INFO] 0x7fe52c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_480+00:00 [52095] [INFO] 0x7fe5200014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_711+00:00 [52095] [INFO] 0x7fe5240014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_811+00:00 [52095] [INFO] 0x7fe5180014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.755_894+00:00 [52095] [INFO] 0x7fe51c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.756_063+00:00 [52072] [INFO] 0x7fe4f80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:27.756_219+00:00 [52072] [INFO] 0x7fe4f00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:36:38.515_738+00:00 [52104] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:36:38.515_748+00:00 [52104] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:36:38.515_771+00:00 [52104] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:36:38.515_777+00:00 [52104] [INFO] create snapshot idx 100000 log_term 1 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:37:12.838_371+00:00 [52492] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:37:12.839_760+00:00 [52492] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:37:12.839_791+00:00 [52492] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:37:12.839_795+00:00 [52492] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:37:12.839_818+00:00 [52492] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:37:12.839_822+00:00 [52492] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:37:12.839_825+00:00 [52492] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:37:12.839_858+00:00 [52492] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:37:12.840_003+00:00 [52529] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:37:13.913_102+00:00 [52500] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:37:13.913_113+00:00 [52500] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:37:13.913_127+00:00 [52500] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:37:13.913_137+00:00 [52500] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:37:13.913_144+00:00 [52500] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:37:13.913_148+00:00 [52500] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:37:13.913_167+00:00 [52500] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:37:13.913_218+00:00 [52528] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:37:13.913_226+00:00 [52528] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:37:13.913_235+00:00 [52528] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:37:24.898_782+00:00 [52500] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:37:24.898_802+00:00 [52500] [INFO] session 1 got connection from 127.0.0.1:42134 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:37:24.898_906+00:00 [52500] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:37:24.898_931+00:00 [52500] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:37:24.898_996+00:00 [52500] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:37:24.899_030+00:00 [52500] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:37:24.899_033+00:00 [52500] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:37:24.899_035+00:00 [52500] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:37:24.899_044+00:00 [52500] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:37:24.899_792+00:00 [52500] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42134 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:37:25.400_046+00:00 [52500] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:37:25.400_067+00:00 [52500] [INFO] session 2 got connection from 127.0.0.1:42138 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:37:25.400_195+00:00 [52500] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:37:25.400_218+00:00 [52500] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:37:25.400_372+00:00 [52500] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:37:25.400_377+00:00 [52500] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:37:25.400_443+00:00 [52528] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:37:25.400_447+00:00 [52528] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:37:25.400_455+00:00 [52528] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:37:25.400_457+00:00 [52528] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:37:25.400_464+00:00 [52528] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:37:25.400_478+00:00 [52528] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:37:25.400_483+00:00 [52528] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:37:25.400_502+00:00 [52528] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:37:44.145_639+00:00 [52520] [INFO] 0x7f1778001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.145_778+00:00 [52520] [INFO] 0x7f17700014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.145_880+00:00 [52520] [INFO] 0x7f17740014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.145_978+00:00 [52520] [INFO] 0x7f17680014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_066+00:00 [52520] [INFO] 0x7f176c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_156+00:00 [52520] [INFO] 0x7f17600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_376+00:00 [52520] [INFO] 0x7f17640014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_468+00:00 [52520] [INFO] 0x7f17580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_558+00:00 [52520] [INFO] 0x7f175c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:44.146_642+00:00 [52520] [INFO] 0x7f17500014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:37:54.872_635+00:00 [52528] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:37:54.873_328+00:00 [52528] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:37:54.873_354+00:00 [52528] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:37:54.873_360+00:00 [52528] [INFO] create snapshot idx 100000 log_term 1 done: 24 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:38:29.226_354+00:00 [52936] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:38:29.227_752+00:00 [52936] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:38:29.227_784+00:00 [52936] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:38:29.227_790+00:00 [52936] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:38:29.227_814+00:00 [52936] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:38:29.227_818+00:00 [52936] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:38:29.227_821+00:00 [52936] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:38:29.227_849+00:00 [52936] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:38:29.228_002+00:00 [52973] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:38:31.252_055+00:00 [52944] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:38:31.252_066+00:00 [52944] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:38:31.252_081+00:00 [52944] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:38:31.252_097+00:00 [52944] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:38:31.252_103+00:00 [52944] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:38:31.252_107+00:00 [52944] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:38:31.252_125+00:00 [52944] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:38:31.252_175+00:00 [52972] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:38:31.252_184+00:00 [52972] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:38:31.252_195+00:00 [52972] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:38:40.786_311+00:00 [52944] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:38:40.786_343+00:00 [52944] [INFO] session 1 got connection from 127.0.0.1:42140 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:38:40.786_448+00:00 [52944] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:38:40.786_475+00:00 [52944] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:38:40.786_535+00:00 [52944] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:38:40.786_569+00:00 [52944] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:38:40.786_572+00:00 [52944] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:38:40.786_574+00:00 [52944] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:38:40.786_584+00:00 [52944] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:38:40.787_309+00:00 [52944] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42140 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:38:41.287_630+00:00 [52944] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:38:41.287_645+00:00 [52944] [INFO] session 2 got connection from 127.0.0.1:42142 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:38:41.287_768+00:00 [52944] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:38:41.287_773+00:00 [52944] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:38:41.287_980+00:00 [52944] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:38:41.287_986+00:00 [52944] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:38:41.288_075+00:00 [52972] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:38:41.288_079+00:00 [52972] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:38:41.288_088+00:00 [52972] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:38:41.288_090+00:00 [52972] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:38:41.288_097+00:00 [52972] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:38:41.288_111+00:00 [52972] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:38:41.288_116+00:00 [52972] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:38:41.288_137+00:00 [52972] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:39:01.284_509+00:00 [52963] [INFO] 0x7f0854001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.284_640+00:00 [52963] [INFO] 0x7f084c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.284_753+00:00 [52961] [INFO] 0x7f08440014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.284_856+00:00 [52961] [INFO] 0x7f08480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.284_947+00:00 [52961] [INFO] 0x7f083c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.285_034+00:00 [52961] [INFO] 0x7f08400014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.285_122+00:00 [52961] [INFO] 0x7f08340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.285_207+00:00 [52961] [INFO] 0x7f08380014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.285_297+00:00 [52960] [INFO] 0x7f082c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:01.285_384+00:00 [52960] [INFO] 0x7f08300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:39:12.150_725+00:00 [52972] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:39:12.150_733+00:00 [52972] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:39:12.150_753+00:00 [52972] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:39:12.150_756+00:00 [52972] [INFO] create snapshot idx 100000 log_term 1 done: 18 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:39:46.366_017+00:00 [53371] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:39:46.367_410+00:00 [53371] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:39:46.367_441+00:00 [53371] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:39:46.367_447+00:00 [53371] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:39:46.367_471+00:00 [53371] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:39:46.367_475+00:00 [53371] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:39:46.367_478+00:00 [53371] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:39:46.367_505+00:00 [53371] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:39:46.367_649+00:00 [53408] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:39:47.713_720+00:00 [53379] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:39:47.713_731+00:00 [53379] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:39:47.713_746+00:00 [53379] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:39:47.713_761+00:00 [53379] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:39:47.713_767+00:00 [53379] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:39:47.713_771+00:00 [53379] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:39:47.713_789+00:00 [53379] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:39:47.713_841+00:00 [53407] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:39:47.713_848+00:00 [53407] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:39:47.713_858+00:00 [53407] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:39:57.926_522+00:00 [53379] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:39:57.926_545+00:00 [53379] [INFO] session 1 got connection from 127.0.0.1:42144 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:39:57.926_654+00:00 [53379] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:39:57.926_704+00:00 [53379] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:39:57.926_773+00:00 [53379] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:39:57.926_807+00:00 [53379] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:39:57.926_810+00:00 [53379] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:39:57.926_812+00:00 [53379] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:39:57.926_821+00:00 [53379] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:39:57.927_672+00:00 [53379] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42144 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:39:58.427_927+00:00 [53379] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:39:58.427_941+00:00 [53379] [INFO] session 2 got connection from 127.0.0.1:42146 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:39:58.428_042+00:00 [53379] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:39:58.428_046+00:00 [53379] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:39:58.428_183+00:00 [53379] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:39:58.428_187+00:00 [53379] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:39:58.428_254+00:00 [53407] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:39:58.428_258+00:00 [53407] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:39:58.428_266+00:00 [53407] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:39:58.428_268+00:00 [53407] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:39:58.428_275+00:00 [53407] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:39:58.428_288+00:00 [53407] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:39:58.428_293+00:00 [53407] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:39:58.428_312+00:00 [53407] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:40:17.924_304+00:00 [53398] [INFO] 0x7fa3b4001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.924_435+00:00 [53398] [INFO] 0x7fa3ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.924_538+00:00 [53398] [INFO] 0x7fa3b00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.924_632+00:00 [53398] [INFO] 0x7fa3a40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.924_718+00:00 [53398] [INFO] 0x7fa3a80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.924_812+00:00 [53398] [INFO] 0x7fa39c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.925_011+00:00 [53398] [INFO] 0x7fa3a00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.925_103+00:00 [53398] [INFO] 0x7fa3940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.925_190+00:00 [53398] [INFO] 0x7fa3980014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:17.925_279+00:00 [53398] [INFO] 0x7fa38c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:40:29.221_671+00:00 [53407] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:40:29.221_678+00:00 [53407] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:40:29.221_695+00:00 [53407] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:40:29.221_699+00:00 [53407] [INFO] create snapshot idx 100000 log_term 1 done: 17 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:41:03.005_800+00:00 [53812] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:41:03.007_201+00:00 [53812] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:41:03.007_234+00:00 [53812] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:41:03.007_240+00:00 [53812] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:41:03.007_264+00:00 [53812] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:41:03.007_268+00:00 [53812] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:41:03.007_271+00:00 [53812] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:41:03.007_300+00:00 [53812] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:41:03.007_448+00:00 [53849] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:41:04.305_494+00:00 [53820] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:41:04.305_506+00:00 [53820] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:41:04.305_522+00:00 [53820] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:41:04.305_538+00:00 [53820] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:41:04.305_544+00:00 [53820] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:41:04.305_548+00:00 [53820] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:41:04.305_566+00:00 [53820] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:41:04.305_620+00:00 [53848] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:41:04.305_628+00:00 [53848] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:41:04.305_638+00:00 [53848] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:41:15.067_703+00:00 [53820] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:41:15.067_729+00:00 [53820] [INFO] session 1 got connection from 127.0.0.1:42148 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:41:15.067_854+00:00 [53820] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:41:15.067_886+00:00 [53820] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:41:15.067_952+00:00 [53820] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:41:15.067_986+00:00 [53820] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:41:15.067_989+00:00 [53820] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:41:15.067_991+00:00 [53820] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:41:15.067_999+00:00 [53820] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:41:15.068_727+00:00 [53820] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42148 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:41:15.568_965+00:00 [53820] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:41:15.568_984+00:00 [53820] [INFO] session 2 got connection from 127.0.0.1:42150 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:41:15.569_105+00:00 [53820] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:41:15.569_110+00:00 [53820] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:41:15.569_275+00:00 [53820] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:41:15.569_279+00:00 [53820] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:41:15.569_350+00:00 [53848] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:41:15.569_353+00:00 [53848] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:41:15.569_362+00:00 [53848] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:41:15.569_364+00:00 [53848] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:41:15.569_371+00:00 [53848] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:41:15.569_384+00:00 [53848] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:41:15.569_390+00:00 [53848] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:41:15.569_409+00:00 [53848] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:41:34.313_581+00:00 [53839] [INFO] 0x7f89ec001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.313_711+00:00 [53839] [INFO] 0x7f89e40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.313_802+00:00 [53839] [INFO] 0x7f89e80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.313_895+00:00 [53839] [INFO] 0x7f89dc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.314_146+00:00 [53836] [INFO] 0x7f89e00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.314_242+00:00 [53836] [INFO] 0x7f89d40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.314_462+00:00 [53836] [INFO] 0x7f89d80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.314_676+00:00 [53834] [INFO] 0x7f89cc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.315_253+00:00 [53834] [INFO] 0x7f89d00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:34.315_365+00:00 [53834] [INFO] 0x7f89c40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:41:45.850_344+00:00 [53848] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:41:45.850_353+00:00 [53848] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:41:45.850_452+00:00 [53848] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:41:45.850_457+00:00 [53848] [INFO] create snapshot idx 100000 log_term 1 done: 98 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:42:19.389_813+00:00 [54256] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:42:19.391_172+00:00 [54256] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:42:19.391_204+00:00 [54256] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:42:19.391_210+00:00 [54256] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:42:19.391_234+00:00 [54256] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:42:19.391_238+00:00 [54256] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:42:19.391_241+00:00 [54256] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:42:19.391_271+00:00 [54256] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:42:19.391_417+00:00 [54293] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:42:21.165_478+00:00 [54264] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:42:21.165_489+00:00 [54264] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:42:21.165_505+00:00 [54264] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:42:21.165_515+00:00 [54264] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:42:21.165_521+00:00 [54264] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:42:21.165_524+00:00 [54264] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:42:21.165_542+00:00 [54264] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:42:21.165_594+00:00 [54292] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:42:21.165_602+00:00 [54292] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:42:21.165_611+00:00 [54292] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:42:30.950_462+00:00 [54264] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:42:30.950_510+00:00 [54264] [INFO] session 1 got connection from 127.0.0.1:42152 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:42:30.950_727+00:00 [54264] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:42:30.950_752+00:00 [54264] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:42:30.950_813+00:00 [54264] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:42:30.950_848+00:00 [54264] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:42:30.950_850+00:00 [54264] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:42:30.950_852+00:00 [54264] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:42:30.950_860+00:00 [54264] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:42:30.951_570+00:00 [54264] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42152 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:42:31.451_817+00:00 [54264] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:42:31.451_830+00:00 [54264] [INFO] session 2 got connection from 127.0.0.1:42154 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:42:31.451_923+00:00 [54264] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:42:31.451_927+00:00 [54264] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:42:31.452_082+00:00 [54264] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:42:31.452_086+00:00 [54264] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:42:31.452_155+00:00 [54292] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:42:31.452_158+00:00 [54292] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:42:31.452_166+00:00 [54292] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:42:31.452_168+00:00 [54292] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:42:31.452_175+00:00 [54292] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:42:31.452_189+00:00 [54292] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:42:31.452_194+00:00 [54292] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:42:31.452_213+00:00 [54292] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:42:51.197_452+00:00 [54283] [INFO] 0x7ff2c8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.197_582+00:00 [54283] [INFO] 0x7ff2c00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.197_675+00:00 [54283] [INFO] 0x7ff2c40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.197_887+00:00 [54283] [INFO] 0x7ff2b80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.197_984+00:00 [54283] [INFO] 0x7ff2bc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.198_066+00:00 [54283] [INFO] 0x7ff2b00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.198_147+00:00 [54283] [INFO] 0x7ff2b40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.198_234+00:00 [54283] [INFO] 0x7ff2a80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.198_312+00:00 [54283] [INFO] 0x7ff2ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:42:51.198_388+00:00 [54283] [INFO] 0x7ff2a00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:43:03.204_209+00:00 [54292] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:43:03.204_216+00:00 [54292] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:43:03.204_233+00:00 [54292] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:43:03.204_236+00:00 [54292] [INFO] create snapshot idx 100000 log_term 1 done: 16 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:45:31.865_877+00:00 [55151] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:45:31.867_260+00:00 [55151] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:45:31.867_293+00:00 [55151] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:45:31.867_297+00:00 [55151] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:45:31.867_321+00:00 [55151] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:45:31.867_325+00:00 [55151] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:45:31.867_328+00:00 [55151] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:45:31.867_361+00:00 [55151] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:45:31.867_501+00:00 [55188] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:45:33.439_515+00:00 [55159] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:45:33.439_524+00:00 [55159] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:45:33.439_539+00:00 [55159] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:45:33.439_549+00:00 [55159] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:45:33.439_555+00:00 [55159] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:45:33.439_558+00:00 [55159] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:45:33.439_577+00:00 [55159] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:45:33.439_622+00:00 [55187] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:45:33.439_630+00:00 [55187] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:45:33.439_640+00:00 [55187] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:45:44.171_403+00:00 [55159] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:45:44.171_423+00:00 [55159] [INFO] session 1 got connection from 127.0.0.1:42156 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:45:44.171_525+00:00 [55159] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:45:44.171_550+00:00 [55159] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:45:44.171_610+00:00 [55159] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:45:44.171_642+00:00 [55159] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:45:44.171_646+00:00 [55159] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:45:44.171_648+00:00 [55159] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:45:44.171_656+00:00 [55159] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:45:44.172_299+00:00 [55159] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42156 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:45:44.672_747+00:00 [55159] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:45:44.672_764+00:00 [55159] [INFO] session 2 got connection from 127.0.0.1:42158 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:45:44.672_870+00:00 [55159] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:45:44.672_874+00:00 [55159] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:45:44.673_039+00:00 [55159] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:45:44.673_043+00:00 [55159] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:45:44.673_112+00:00 [55187] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:45:44.673_115+00:00 [55187] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:45:44.673_124+00:00 [55187] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:45:44.673_126+00:00 [55187] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:45:44.673_133+00:00 [55187] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:45:44.673_146+00:00 [55187] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:45:44.673_151+00:00 [55187] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:45:44.673_171+00:00 [55187] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:46:03.672_668+00:00 [55179] [INFO] 0x7fb9a8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:46:03.672_805+00:00 [55179] [INFO] 0x7fb9a00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:46:48.739_364+00:00 [55549] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:46:48.740_702+00:00 [55549] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:46:48.740_731+00:00 [55549] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:46:48.740_737+00:00 [55549] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:46:48.740_760+00:00 [55549] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:46:48.740_764+00:00 [55549] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:46:48.740_767+00:00 [55549] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:46:48.740_799+00:00 [55549] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:46:48.740_942+00:00 [55586] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:46:50.082_003+00:00 [55557] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:46:50.082_013+00:00 [55557] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:46:50.082_028+00:00 [55557] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:46:50.082_038+00:00 [55557] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:46:50.082_044+00:00 [55557] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:46:50.082_048+00:00 [55557] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:46:50.082_066+00:00 [55557] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:46:50.082_119+00:00 [55585] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:46:50.082_126+00:00 [55585] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:46:50.082_136+00:00 [55585] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:47:00.304_027+00:00 [55557] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:47:00.304_049+00:00 [55557] [INFO] session 1 got connection from 127.0.0.1:42160 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:47:00.304_150+00:00 [55557] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:47:00.304_175+00:00 [55557] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:47:00.304_238+00:00 [55557] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:47:00.304_272+00:00 [55557] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:47:00.304_274+00:00 [55557] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:47:00.304_276+00:00 [55557] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:47:00.304_284+00:00 [55557] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:47:00.305_143+00:00 [55557] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42160 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:47:00.805_589+00:00 [55557] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:47:00.805_604+00:00 [55557] [INFO] session 2 got connection from 127.0.0.1:42162 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:47:00.805_708+00:00 [55557] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:47:00.805_711+00:00 [55557] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:47:00.805_858+00:00 [55557] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:47:00.805_862+00:00 [55557] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:47:00.805_930+00:00 [55585] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:47:00.805_934+00:00 [55585] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:47:00.805_942+00:00 [55585] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:47:00.805_944+00:00 [55585] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:47:00.805_952+00:00 [55585] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:47:00.805_965+00:00 [55585] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:47:00.805_970+00:00 [55585] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:47:00.805_990+00:00 [55585] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:47:20.295_869+00:00 [55577] [INFO] 0x7f6dc0001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:47:20.295_998+00:00 [55577] [INFO] 0x7f6dc40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:47:20.296_098+00:00 [55577] [INFO] 0x7f6db80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:47:20.296_409+00:00 [55569] [INFO] 0x7f6dac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:47:34.024_444+00:00 [55585] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:47:34.024_458+00:00 [55585] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:47:34.024_485+00:00 [55585] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:47:34.024_490+00:00 [55585] [INFO] create snapshot idx 100000 log_term 1 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:48:05.354_053+00:00 [55930] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:48:05.355_417+00:00 [55930] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:48:05.355_448+00:00 [55930] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:48:05.355_456+00:00 [55930] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:48:05.355_479+00:00 [55930] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:48:05.355_483+00:00 [55930] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:48:05.355_486+00:00 [55930] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:48:05.355_518+00:00 [55930] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:48:05.355_667+00:00 [55967] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:48:06.943_708+00:00 [55938] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:48:06.943_719+00:00 [55938] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:48:06.943_735+00:00 [55938] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:48:06.943_746+00:00 [55938] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:48:06.943_754+00:00 [55938] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:48:06.943_757+00:00 [55938] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:48:06.943_776+00:00 [55938] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:48:06.943_827+00:00 [55966] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:48:06.943_834+00:00 [55966] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:48:06.943_843+00:00 [55966] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:48:17.668_322+00:00 [55938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:48:17.668_341+00:00 [55938] [INFO] session 1 got connection from 127.0.0.1:42164 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:48:17.668_442+00:00 [55938] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:48:17.668_468+00:00 [55938] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:48:17.668_527+00:00 [55938] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:48:17.668_562+00:00 [55938] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:48:17.668_565+00:00 [55938] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:48:17.668_567+00:00 [55938] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:48:17.668_575+00:00 [55938] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:48:17.669_268+00:00 [55938] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42164 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:48:18.169_860+00:00 [55938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:48:18.169_900+00:00 [55938] [INFO] session 2 got connection from 127.0.0.1:42166 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:48:18.170_046+00:00 [55938] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:48:18.170_050+00:00 [55938] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:48:18.170_200+00:00 [55938] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:48:18.170_204+00:00 [55938] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:48:18.170_274+00:00 [55966] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:48:18.170_277+00:00 [55966] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:48:18.170_285+00:00 [55966] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:48:18.170_287+00:00 [55966] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:48:18.170_295+00:00 [55966] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:48:18.170_308+00:00 [55966] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:48:18.170_313+00:00 [55966] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:48:18.170_331+00:00 [55966] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:48:37.161_127+00:00 [55957] [INFO] 0x7f55b0001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:37.161_255+00:00 [55957] [INFO] 0x7f55a80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:37.161_355+00:00 [55957] [INFO] 0x7f55ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:37.161_457+00:00 [55957] [INFO] 0x7f55a00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:37.161_637+00:00 [55957] [INFO] 0x7f55880014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:37.161_887+00:00 [55957] [INFO] 0x7f55800014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:48:49.048_880+00:00 [55966] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:48:49.048_893+00:00 [55966] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:48:49.048_919+00:00 [55966] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:48:49.048_925+00:00 [55966] [INFO] create snapshot idx 100000 log_term 1 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:49:22.234_576+00:00 [56326] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:49:22.236_630+00:00 [56326] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:49:22.236_662+00:00 [56326] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:49:22.236_670+00:00 [56326] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:49:22.236_694+00:00 [56326] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:49:22.236_698+00:00 [56326] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:49:22.236_702+00:00 [56326] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:49:22.236_734+00:00 [56326] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:49:22.237_226+00:00 [56363] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:49:24.126_042+00:00 [56334] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:49:24.126_065+00:00 [56334] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:49:24.126_102+00:00 [56334] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:49:24.126_129+00:00 [56334] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:49:24.126_145+00:00 [56334] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:49:24.126_156+00:00 [56334] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:49:24.126_204+00:00 [56334] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:49:24.126_339+00:00 [56362] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:49:24.126_365+00:00 [56362] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:49:24.126_392+00:00 [56362] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:49:34.299_275+00:00 [56334] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:49:34.299_296+00:00 [56334] [INFO] session 1 got connection from 127.0.0.1:42168 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:49:34.299_399+00:00 [56334] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:49:34.299_424+00:00 [56334] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:49:34.299_486+00:00 [56334] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:49:34.299_520+00:00 [56334] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:49:34.299_523+00:00 [56334] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:49:34.299_525+00:00 [56334] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:49:34.299_532+00:00 [56334] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:49:34.300_266+00:00 [56334] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42168 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:49:34.801_012+00:00 [56334] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:49:34.801_058+00:00 [56334] [INFO] session 2 got connection from 127.0.0.1:42170 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:49:34.801_212+00:00 [56334] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:49:34.801_216+00:00 [56334] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:49:34.801_355+00:00 [56334] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:49:34.801_359+00:00 [56334] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:49:34.801_425+00:00 [56362] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:49:34.801_428+00:00 [56362] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:49:34.801_436+00:00 [56362] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:49:34.801_438+00:00 [56362] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:49:34.801_445+00:00 [56362] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:49:34.801_458+00:00 [56362] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:49:34.801_463+00:00 [56362] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:49:34.801_483+00:00 [56362] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:49:54.292_876+00:00 [56354] [INFO] 0x7fc7a0001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_009+00:00 [56354] [INFO] 0x7fc7980014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_107+00:00 [56354] [INFO] 0x7fc7900014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_328+00:00 [56350] [INFO] 0x7fc7940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_440+00:00 [56350] [INFO] 0x7fc7880014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_568+00:00 [56350] [INFO] 0x7fc78c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.293_883+00:00 [56350] [INFO] 0x7fc7600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:54.294_213+00:00 [56350] [INFO] 0x7fc75c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:49:57.272_133+00:00 [56338] [INFO] 0x7fc75c188c70 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:50:06.100_850+00:00 [56362] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:50:06.100_863+00:00 [56362] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:50:06.100_889+00:00 [56362] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:50:06.100_978+00:00 [56362] [INFO] create snapshot idx 100000 log_term 1 done: 26 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:50:39.356_431+00:00 [56693] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:50:39.357_818+00:00 [56693] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:50:39.357_849+00:00 [56693] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:50:39.357_856+00:00 [56693] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:50:39.357_880+00:00 [56693] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:50:39.357_884+00:00 [56693] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:50:39.357_887+00:00 [56693] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:50:39.357_920+00:00 [56693] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:50:39.358_066+00:00 [56730] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:50:40.904_226+00:00 [56701] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:50:40.904_249+00:00 [56701] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:50:40.904_286+00:00 [56701] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:50:40.904_311+00:00 [56701] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:50:40.904_326+00:00 [56701] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:50:40.904_337+00:00 [56701] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:50:40.904_385+00:00 [56701] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:50:40.904_516+00:00 [56729] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:50:40.904_535+00:00 [56729] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:50:40.904_545+00:00 [56729] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:50:51.662_451+00:00 [56701] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:50:51.662_474+00:00 [56701] [INFO] session 1 got connection from 127.0.0.1:42172 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:50:51.662_580+00:00 [56701] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:50:51.662_605+00:00 [56701] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:50:51.662_686+00:00 [56701] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:50:51.662_731+00:00 [56701] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:50:51.662_734+00:00 [56701] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:50:51.662_736+00:00 [56701] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:50:51.662_746+00:00 [56701] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:50:51.663_475+00:00 [56701] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42172 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:50:52.164_267+00:00 [56701] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:50:52.164_307+00:00 [56701] [INFO] session 2 got connection from 127.0.0.1:42174 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:50:52.164_565+00:00 [56701] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:50:52.164_577+00:00 [56701] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:50:52.164_743+00:00 [56701] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:50:52.164_747+00:00 [56701] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:50:52.164_816+00:00 [56729] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:50:52.164_819+00:00 [56729] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:50:52.164_828+00:00 [56729] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:50:52.164_830+00:00 [56729] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:50:52.164_837+00:00 [56729] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:50:52.164_851+00:00 [56729] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:50:52.164_855+00:00 [56729] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:50:52.164_874+00:00 [56729] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:51:10.914_148+00:00 [56720] [INFO] 0x7f1e14001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_274+00:00 [56720] [INFO] 0x7f1e0c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_374+00:00 [56720] [INFO] 0x7f1e100014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_628+00:00 [56720] [INFO] 0x7f1e040014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_753+00:00 [56720] [INFO] 0x7f1e080014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_851+00:00 [56720] [INFO] 0x7f1dfc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.914_943+00:00 [56720] [INFO] 0x7f1e000014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.915_038+00:00 [56720] [INFO] 0x7f1df40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.915_209+00:00 [56720] [INFO] 0x7f1dd80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:10.915_396+00:00 [56720] [INFO] 0x7f1dd00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:51:21.407_626+00:00 [56729] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:51:21.407_639+00:00 [56729] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:51:21.407_664+00:00 [56729] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:51:21.407_669+00:00 [56729] [INFO] create snapshot idx 100000 log_term 1 done: 25 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:51:55.994_135+00:00 [57097] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:51:55.996_170+00:00 [57097] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:51:55.996_205+00:00 [57097] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:51:55.996_210+00:00 [57097] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:51:55.996_235+00:00 [57097] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:51:55.996_240+00:00 [57097] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:51:55.996_242+00:00 [57097] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:51:55.996_281+00:00 [57097] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:51:55.996_771+00:00 [57134] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:51:57.715_487+00:00 [57105] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:51:57.715_497+00:00 [57105] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:51:57.715_512+00:00 [57105] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:51:57.715_523+00:00 [57105] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:51:57.715_529+00:00 [57105] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:51:57.715_533+00:00 [57105] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:51:57.715_551+00:00 [57105] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:51:57.715_599+00:00 [57133] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:51:57.715_607+00:00 [57133] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:51:57.715_617+00:00 [57133] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:52:08.309_422+00:00 [57105] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:52:08.309_442+00:00 [57105] [INFO] session 1 got connection from 127.0.0.1:42176 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:52:08.309_542+00:00 [57105] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:52:08.309_566+00:00 [57105] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:52:08.309_628+00:00 [57105] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:52:08.309_662+00:00 [57105] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:52:08.309_665+00:00 [57105] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:52:08.309_667+00:00 [57105] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:52:08.309_675+00:00 [57105] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:52:08.310_350+00:00 [57105] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42176 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:52:08.810_587+00:00 [57105] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:52:08.810_603+00:00 [57105] [INFO] session 2 got connection from 127.0.0.1:42178 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:52:08.810_722+00:00 [57105] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:52:08.810_726+00:00 [57105] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:52:08.810_884+00:00 [57105] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:52:08.810_888+00:00 [57105] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:52:08.810_955+00:00 [57133] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:52:08.810_959+00:00 [57133] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:52:08.810_967+00:00 [57133] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:52:08.810_969+00:00 [57133] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:52:08.810_977+00:00 [57133] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:52:08.810_991+00:00 [57133] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:52:08.810_995+00:00 [57133] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:52:08.811_016+00:00 [57133] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:52:27.802_719+00:00 [57124] [INFO] 0x7fc8c4001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.802_856+00:00 [57124] [INFO] 0x7fc8bc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.802_952+00:00 [57124] [INFO] 0x7fc8c00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_049+00:00 [57124] [INFO] 0x7fc8b40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_142+00:00 [57124] [INFO] 0x7fc8b80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_356+00:00 [57124] [INFO] 0x7fc8ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_453+00:00 [57124] [INFO] 0x7fc8b00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_545+00:00 [57124] [INFO] 0x7fc8a40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_634+00:00 [57124] [INFO] 0x7fc8a80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:27.803_716+00:00 [57124] [INFO] 0x7fc89c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:52:38.370_376+00:00 [57133] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:52:38.370_470+00:00 [57133] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:52:38.371_207+00:00 [57133] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:52:38.371_214+00:00 [57133] [INFO] create snapshot idx 100000 log_term 1 done: 739 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:53:12.882_815+00:00 [57533] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:53:12.884_187+00:00 [57533] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:53:12.884_218+00:00 [57533] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:53:12.884_222+00:00 [57533] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:53:12.884_248+00:00 [57533] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:53:12.884_252+00:00 [57533] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:53:12.884_254+00:00 [57533] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:53:12.884_283+00:00 [57533] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:53:12.884_426+00:00 [57570] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:53:14.520_567+00:00 [57541] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:53:14.520_579+00:00 [57541] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:53:14.520_595+00:00 [57541] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:53:14.520_606+00:00 [57541] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:53:14.520_613+00:00 [57541] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:53:14.520_617+00:00 [57541] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:53:14.520_635+00:00 [57541] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:53:14.520_689+00:00 [57569] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:53:14.520_696+00:00 [57569] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:53:14.520_720+00:00 [57569] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:53:24.446_850+00:00 [57541] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:53:24.446_870+00:00 [57541] [INFO] session 1 got connection from 127.0.0.1:42182 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:53:24.446_966+00:00 [57541] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:53:24.446_992+00:00 [57541] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:53:24.447_052+00:00 [57541] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:53:24.447_087+00:00 [57541] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:53:24.447_090+00:00 [57541] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:53:24.447_092+00:00 [57541] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:53:24.447_100+00:00 [57541] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:53:24.447_793+00:00 [57541] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42182 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:53:24.948_397+00:00 [57541] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:53:24.948_436+00:00 [57541] [INFO] session 2 got connection from 127.0.0.1:42184 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:53:24.948_683+00:00 [57541] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:53:24.948_695+00:00 [57541] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:53:24.948_989+00:00 [57541] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:53:24.948_993+00:00 [57541] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:53:24.949_060+00:00 [57569] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:53:24.949_063+00:00 [57569] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:53:24.949_071+00:00 [57569] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:53:24.949_073+00:00 [57569] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:53:24.949_080+00:00 [57569] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:53:24.949_094+00:00 [57569] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:53:24.949_098+00:00 [57569] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:53:24.949_117+00:00 [57569] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:53:44.690_812+00:00 [57556] [INFO] 0x7fad5c001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.690_944+00:00 [57556] [INFO] 0x7fad540014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_057+00:00 [57560] [INFO] 0x7fad580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_275+00:00 [57560] [INFO] 0x7fad4c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_373+00:00 [57560] [INFO] 0x7fad500014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_456+00:00 [57560] [INFO] 0x7fad440014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_540+00:00 [57560] [INFO] 0x7fad480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_624+00:00 [57560] [INFO] 0x7fad3c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_708+00:00 [57560] [INFO] 0x7fad400014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:44.691_789+00:00 [57560] [INFO] 0x7fad340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:53:55.561_218+00:00 [57569] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:53:55.561_308+00:00 [57569] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:53:55.561_331+00:00 [57569] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:53:55.561_337+00:00 [57569] [INFO] create snapshot idx 100000 log_term 1 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:54:29.771_394+00:00 [57971] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:54:29.772_728+00:00 [57971] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:54:29.772_761+00:00 [57971] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:54:29.772_767+00:00 [57971] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:54:29.772_792+00:00 [57971] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:54:29.772_796+00:00 [57971] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:54:29.772_799+00:00 [57971] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:54:29.772_829+00:00 [57971] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:54:29.772_976+00:00 [58008] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:54:30.836_987+00:00 [57979] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:54:30.836_997+00:00 [57979] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:54:30.837_012+00:00 [57979] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:54:30.837_023+00:00 [57979] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:54:30.837_030+00:00 [57979] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:54:30.837_034+00:00 [57979] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:54:30.837_053+00:00 [57979] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:54:30.837_102+00:00 [58007] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:54:30.837_118+00:00 [58007] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:54:30.837_129+00:00 [58007] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:54:41.335_773+00:00 [57979] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:54:41.335_792+00:00 [57979] [INFO] session 1 got connection from 127.0.0.1:42186 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:54:41.335_891+00:00 [57979] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:54:41.335_917+00:00 [57979] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:54:41.335_975+00:00 [57979] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:54:41.336_009+00:00 [57979] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:54:41.336_012+00:00 [57979] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:54:41.336_014+00:00 [57979] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:54:41.336_022+00:00 [57979] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:54:41.336_818+00:00 [57979] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42186 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:54:41.837_072+00:00 [57979] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:54:41.837_088+00:00 [57979] [INFO] session 2 got connection from 127.0.0.1:42188 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:54:41.837_203+00:00 [57979] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:54:41.837_209+00:00 [57979] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:54:41.837_400+00:00 [57979] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:54:41.837_405+00:00 [57979] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:54:41.837_476+00:00 [58007] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:54:41.837_479+00:00 [58007] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:54:41.837_488+00:00 [58007] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:54:41.837_490+00:00 [58007] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:54:41.837_497+00:00 [58007] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:54:41.837_510+00:00 [58007] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:54:41.837_515+00:00 [58007] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:54:41.837_534+00:00 [58007] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:55:01.079_306+00:00 [57998] [INFO] 0x7f5dc8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.079_432+00:00 [57998] [INFO] 0x7f5dc00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.079_531+00:00 [57998] [INFO] 0x7f5dc40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.079_624+00:00 [57998] [INFO] 0x7f5db80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.079_829+00:00 [57998] [INFO] 0x7f5dbc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.079_915+00:00 [57998] [INFO] 0x7f5db00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.080_002+00:00 [57998] [INFO] 0x7f5db40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.080_081+00:00 [57998] [INFO] 0x7f5da80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.080_166+00:00 [57975] [INFO] 0x7f5dac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:01.080_251+00:00 [57975] [INFO] 0x7f5da00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:55:12.208_492+00:00 [58007] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:55:12.208_559+00:00 [58007] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:55:12.208_584+00:00 [58007] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:55:12.208_589+00:00 [58007] [INFO] create snapshot idx 100000 log_term 1 done: 24 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:55:46.160_575+00:00 [58394] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:55:46.161_920+00:00 [58394] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:55:46.161_951+00:00 [58394] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:55:46.161_955+00:00 [58394] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:55:46.161_980+00:00 [58394] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:55:46.161_984+00:00 [58394] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:55:46.161_987+00:00 [58394] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:55:46.162_017+00:00 [58394] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:55:46.162_168+00:00 [58431] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:55:48.209_172+00:00 [58402] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:55:48.209_182+00:00 [58402] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:55:48.209_198+00:00 [58402] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:55:48.209_209+00:00 [58402] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:55:48.209_216+00:00 [58402] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:55:48.209_220+00:00 [58402] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:55:48.209_238+00:00 [58402] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:55:48.209_288+00:00 [58430] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:55:48.209_296+00:00 [58430] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:55:48.209_306+00:00 [58430] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:55:57.974_718+00:00 [58402] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:55:57.974_740+00:00 [58402] [INFO] session 1 got connection from 127.0.0.1:42190 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:55:57.974_831+00:00 [58402] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:55:57.974_854+00:00 [58402] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:55:57.974_914+00:00 [58402] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:55:57.974_948+00:00 [58402] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:55:57.974_951+00:00 [58402] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:55:57.974_953+00:00 [58402] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:55:57.974_961+00:00 [58402] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:55:57.975_715+00:00 [58405] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42190 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:55:58.475_981+00:00 [58405] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:55:58.475_997+00:00 [58405] [INFO] session 2 got connection from 127.0.0.1:42192 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:55:58.476_099+00:00 [58405] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:55:58.476_102+00:00 [58405] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:55:58.476_251+00:00 [58405] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:55:58.476_259+00:00 [58405] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:55:58.476_327+00:00 [58430] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:55:58.476_330+00:00 [58430] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:55:58.476_338+00:00 [58430] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:55:58.476_340+00:00 [58430] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:55:58.476_347+00:00 [58430] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:55:58.476_361+00:00 [58430] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:55:58.476_366+00:00 [58430] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:55:58.476_386+00:00 [58430] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:56:18.218_210+00:00 [58423] [INFO] 0x7f9268001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_332+00:00 [58423] [INFO] 0x7f92600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_422+00:00 [58423] [INFO] 0x7f92640014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_625+00:00 [58419] [INFO] 0x7f92580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_752+00:00 [58419] [INFO] 0x7f925c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_845+00:00 [58419] [INFO] 0x7f92500014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.218_932+00:00 [58419] [INFO] 0x7f92540014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.219_012+00:00 [58419] [INFO] 0x7f92480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.219_092+00:00 [58419] [INFO] 0x7f924c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:18.219_172+00:00 [58419] [INFO] 0x7f92400014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:56:29.707_478+00:00 [58430] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:56:29.707_488+00:00 [58430] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:56:29.707_511+00:00 [58430] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:56:29.707_517+00:00 [58430] [INFO] create snapshot idx 100000 log_term 1 done: 23 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:57:03.284_160+00:00 [58844] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:57:03.285_511+00:00 [58844] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:57:03.285_542+00:00 [58844] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:57:03.285_546+00:00 [58844] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:57:03.285_568+00:00 [58844] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:57:03.285_572+00:00 [58844] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:57:03.285_575+00:00 [58844] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:57:03.285_605+00:00 [58844] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:57:03.285_757+00:00 [58881] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:57:04.431_775+00:00 [58852] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:57:04.431_786+00:00 [58852] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:57:04.431_800+00:00 [58852] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:57:04.431_809+00:00 [58852] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:57:04.431_816+00:00 [58852] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:57:04.431_820+00:00 [58852] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:57:04.431_836+00:00 [58852] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:57:04.431_883+00:00 [58880] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:57:04.431_890+00:00 [58880] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:57:04.431_897+00:00 [58880] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:57:15.098_512+00:00 [58852] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:57:15.098_532+00:00 [58852] [INFO] session 1 got connection from 127.0.0.1:42194 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:57:15.098_630+00:00 [58852] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:57:15.098_655+00:00 [58852] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:57:15.098_773+00:00 [58852] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:57:15.098_807+00:00 [58852] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:57:15.098_810+00:00 [58852] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:57:15.098_812+00:00 [58852] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:57:15.098_820+00:00 [58852] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:57:15.099_546+00:00 [58855] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42194 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:57:15.599_883+00:00 [58855] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:57:15.599_898+00:00 [58855] [INFO] session 2 got connection from 127.0.0.1:42196 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:57:15.599_987+00:00 [58855] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:57:15.599_990+00:00 [58855] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:57:15.600_144+00:00 [58855] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:57:15.600_153+00:00 [58855] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:57:15.600_220+00:00 [58880] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:57:15.600_224+00:00 [58880] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:57:15.600_233+00:00 [58880] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:57:15.600_234+00:00 [58880] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:57:15.600_242+00:00 [58880] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:57:15.600_255+00:00 [58880] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:57:15.600_260+00:00 [58880] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:57:15.600_278+00:00 [58880] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:57:34.591_787+00:00 [58872] [INFO] 0x7f1b1c001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.591_909+00:00 [58872] [INFO] 0x7f1b140014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.591_998+00:00 [58872] [INFO] 0x7f1b180014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_086+00:00 [58872] [INFO] 0x7f1b0c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_171+00:00 [58872] [INFO] 0x7f1b100014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_255+00:00 [58872] [INFO] 0x7f1b040014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_453+00:00 [58872] [INFO] 0x7f1b080014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_536+00:00 [58872] [INFO] 0x7f1afc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_614+00:00 [58872] [INFO] 0x7f1b000014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:34.592_692+00:00 [58872] [INFO] 0x7f1af40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:57:46.297_302+00:00 [58880] [INFO] creating a snapshot for index 100000	[handle_commit.cxx:482, snapshot_and_compact()]
2022-04-29T05:57:46.297_310+00:00 [58880] [INFO] create snapshot idx 100000 log_term 1	[handle_commit.cxx:523, snapshot_and_compact()]
2022-04-29T05:57:46.297_332+00:00 [58880] [INFO] snapshot idx 100000 log_term 1 created, compact the log store if needed	[handle_commit.cxx:567, on_snapshot_completed()]
2022-04-29T05:57:46.297_337+00:00 [58880] [INFO] create snapshot idx 100000 log_term 1 done: 22 us elapsed	[handle_commit.cxx:534, snapshot_and_compact()]
2022-04-29T05:59:15.644_787+00:00 [59521] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T05:59:15.646_105+00:00 [59521] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T05:59:15.646_144+00:00 [59521] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T05:59:15.646_148+00:00 [59521] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T05:59:15.646_170+00:00 [59521] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T05:59:15.646_175+00:00 [59521] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T05:59:15.646_177+00:00 [59521] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T05:59:15.646_211+00:00 [59521] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T05:59:15.646_360+00:00 [59558] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T05:59:17.628_401+00:00 [59529] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:59:17.628_411+00:00 [59529] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T05:59:17.628_425+00:00 [59529] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:59:17.628_435+00:00 [59529] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:59:17.628_442+00:00 [59529] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:59:17.628_445+00:00 [59529] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T05:59:17.628_463+00:00 [59529] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T05:59:17.628_512+00:00 [59557] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:59:17.628_520+00:00 [59557] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:59:17.628_530+00:00 [59557] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:59:27.209_737+00:00 [59529] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:59:27.209_758+00:00 [59529] [INFO] session 1 got connection from 127.0.0.1:42198 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:59:27.209_856+00:00 [59529] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T05:59:27.209_881+00:00 [59529] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:59:27.209_942+00:00 [59529] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:59:27.209_971+00:00 [59529] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T05:59:27.209_973+00:00 [59529] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T05:59:27.209_975+00:00 [59529] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T05:59:27.209_982+00:00 [59529] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:59:27.210_920+00:00 [59529] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42198 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:59:27.711_156+00:00 [59529] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:59:27.711_170+00:00 [59529] [INFO] session 2 got connection from 127.0.0.1:42200 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:59:27.711_261+00:00 [59529] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T05:59:27.711_264+00:00 [59529] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T05:59:27.711_401+00:00 [59529] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:59:27.711_405+00:00 [59529] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T05:59:27.711_464+00:00 [59557] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:59:27.711_466+00:00 [59557] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:59:27.711_474+00:00 [59557] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:59:27.711_475+00:00 [59557] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T05:59:27.711_481+00:00 [59557] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:59:27.711_492+00:00 [59557] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:59:27.711_496+00:00 [59557] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T05:59:27.711_514+00:00 [59557] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:59:47.702_000+00:00 [59548] [INFO] 0x7f7dc4001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:59:47.702_131+00:00 [59548] [INFO] 0x7f7dbc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:59:57.856_175+00:00 [59547] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42200 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T05:59:59.135_661+00:00 [59547] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T05:59:59.135_673+00:00 [59547] [INFO] session 3 got connection from 127.0.0.1:42204 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T05:59:59.135_773+00:00 [59547] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 46291 / mine 46291, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T05:59:59.135_780+00:00 [59547] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T05:59:59.473_101+00:00 [59547] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T05:59:59.473_132+00:00 [59547] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T05:59:59.473_140+00:00 [59547] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T05:59:59.473_220+00:00 [59547] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T05:59:59.473_261+00:00 [59547] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 46291, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T05:59:59.473_515+00:00 [59547] [INFO] 0x7f7dd4307390 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T05:59:59.473_590+00:00 [59547] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T05:59:59.473_701+00:00 [59547] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T05:59:59.473_705+00:00 [59547] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T05:59:59.473_708+00:00 [59547] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T05:59:59.473_722+00:00 [59547] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 46291, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T05:59:59.473_880+00:00 [59547] [INFO] [VOTE RESP] peer 2 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T05:59:59.473_884+00:00 [59547] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-29T05:59:59.473_891+00:00 [59547] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T05:59:59.473_895+00:00 [59547] [INFO] state machine commit index 46291, precommit index 46291, last log index 46291	[raft_server.cxx:953, become_leader()]
2022-04-29T05:59:59.473_933+00:00 [59547] [INFO] [BECOME LEADER] appended new config at 46292	[raft_server.cxx:993, become_leader()]
2022-04-29T05:59:59.474_015+00:00 [59547] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-29T05:59:59.474_290+00:00 [59557] [INFO] config at index 46292 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T05:59:59.474_310+00:00 [59557] [INFO] new config log idx 46292, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T05:59:59.474_323+00:00 [59557] [INFO] new configuration: log idx 46292, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T05:59:59.974_400+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:00.474_526+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:01.024_584+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:01.624_710+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:02.274_945+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:02.975_102+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:03.725_242+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:04.475_375+00:00 [59540] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:05.226_019+00:00 [59528] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:05.975_946+00:00 [59528] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:06.726_470+00:00 [59528] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:07.476_401+00:00 [59528] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:00:32.766_731+00:00 [59930] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:00:32.768_064+00:00 [59930] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:00:32.768_094+00:00 [59930] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:00:32.768_102+00:00 [59930] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:00:32.768_126+00:00 [59930] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:00:32.768_130+00:00 [59930] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:00:32.768_133+00:00 [59930] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:00:32.768_165+00:00 [59930] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:00:32.768_308+00:00 [59967] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:00:34.424_393+00:00 [59938] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:00:34.424_403+00:00 [59938] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:00:34.424_420+00:00 [59938] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:00:34.424_436+00:00 [59938] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:00:34.424_451+00:00 [59938] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:00:34.424_455+00:00 [59938] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:00:34.424_472+00:00 [59938] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:00:34.424_514+00:00 [59966] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:00:34.424_520+00:00 [59966] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:00:34.424_529+00:00 [59966] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:00:44.831_942+00:00 [59938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:00:44.831_961+00:00 [59938] [INFO] session 1 got connection from 127.0.0.1:42206 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:00:44.832_059+00:00 [59938] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:00:44.832_086+00:00 [59938] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:00:44.832_146+00:00 [59938] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:00:44.832_181+00:00 [59938] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:00:44.832_184+00:00 [59938] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:00:44.832_185+00:00 [59938] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:00:44.832_194+00:00 [59938] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:00:44.832_898+00:00 [59938] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42206 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:00:45.333_205+00:00 [59938] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:00:45.333_221+00:00 [59938] [INFO] session 2 got connection from 127.0.0.1:42208 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:00:45.333_314+00:00 [59938] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:00:45.333_318+00:00 [59938] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:00:45.333_494+00:00 [59938] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:00:45.333_498+00:00 [59938] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:00:45.333_562+00:00 [59966] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:00:45.333_565+00:00 [59966] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:00:45.333_574+00:00 [59966] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:00:45.333_576+00:00 [59966] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:00:45.333_583+00:00 [59966] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:00:45.333_596+00:00 [59966] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:00:45.333_601+00:00 [59966] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:00:45.333_621+00:00 [59966] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:01:04.573_443+00:00 [59958] [INFO] 0x7faaa8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:01:04.573_571+00:00 [59958] [INFO] 0x7faaac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:01:04.573_670+00:00 [59958] [INFO] 0x7faaa00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:01:04.573_949+00:00 [59958] [INFO] 0x7faa940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:01:10.960_704+00:00 [59948] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42208 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:01:12.153_306+00:00 [59948] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:01:12.153_371+00:00 [59948] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:01:12.153_390+00:00 [59948] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:01:12.153_560+00:00 [59948] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:01:12.153_681+00:00 [59948] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 46286, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:01:12.154_291+00:00 [59948] [INFO] 0x7faad0002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:01:12.154_356+00:00 [59948] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:01:12.154_437+00:00 [59948] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:01:12.799_919+00:00 [59948] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:01:12.799_932+00:00 [59948] [INFO] session 3 got connection from 127.0.0.1:42210 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:01:12.800_030+00:00 [59953] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 46286 / mine 46286, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:01:12.800_039+00:00 [59953] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:01:12.800_220+00:00 [59948] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:01:12.800_240+00:00 [59948] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:01:12.800_253+00:00 [59948] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 46286 / mine 46286, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:01:12.800_268+00:00 [59948] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:01:12.800_473+00:00 [59948] [INFO] receive a config change from leader at 46287	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:01:12.800_662+00:00 [59966] [INFO] config at index 46287 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:01:12.800_685+00:00 [59966] [INFO] new config log idx 46287, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:01:12.800_700+00:00 [59966] [INFO] new configuration: log idx 46287, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:01:49.638_200+00:00 [60394] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:01:49.639_552+00:00 [60394] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:01:49.639_583+00:00 [60394] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:01:49.639_590+00:00 [60394] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:01:49.639_610+00:00 [60394] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:01:49.639_614+00:00 [60394] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:01:49.639_617+00:00 [60394] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:01:49.639_647+00:00 [60394] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:01:49.639_790+00:00 [60431] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:01:51.258_949+00:00 [60402] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:01:51.258_971+00:00 [60402] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:01:51.259_007+00:00 [60402] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:01:51.259_033+00:00 [60402] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:01:51.259_050+00:00 [60402] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:01:51.259_061+00:00 [60402] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:01:51.259_110+00:00 [60402] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:01:51.259_242+00:00 [60430] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:01:51.259_268+00:00 [60430] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:01:51.259_294+00:00 [60430] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:02:01.953_165+00:00 [60402] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:02:01.953_204+00:00 [60402] [INFO] session 1 got connection from 127.0.0.1:42212 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:02:01.953_306+00:00 [60402] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:02:01.953_329+00:00 [60402] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:02:01.953_388+00:00 [60402] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:02:01.953_423+00:00 [60402] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:02:01.953_426+00:00 [60402] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:02:01.953_429+00:00 [60402] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:02:01.953_436+00:00 [60402] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:02:01.954_132+00:00 [60402] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42212 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:02:02.454_524+00:00 [60402] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:02:02.454_539+00:00 [60402] [INFO] session 2 got connection from 127.0.0.1:42214 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:02:02.454_640+00:00 [60402] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:02:02.454_644+00:00 [60402] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:02:02.454_826+00:00 [60402] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:02:02.454_831+00:00 [60402] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:02:02.454_899+00:00 [60430] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:02:02.454_903+00:00 [60430] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:02:02.454_911+00:00 [60430] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:02:02.454_913+00:00 [60430] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:02:02.454_920+00:00 [60430] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:02:02.454_933+00:00 [60430] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:02:02.454_938+00:00 [60430] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:02:02.454_957+00:00 [60430] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:02:21.445_334+00:00 [60414] [INFO] 0x7fe2b0001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:21.445_468+00:00 [60414] [INFO] 0x7fe2a80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:21.445_565+00:00 [60414] [INFO] 0x7fe2ac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:21.445_660+00:00 [60414] [INFO] 0x7fe2a00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:21.445_941+00:00 [60425] [INFO] 0x7fe2940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:21.446_092+00:00 [60425] [INFO] 0x7fe28c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:27.189_239+00:00 [60429] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42214 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:02:28.303_594+00:00 [60429] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:02:28.303_609+00:00 [60429] [INFO] session 3 got connection from 127.0.0.1:42216 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:02:28.303_717+00:00 [60429] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 46081 / mine 46081, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:02:28.303_725+00:00 [60429] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:02:29.003_015+00:00 [60429] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:02:29.003_075+00:00 [60429] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:02:29.003_093+00:00 [60429] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:02:29.003_271+00:00 [60429] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:02:29.003_386+00:00 [60429] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 46081, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:02:29.003_893+00:00 [60429] [INFO] 0x7fe26853e110 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:02:29.003_964+00:00 [60429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:29.004_060+00:00 [60421] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:02:29.004_065+00:00 [60421] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:02:29.004_069+00:00 [60421] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:02:29.004_081+00:00 [60421] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 46081, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:02:29.004_233+00:00 [60429] [INFO] [VOTE RESP] peer 2 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:02:29.004_237+00:00 [60429] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-29T06:02:29.004_243+00:00 [60429] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:02:29.004_248+00:00 [60429] [INFO] state machine commit index 46081, precommit index 46081, last log index 46081	[raft_server.cxx:953, become_leader()]
2022-04-29T06:02:29.004_286+00:00 [60429] [INFO] [BECOME LEADER] appended new config at 46082	[raft_server.cxx:993, become_leader()]
2022-04-29T06:02:29.004_379+00:00 [60429] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-29T06:02:29.004_618+00:00 [60429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:29.004_730+00:00 [60430] [INFO] config at index 46082 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:02:29.004_749+00:00 [60430] [INFO] new config log idx 46082, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:02:29.004_764+00:00 [60430] [INFO] new configuration: log idx 46082, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:02:29.504_697+00:00 [60429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:30.055_162+00:00 [60429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:30.655_083+00:00 [60429] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:31.305_224+00:00 [60426] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:32.005_536+00:00 [60412] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:32.755_867+00:00 [60412] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:33.506_084+00:00 [60412] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:34.256_336+00:00 [60414] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:35.006_610+00:00 [60414] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:35.756_689+00:00 [60414] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:36.506_892+00:00 [60420] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:37.257_064+00:00 [60420] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:38.007_580+00:00 [60420] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:38.757_938+00:00 [60403] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:39.507_856+00:00 [60403] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:40.258_021+00:00 [60403] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:02:41.008_214+00:00 [60403] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:03:06.511_022+00:00 [60854] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:03:06.512_382+00:00 [60854] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:03:06.512_412+00:00 [60854] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:03:06.512_419+00:00 [60854] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:03:06.512_443+00:00 [60854] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:03:06.512_447+00:00 [60854] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:03:06.512_450+00:00 [60854] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:03:06.512_481+00:00 [60854] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:03:06.512_639+00:00 [60891] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:03:08.548_673+00:00 [60862] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:03:08.548_684+00:00 [60862] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:03:08.548_698+00:00 [60862] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:03:08.548_713+00:00 [60862] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:03:08.548_720+00:00 [60862] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:03:08.548_724+00:00 [60862] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:03:08.548_741+00:00 [60862] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:03:08.548_790+00:00 [60890] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:03:08.548_798+00:00 [60890] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:03:08.548_807+00:00 [60890] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:03:18.321_700+00:00 [60862] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:03:18.321_720+00:00 [60862] [INFO] session 1 got connection from 127.0.0.1:42218 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:03:18.321_816+00:00 [60862] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:03:18.321_841+00:00 [60862] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:03:18.321_901+00:00 [60862] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:03:18.321_936+00:00 [60862] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:03:18.321_939+00:00 [60862] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:03:18.321_941+00:00 [60862] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:03:18.321_949+00:00 [60862] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:03:18.322_656+00:00 [60862] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42218 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:03:18.823_234+00:00 [60862] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:03:18.823_247+00:00 [60862] [INFO] session 2 got connection from 127.0.0.1:42220 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:03:18.823_338+00:00 [60862] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:03:18.823_342+00:00 [60862] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:03:18.823_492+00:00 [60862] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:03:18.823_496+00:00 [60862] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:03:18.823_565+00:00 [60890] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:03:18.823_568+00:00 [60890] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:03:18.823_576+00:00 [60890] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:03:18.823_579+00:00 [60890] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:03:18.823_586+00:00 [60890] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:03:18.823_600+00:00 [60890] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:03:18.823_604+00:00 [60890] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:03:18.823_624+00:00 [60890] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:03:38.568_256+00:00 [60881] [INFO] 0x7fb7fc001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.568_384+00:00 [60881] [INFO] 0x7fb7f40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.568_493+00:00 [60879] [INFO] 0x7fb7f80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.568_708+00:00 [60879] [INFO] 0x7fb7ec0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.568_810+00:00 [60879] [INFO] 0x7fb7f00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.568_899+00:00 [60879] [INFO] 0x7fb7e40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.569_051+00:00 [60879] [INFO] 0x7fb7c40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:38.569_196+00:00 [60879] [INFO] 0x7fb7c80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:43.038_512+00:00 [60866] [INFO] 0x7fb7f4018950 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:44.048_298+00:00 [60882] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42220 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:03:45.226_366+00:00 [60882] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:03:45.226_399+00:00 [60882] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:03:45.226_408+00:00 [60882] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:03:45.226_477+00:00 [60882] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:03:45.226_521+00:00 [60882] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 45775, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:03:45.226_788+00:00 [60882] [INFO] 0x7fb828002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:03:45.226_859+00:00 [60882] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:03:45.226_965+00:00 [60882] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:03:45.475_266+00:00 [60882] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:03:45.475_280+00:00 [60882] [INFO] session 3 got connection from 127.0.0.1:42222 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:03:45.475_367+00:00 [60882] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 45780 / mine 45775, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:03:45.475_375+00:00 [60882] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:03:45.475_577+00:00 [60879] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:03:45.475_600+00:00 [60879] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:03:45.475_617+00:00 [60879] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 45780 / mine 45775, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:03:45.475_631+00:00 [60879] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:03:45.475_839+00:00 [60879] [WARN] [LOG XX] req log idx: 45780, req log term: 1, my last log idx: 45775, my log (45780) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:03:45.475_848+00:00 [60879] [WARN] deny, req term 2, my term 2, req log idx 45780, my log idx 45775	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:03:45.476_068+00:00 [60879] [INFO] receive a config change from leader at 45781	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:03:45.476_305+00:00 [60890] [INFO] config at index 45781 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:03:45.476_327+00:00 [60890] [INFO] new config log idx 45781, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:03:45.476_342+00:00 [60890] [INFO] new configuration: log idx 45781, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:04:23.633_934+00:00 [61303] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:04:23.635_283+00:00 [61303] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:04:23.635_313+00:00 [61303] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:04:23.635_323+00:00 [61303] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:04:23.635_346+00:00 [61303] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:04:23.635_350+00:00 [61303] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:04:23.635_353+00:00 [61303] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:04:23.635_388+00:00 [61303] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:04:23.635_532+00:00 [61340] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:04:25.643_570+00:00 [61311] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:04:25.643_579+00:00 [61311] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:04:25.643_594+00:00 [61311] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:04:25.643_604+00:00 [61311] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:04:25.643_610+00:00 [61311] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:04:25.643_614+00:00 [61311] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:04:25.643_632+00:00 [61311] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:04:25.643_680+00:00 [61339] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:04:25.643_688+00:00 [61339] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:04:25.643_697+00:00 [61339] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:04:35.198_706+00:00 [61311] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:04:35.198_728+00:00 [61311] [INFO] session 1 got connection from 127.0.0.1:42224 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:04:35.198_834+00:00 [61311] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:04:35.198_860+00:00 [61311] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:04:35.198_918+00:00 [61311] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:04:35.198_953+00:00 [61311] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:04:35.198_956+00:00 [61311] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:04:35.198_959+00:00 [61311] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:04:35.198_970+00:00 [61311] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:04:35.199_936+00:00 [61311] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42224 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:04:35.700_139+00:00 [61311] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:04:35.700_154+00:00 [61311] [INFO] session 2 got connection from 127.0.0.1:42226 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:04:35.700_249+00:00 [61311] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:04:35.700_254+00:00 [61311] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:04:35.700_406+00:00 [61311] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:04:35.700_410+00:00 [61311] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:04:35.700_479+00:00 [61339] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:04:35.700_483+00:00 [61339] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:04:35.700_492+00:00 [61339] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:04:35.700_495+00:00 [61339] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:04:35.700_503+00:00 [61339] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:04:35.700_520+00:00 [61339] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:04:35.700_526+00:00 [61339] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:04:35.700_550+00:00 [61339] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:04:55.691_379+00:00 [61329] [INFO] 0x7f81dc001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.691_505+00:00 [61329] [INFO] 0x7f81d40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.691_607+00:00 [61329] [INFO] 0x7f81d80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.691_869+00:00 [61329] [INFO] 0x7f81cc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_001+00:00 [61329] [INFO] 0x7f81d00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_097+00:00 [61329] [INFO] 0x7f81c40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_189+00:00 [61329] [INFO] 0x7f81c80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_278+00:00 [61329] [INFO] 0x7f81bc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_431+00:00 [61329] [INFO] 0x7f81940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:04:55.692_565+00:00 [61329] [INFO] 0x55d5d75404b0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:05:00.598_799+00:00 [61311] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42226 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:05:01.947_114+00:00 [61311] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:05:01.947_183+00:00 [61311] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:05:01.947_201+00:00 [61311] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:05:01.947_265+00:00 [61311] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:05:01.947_286+00:00 [61311] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 44651, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:05:01.947_547+00:00 [61311] [INFO] 0x7f8208002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:05:01.947_619+00:00 [61311] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:05:01.947_744+00:00 [61311] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:05:02.379_839+00:00 [61311] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:05:02.379_854+00:00 [61311] [INFO] session 3 got connection from 127.0.0.1:42230 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:05:02.379_959+00:00 [61311] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 44654 / mine 44651, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:05:02.379_967+00:00 [61311] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:05:02.380_154+00:00 [61336] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:05:02.380_176+00:00 [61336] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:05:02.380_190+00:00 [61336] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 44654 / mine 44651, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:05:02.380_204+00:00 [61336] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:05:02.380_419+00:00 [61336] [WARN] [LOG XX] req log idx: 44654, req log term: 1, my last log idx: 44651, my log (44654) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:05:02.380_428+00:00 [61336] [WARN] deny, req term 2, my term 2, req log idx 44654, my log idx 44651	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:05:02.380_615+00:00 [61336] [INFO] receive a config change from leader at 44655	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:05:02.380_834+00:00 [61339] [INFO] config at index 44655 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:05:02.380_855+00:00 [61339] [INFO] new config log idx 44655, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:05:02.380_868+00:00 [61339] [INFO] new configuration: log idx 44655, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:05:40.758_146+00:00 [61755] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:05:40.759_537+00:00 [61755] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:05:40.759_567+00:00 [61755] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:05:40.759_574+00:00 [61755] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:05:40.759_598+00:00 [61755] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:05:40.759_602+00:00 [61755] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:05:40.759_605+00:00 [61755] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:05:40.759_632+00:00 [61755] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:05:40.759_786+00:00 [61792] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:05:42.390_827+00:00 [61763] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:05:42.390_842+00:00 [61763] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:05:42.390_855+00:00 [61763] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:05:42.390_867+00:00 [61763] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:05:42.390_873+00:00 [61763] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:05:42.390_876+00:00 [61763] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:05:42.390_893+00:00 [61763] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:05:42.390_933+00:00 [61791] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:05:42.390_940+00:00 [61791] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:05:42.390_948+00:00 [61791] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:05:52.572_358+00:00 [61763] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:05:52.572_376+00:00 [61763] [INFO] session 1 got connection from 127.0.0.1:42232 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:05:52.572_463+00:00 [61763] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:05:52.572_486+00:00 [61763] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:05:52.572_536+00:00 [61763] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:05:52.572_563+00:00 [61763] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:05:52.572_565+00:00 [61763] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:05:52.572_566+00:00 [61763] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:05:52.572_575+00:00 [61763] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:05:52.573_246+00:00 [61763] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42232 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:05:53.073_625+00:00 [61763] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:05:53.073_640+00:00 [61763] [INFO] session 2 got connection from 127.0.0.1:42234 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:05:53.073_741+00:00 [61763] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:05:53.073_745+00:00 [61763] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:05:53.073_900+00:00 [61763] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:05:53.073_904+00:00 [61763] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:05:53.073_973+00:00 [61791] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:05:53.073_976+00:00 [61791] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:05:53.073_985+00:00 [61791] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:05:53.073_987+00:00 [61791] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:05:53.073_994+00:00 [61791] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:05:53.074_008+00:00 [61791] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:05:53.074_013+00:00 [61791] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:05:53.074_033+00:00 [61791] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:06:12.566_272+00:00 [61783] [INFO] 0x7f91f8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.566_404+00:00 [61783] [INFO] 0x7f91f00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.566_503+00:00 [61783] [INFO] 0x7f91f40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.566_614+00:00 [61783] [INFO] 0x7f91e80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.566_839+00:00 [61783] [INFO] 0x7f91ec0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.566_936+00:00 [61783] [INFO] 0x7f91e00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.567_031+00:00 [61783] [INFO] 0x7f91e40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.567_123+00:00 [61783] [INFO] 0x7f91d80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.567_222+00:00 [61780] [INFO] 0x7f91dc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:12.567_451+00:00 [61780] [INFO] 0x7f91d00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:17.485_196+00:00 [61778] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42234 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:06:18.995_897+00:00 [61778] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:06:18.995_911+00:00 [61778] [INFO] session 3 got connection from 127.0.0.1:42236 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:06:18.996_030+00:00 [61778] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 45549 / mine 45558, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:06:18.996_039+00:00 [61778] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:06:19.360_954+00:00 [61778] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:06:19.360_983+00:00 [61778] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:06:19.360_991+00:00 [61778] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:06:19.361_063+00:00 [61778] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:06:19.361_103+00:00 [61778] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 45558, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:06:19.361_334+00:00 [61778] [INFO] 0x7f91d82ea000 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:06:19.361_408+00:00 [61778] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:19.361_498+00:00 [61780] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:06:19.361_505+00:00 [61780] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:06:19.361_507+00:00 [61780] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:06:19.361_519+00:00 [61780] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 45558, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:06:19.361_714+00:00 [61779] [INFO] [VOTE RESP] peer 2 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:06:19.361_721+00:00 [61779] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-29T06:06:19.361_736+00:00 [61779] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:06:19.361_739+00:00 [61779] [INFO] state machine commit index 45550, precommit index 45558, last log index 45558	[raft_server.cxx:953, become_leader()]
2022-04-29T06:06:19.361_796+00:00 [61779] [INFO] [BECOME LEADER] appended new config at 45559	[raft_server.cxx:993, become_leader()]
2022-04-29T06:06:19.361_870+00:00 [61779] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-29T06:06:19.361_950+00:00 [61779] [WARN] declined append: peer 2, prev next log idx 45559, resp next 45550, new next log idx 45550	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-29T06:06:19.362_435+00:00 [61791] [INFO] config at index 45559 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:06:19.362_447+00:00 [61791] [INFO] new config log idx 45559, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:06:19.362_455+00:00 [61791] [INFO] new configuration: log idx 45559, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:06:19.362_557+00:00 [61779] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:19.862_194+00:00 [61763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:20.412_220+00:00 [61763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:21.012_426+00:00 [61763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:21.662_576+00:00 [61763] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:22.362_814+00:00 [61759] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:23.112_941+00:00 [61759] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:23.863_081+00:00 [61759] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:24.613_261+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:25.363_385+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:26.113_540+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:26.863_680+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:27.613_799+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:28.363_938+00:00 [61762] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:29.114_125+00:00 [61769] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:29.864_245+00:00 [61769] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:30.614_392+00:00 [61769] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:31.364_550+00:00 [61769] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:06:32.114_750+00:00 [61769] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-29T06:06:57.622_109+00:00 [62216] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:06:57.623_479+00:00 [62216] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:06:57.623_512+00:00 [62216] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:06:57.623_516+00:00 [62216] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:06:57.623_537+00:00 [62216] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:06:57.623_541+00:00 [62216] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:06:57.623_543+00:00 [62216] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:06:57.623_575+00:00 [62216] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:06:57.623_723+00:00 [62253] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:06:59.015_861+00:00 [62224] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:06:59.015_884+00:00 [62224] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:06:59.015_921+00:00 [62224] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:06:59.015_959+00:00 [62224] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:06:59.015_975+00:00 [62224] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:06:59.015_985+00:00 [62224] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:06:59.016_032+00:00 [62224] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:06:59.016_163+00:00 [62252] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:06:59.016_189+00:00 [62252] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:06:59.016_215+00:00 [62252] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:07:09.936_775+00:00 [62224] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:07:09.936_798+00:00 [62224] [INFO] session 1 got connection from 127.0.0.1:42238 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:07:09.936_897+00:00 [62224] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:07:09.936_922+00:00 [62224] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:07:09.936_982+00:00 [62224] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:07:09.937_015+00:00 [62224] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:07:09.937_018+00:00 [62224] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:07:09.937_020+00:00 [62224] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:07:09.937_028+00:00 [62224] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:07:09.937_733+00:00 [62224] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42238 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:07:10.438_079+00:00 [62224] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:07:10.438_094+00:00 [62224] [INFO] session 2 got connection from 127.0.0.1:42240 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:07:10.438_194+00:00 [62224] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:07:10.438_198+00:00 [62224] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:07:10.438_353+00:00 [62224] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:07:10.438_357+00:00 [62224] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:07:10.438_424+00:00 [62252] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:07:10.438_427+00:00 [62252] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:07:10.438_435+00:00 [62252] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:07:10.438_437+00:00 [62252] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:07:10.438_445+00:00 [62252] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:07:10.438_458+00:00 [62252] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:07:10.438_463+00:00 [62252] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:07:10.438_482+00:00 [62252] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:07:29.179_576+00:00 [62246] [INFO] 0x7f7174001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.179_707+00:00 [62246] [INFO] 0x7f716c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.179_811+00:00 [62246] [INFO] 0x7f71700014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_071+00:00 [62246] [INFO] 0x7f71640014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_175+00:00 [62246] [INFO] 0x7f71680014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_264+00:00 [62246] [INFO] 0x7f715c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_356+00:00 [62246] [INFO] 0x7f71600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_445+00:00 [62246] [INFO] 0x7f71540014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_551+00:00 [62246] [INFO] 0x7f71580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:29.180_738+00:00 [62237] [INFO] 0x7f714c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:34.190_503+00:00 [62241] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42240 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:07:35.980_576+00:00 [62241] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:07:35.980_605+00:00 [62241] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:07:35.980_613+00:00 [62241] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:07:35.980_687+00:00 [62241] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:07:35.980_726+00:00 [62241] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 45641, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:07:35.980_952+00:00 [62241] [INFO] 0x7f71a0002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:07:35.981_023+00:00 [62241] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:07:35.981_126+00:00 [62241] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:07:36.060_101+00:00 [62241] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:07:36.060_113+00:00 [62241] [INFO] session 3 got connection from 127.0.0.1:42242 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:07:36.060_184+00:00 [62241] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 45646 / mine 45641, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:07:36.060_191+00:00 [62241] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:07:36.060_412+00:00 [62241] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:07:36.060_432+00:00 [62241] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:07:36.060_444+00:00 [62241] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 45646 / mine 45641, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:07:36.060_458+00:00 [62241] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:07:36.060_664+00:00 [62241] [WARN] [LOG XX] req log idx: 45646, req log term: 1, my last log idx: 45641, my log (45646) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:07:36.060_669+00:00 [62241] [WARN] deny, req term 2, my term 2, req log idx 45646, my log idx 45641	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:07:36.060_892+00:00 [62235] [INFO] receive a config change from leader at 45647	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:07:36.061_110+00:00 [62252] [INFO] config at index 45647 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:07:36.061_128+00:00 [62252] [INFO] new config log idx 45647, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:07:36.061_141+00:00 [62252] [INFO] new configuration: log idx 45647, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:08:14.245_968+00:00 [62671] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:08:14.247_364+00:00 [62671] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:08:14.247_397+00:00 [62671] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:08:14.247_404+00:00 [62671] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:08:14.247_428+00:00 [62671] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:08:14.247_431+00:00 [62671] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:08:14.247_434+00:00 [62671] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:08:14.247_461+00:00 [62671] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:08:14.247_607+00:00 [62708] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:08:16.170_832+00:00 [62679] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:08:16.170_855+00:00 [62679] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:08:16.170_893+00:00 [62679] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:08:16.170_919+00:00 [62679] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:08:16.170_934+00:00 [62679] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:08:16.170_945+00:00 [62679] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:08:16.170_994+00:00 [62679] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:08:16.171_123+00:00 [62707] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:08:16.171_149+00:00 [62707] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:08:16.171_175+00:00 [62707] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:08:26.560_891+00:00 [62679] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:08:26.560_913+00:00 [62679] [INFO] session 1 got connection from 127.0.0.1:42244 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:08:26.561_020+00:00 [62679] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:08:26.561_045+00:00 [62679] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:08:26.561_106+00:00 [62679] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:08:26.561_139+00:00 [62679] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:08:26.561_142+00:00 [62679] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:08:26.561_144+00:00 [62679] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:08:26.561_152+00:00 [62679] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:08:26.561_887+00:00 [62679] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42244 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:08:27.062_245+00:00 [62679] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:08:27.062_259+00:00 [62679] [INFO] session 2 got connection from 127.0.0.1:42246 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:08:27.062_353+00:00 [62679] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:08:27.062_357+00:00 [62679] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:08:27.062_512+00:00 [62679] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:08:27.062_516+00:00 [62679] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:08:27.062_585+00:00 [62707] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:08:27.062_588+00:00 [62707] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:08:27.062_597+00:00 [62707] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:08:27.062_598+00:00 [62707] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:08:27.062_605+00:00 [62707] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:08:27.062_619+00:00 [62707] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:08:27.062_624+00:00 [62707] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:08:27.062_643+00:00 [62707] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:08:46.303_907+00:00 [62699] [INFO] 0x7f7934001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_037+00:00 [62699] [INFO] 0x7f792c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_136+00:00 [62699] [INFO] 0x7f79300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_360+00:00 [62696] [INFO] 0x7f79240014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_470+00:00 [62696] [INFO] 0x7f79280014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_561+00:00 [62696] [INFO] 0x7f791c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_645+00:00 [62696] [INFO] 0x7f79200014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_727+00:00 [62696] [INFO] 0x7f79140014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_809+00:00 [62696] [INFO] 0x7f79180014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:46.304_890+00:00 [62696] [INFO] 0x7f790c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:51.443_850+00:00 [62678] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42246 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:08:52.709_137+00:00 [62678] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:08:52.709_170+00:00 [62678] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:08:52.709_178+00:00 [62678] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:08:52.709_255+00:00 [62678] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:08:52.709_299+00:00 [62678] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 45659, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:08:52.709_561+00:00 [62678] [INFO] 0x7f7968002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:08:52.709_636+00:00 [62678] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:08:52.709_741+00:00 [62678] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:08:52.869_680+00:00 [62678] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:08:52.869_691+00:00 [62678] [INFO] session 3 got connection from 127.0.0.1:42248 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:08:52.869_769+00:00 [62678] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 45667 / mine 45659, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:08:52.869_776+00:00 [62678] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:08:52.869_944+00:00 [62678] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:08:52.869_962+00:00 [62678] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:08:52.869_972+00:00 [62678] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 45667 / mine 45659, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:08:52.869_985+00:00 [62678] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:08:52.870_153+00:00 [62678] [WARN] [LOG XX] req log idx: 45667, req log term: 1, my last log idx: 45659, my log (45667) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:08:52.870_158+00:00 [62678] [WARN] deny, req term 2, my term 2, req log idx 45667, my log idx 45659	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:08:52.870_350+00:00 [62678] [INFO] receive a config change from leader at 45668	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:08:52.870_549+00:00 [62707] [INFO] config at index 45668 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:08:52.870_567+00:00 [62707] [INFO] new config log idx 45668, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:08:52.870_580+00:00 [62707] [INFO] new configuration: log idx 45668, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:09:31.369_654+00:00 [63144] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:09:31.371_036+00:00 [63144] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:09:31.371_066+00:00 [63144] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:09:31.371_074+00:00 [63144] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:09:31.371_099+00:00 [63144] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:09:31.371_103+00:00 [63144] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:09:31.371_106+00:00 [63144] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:09:31.371_138+00:00 [63144] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:09:31.371_299+00:00 [63181] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:09:33.254_337+00:00 [63152] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:09:33.254_348+00:00 [63152] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:09:33.254_363+00:00 [63152] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:09:33.254_373+00:00 [63152] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:09:33.254_379+00:00 [63152] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:09:33.254_382+00:00 [63152] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:09:33.254_400+00:00 [63152] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:09:33.254_451+00:00 [63180] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:09:33.254_459+00:00 [63180] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:09:33.254_469+00:00 [63180] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:09:43.684_555+00:00 [63152] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:09:43.684_575+00:00 [63152] [INFO] session 1 got connection from 127.0.0.1:42250 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:09:43.684_676+00:00 [63152] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:09:43.684_701+00:00 [63152] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:09:43.684_759+00:00 [63152] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:09:43.684_793+00:00 [63152] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:09:43.684_796+00:00 [63152] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:09:43.684_798+00:00 [63152] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:09:43.684_807+00:00 [63152] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:09:43.685_688+00:00 [63152] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42250 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:09:44.185_983+00:00 [63152] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:09:44.185_999+00:00 [63152] [INFO] session 2 got connection from 127.0.0.1:42254 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:09:44.186_099+00:00 [63152] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:09:44.186_103+00:00 [63152] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:09:44.186_266+00:00 [63152] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:09:44.186_270+00:00 [63152] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:09:44.186_340+00:00 [63180] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:09:44.186_343+00:00 [63180] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:09:44.186_351+00:00 [63180] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:09:44.186_353+00:00 [63180] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:09:44.186_360+00:00 [63180] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:09:44.186_374+00:00 [63180] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:09:44.186_379+00:00 [63180] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:09:44.186_398+00:00 [63180] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:10:03.429_378+00:00 [63171] [INFO] 0x7f4f98001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.429_512+00:00 [63171] [INFO] 0x7f4f900014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.429_601+00:00 [63171] [INFO] 0x7f4f940014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.429_693+00:00 [63171] [INFO] 0x7f4f880014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.429_779+00:00 [63171] [INFO] 0x7f4f8c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.429_976+00:00 [63171] [INFO] 0x7f4f800014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.430_068+00:00 [63171] [INFO] 0x7f4f840014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.430_148+00:00 [63171] [INFO] 0x7f4f780014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.430_231+00:00 [63171] [INFO] 0x7f4f7c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:03.430_309+00:00 [63171] [INFO] 0x7f4f700014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:08.532_101+00:00 [63159] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42254 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:10:09.579_519+00:00 [63162] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:10:09.579_553+00:00 [63162] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:10:09.579_561+00:00 [63162] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:10:09.579_636+00:00 [63162] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:10:09.579_681+00:00 [63162] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 44630, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:10:09.579_952+00:00 [63162] [INFO] 0x7f4f5056a4a0 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:10:09.580_028+00:00 [63162] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:10:09.580_141+00:00 [63162] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:10:09.918_645+00:00 [63162] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:10:09.918_657+00:00 [63162] [INFO] session 3 got connection from 127.0.0.1:42258 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:10:09.918_753+00:00 [63162] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 44637 / mine 44630, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:10:09.918_761+00:00 [63162] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:10:09.918_946+00:00 [63162] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:10:09.918_965+00:00 [63162] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:10:09.918_976+00:00 [63162] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 44637 / mine 44630, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:10:09.918_989+00:00 [63162] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:10:09.919_184+00:00 [63162] [WARN] [LOG XX] req log idx: 44637, req log term: 1, my last log idx: 44630, my log (44637) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:10:09.919_188+00:00 [63162] [WARN] deny, req term 2, my term 2, req log idx 44637, my log idx 44630	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:10:09.919_413+00:00 [63162] [INFO] receive a config change from leader at 44638	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:10:09.919_680+00:00 [63180] [INFO] config at index 44638 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:10:09.919_701+00:00 [63180] [INFO] new config log idx 44638, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:10:09.919_716+00:00 [63180] [INFO] new configuration: log idx 44638, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:10:48.497_263+00:00 [63601] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:10:48.498_620+00:00 [63601] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:10:48.498_651+00:00 [63601] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:10:48.498_655+00:00 [63601] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:10:48.498_694+00:00 [63601] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:10:48.498_698+00:00 [63601] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:10:48.498_700+00:00 [63601] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:10:48.498_734+00:00 [63601] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:10:48.498_890+00:00 [63638] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:10:50.176_934+00:00 [63609] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:10:50.176_949+00:00 [63609] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:10:50.176_968+00:00 [63609] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:10:50.176_986+00:00 [63609] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:10:50.176_993+00:00 [63609] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:10:50.176_997+00:00 [63609] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:10:50.177_016+00:00 [63609] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:10:50.177_074+00:00 [63637] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:10:50.177_082+00:00 [63637] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:10:50.177_092+00:00 [63637] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:11:00.061_759+00:00 [63609] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:11:00.061_780+00:00 [63609] [INFO] session 1 got connection from 127.0.0.1:42260 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:11:00.061_882+00:00 [63609] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:11:00.061_908+00:00 [63609] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:11:00.061_969+00:00 [63609] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:11:00.062_003+00:00 [63609] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:11:00.062_006+00:00 [63609] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:11:00.062_008+00:00 [63609] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:11:00.062_016+00:00 [63609] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:11:00.062_836+00:00 [63609] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42260 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:11:00.563_078+00:00 [63609] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:11:00.563_094+00:00 [63609] [INFO] session 2 got connection from 127.0.0.1:42262 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:11:00.563_211+00:00 [63609] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:11:00.563_216+00:00 [63609] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:11:00.563_379+00:00 [63609] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:11:00.563_384+00:00 [63609] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:11:00.563_450+00:00 [63637] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:11:00.563_454+00:00 [63637] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:11:00.563_463+00:00 [63637] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:11:00.563_465+00:00 [63637] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:11:00.563_472+00:00 [63637] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:11:00.563_486+00:00 [63637] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:11:00.563_490+00:00 [63637] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:11:00.563_510+00:00 [63637] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:11:20.304_868+00:00 [63628] [INFO] 0x7f3528001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.304_986+00:00 [63628] [INFO] 0x7f35200014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_084+00:00 [63626] [INFO] 0x7f35240014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_178+00:00 [63626] [INFO] 0x7f35180014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_265+00:00 [63626] [INFO] 0x7f351c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_350+00:00 [63626] [INFO] 0x7f35100014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_552+00:00 [63626] [INFO] 0x7f35140014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_636+00:00 [63626] [INFO] 0x7f35080014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_716+00:00 [63626] [INFO] 0x7f350c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:20.305_795+00:00 [63626] [INFO] 0x7f35000014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:25.650_921+00:00 [63624] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42262 due to error 104, Connection reset by peer, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:11:27.015_317+00:00 [63624] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:11:27.015_331+00:00 [63624] [INFO] session 3 got connection from 127.0.0.1:42264 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:11:27.015_425+00:00 [63624] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 45708 / mine 45713, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:11:27.015_432+00:00 [63624] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:11:27.145_500+00:00 [63624] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:11:27.145_527+00:00 [63624] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:11:27.145_535+00:00 [63624] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:11:27.145_596+00:00 [63624] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:11:27.145_631+00:00 [63624] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 45713, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:11:27.145_838+00:00 [63624] [INFO] 0x7f3518002d10 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:11:27.145_900+00:00 [63624] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:27.146_008+00:00 [63624] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:11:27.146_011+00:00 [63624] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:11:27.146_013+00:00 [63624] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:11:27.146_024+00:00 [63624] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 45713, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:11:27.146_173+00:00 [63607] [INFO] [VOTE RESP] peer 2 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:11:27.146_178+00:00 [63607] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-29T06:11:27.146_191+00:00 [63607] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:11:27.146_194+00:00 [63607] [INFO] state machine commit index 45708, precommit index 45713, last log index 45713	[raft_server.cxx:953, become_leader()]
2022-04-29T06:11:27.146_241+00:00 [63607] [INFO] [BECOME LEADER] appended new config at 45714	[raft_server.cxx:993, become_leader()]
2022-04-29T06:11:27.146_304+00:00 [63607] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-29T06:11:27.146_369+00:00 [63607] [WARN] declined append: peer 2, prev next log idx 45714, resp next 45709, new next log idx 45709	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-29T06:11:27.146_771+00:00 [63637] [INFO] config at index 45714 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:11:27.146_783+00:00 [63637] [INFO] new config log idx 45714, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:11:27.146_791+00:00 [63637] [INFO] new configuration: log idx 45714, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:11:27.146_893+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:27.646_744+00:00 [63635] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:28.197_115+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:28.797_026+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:29.447_186+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:30.147_847+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:30.897_999+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:31.647_952+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:32.398_068+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:33.148_271+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:33.898_849+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:34.648_685+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:35.398_857+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:36.149_369+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:36.899_671+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:37.649_598+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:38.399_730+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:39.149_928+00:00 [63627] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:11:39.900_069+00:00 [63627] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-29T06:13:46.751_083+00:00 [64458] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:13:46.752_452+00:00 [64458] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:13:46.752_490+00:00 [64458] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:13:46.752_494+00:00 [64458] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:13:46.752_522+00:00 [64458] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:13:46.752_526+00:00 [64458] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:13:46.752_529+00:00 [64458] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:13:46.752_561+00:00 [64458] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:13:46.752_710+00:00 [64495] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:13:48.521_727+00:00 [64466] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:13:48.521_737+00:00 [64466] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:13:48.521_752+00:00 [64466] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:13:48.521_762+00:00 [64466] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:13:48.521_769+00:00 [64466] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:13:48.521_773+00:00 [64466] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:13:48.521_791+00:00 [64466] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:13:48.521_838+00:00 [64494] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:13:48.521_845+00:00 [64494] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:13:48.521_855+00:00 [64494] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:13:58.565_756+00:00 [64466] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:13:58.565_779+00:00 [64466] [INFO] session 1 got connection from 127.0.0.1:42268 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:13:58.565_884+00:00 [64466] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:13:58.565_908+00:00 [64466] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:13:58.565_970+00:00 [64466] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:13:58.566_003+00:00 [64466] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:13:58.566_006+00:00 [64466] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:13:58.566_008+00:00 [64466] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:13:58.566_016+00:00 [64466] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:13:58.566_770+00:00 [64466] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42268 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:13:59.067_414+00:00 [64466] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:13:59.067_428+00:00 [64466] [INFO] session 2 got connection from 127.0.0.1:42272 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:13:59.067_522+00:00 [64466] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:13:59.067_525+00:00 [64466] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:13:59.067_674+00:00 [64466] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:13:59.067_678+00:00 [64466] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:13:59.067_745+00:00 [64494] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:13:59.067_749+00:00 [64494] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:13:59.067_757+00:00 [64494] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:13:59.067_761+00:00 [64494] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:13:59.067_768+00:00 [64494] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:13:59.067_781+00:00 [64494] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:13:59.067_786+00:00 [64494] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:13:59.067_804+00:00 [64494] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:14:18.557_784+00:00 [64481] [INFO] 0x7fb728001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:14:18.557_913+00:00 [64481] [INFO] 0x7fb72c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:14:23.635_655+00:00 [64472] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42272 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:14:25.050_320+00:00 [64472] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:14:25.050_382+00:00 [64472] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:14:25.050_401+00:00 [64472] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:14:25.050_579+00:00 [64472] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:14:25.050_748+00:00 [64472] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22991, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:14:25.051_132+00:00 [64472] [INFO] 0x7fb758002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:14:25.051_203+00:00 [64472] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:14:25.051_309+00:00 [64472] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:14:25.278_948+00:00 [64472] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:14:25.278_962+00:00 [64472] [INFO] session 3 got connection from 127.0.0.1:42274 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:14:25.279_047+00:00 [64472] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22991 / mine 22991, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:14:25.279_055+00:00 [64472] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:14:25.279_254+00:00 [64472] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:14:25.279_276+00:00 [64472] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:14:25.279_289+00:00 [64472] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22991 / mine 22991, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:14:25.279_309+00:00 [64472] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:14:25.279_516+00:00 [64472] [INFO] receive a config change from leader at 22992	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:14:25.279_723+00:00 [64494] [INFO] config at index 22992 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:14:25.279_746+00:00 [64494] [INFO] new config log idx 22992, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:14:25.279_763+00:00 [64494] [INFO] new configuration: log idx 22992, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:15:03.620_932+00:00 [64879] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:15:03.622_291+00:00 [64879] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:15:03.622_320+00:00 [64879] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:15:03.622_326+00:00 [64879] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:15:03.622_347+00:00 [64879] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:15:03.622_351+00:00 [64879] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:15:03.622_354+00:00 [64879] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:15:03.622_389+00:00 [64879] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:15:03.622_532+00:00 [64916] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:15:05.444_576+00:00 [64887] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:15:05.444_587+00:00 [64887] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:15:05.444_602+00:00 [64887] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:15:05.444_612+00:00 [64887] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:15:05.444_618+00:00 [64887] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:15:05.444_622+00:00 [64887] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:15:05.444_640+00:00 [64887] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:15:05.444_692+00:00 [64915] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:15:05.444_699+00:00 [64915] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:15:05.444_708+00:00 [64915] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:15:15.179_495+00:00 [64887] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:15:15.179_522+00:00 [64887] [INFO] session 1 got connection from 127.0.0.1:42278 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:15:15.179_626+00:00 [64887] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:15:15.179_653+00:00 [64887] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:15:15.179_715+00:00 [64887] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:15:15.179_750+00:00 [64887] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:15:15.179_752+00:00 [64887] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:15:15.179_754+00:00 [64887] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:15:15.179_763+00:00 [64887] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:15:15.180_487+00:00 [64887] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42278 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:15:15.680_758+00:00 [64887] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:15:15.680_775+00:00 [64887] [INFO] session 2 got connection from 127.0.0.1:42280 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:15:15.680_903+00:00 [64887] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:15:15.680_909+00:00 [64887] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:15:15.681_056+00:00 [64887] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:15:15.681_060+00:00 [64887] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:15:15.681_128+00:00 [64915] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:15:15.681_131+00:00 [64915] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:15:15.681_140+00:00 [64915] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:15:15.681_142+00:00 [64915] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:15:15.681_149+00:00 [64915] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:15:15.681_163+00:00 [64915] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:15:15.681_168+00:00 [64915] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:15:15.681_187+00:00 [64915] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:15:35.677_530+00:00 [64906] [INFO] 0x7f7254001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:15:35.677_658+00:00 [64906] [INFO] 0x7f72480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:15:35.677_765+00:00 [64905] [INFO] 0x7f72400014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:15:35.677_927+00:00 [64905] [INFO] 0x7f72340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:15:38.867_487+00:00 [64909] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42280 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:15:39.975_489+00:00 [64909] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:15:39.975_518+00:00 [64909] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:15:39.975_526+00:00 [64909] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:15:39.975_596+00:00 [64909] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:15:39.975_634+00:00 [64909] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22998, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:15:39.975_857+00:00 [64909] [INFO] 0x7f7278002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:15:39.975_927+00:00 [64909] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:15:39.976_031+00:00 [64909] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:15:40.310_099+00:00 [64909] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:15:40.310_114+00:00 [64909] [INFO] session 3 got connection from 127.0.0.1:42282 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:15:40.310_202+00:00 [64909] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22998 / mine 22998, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:15:40.310_211+00:00 [64909] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:15:40.310_407+00:00 [64909] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:15:40.310_430+00:00 [64909] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:15:40.310_442+00:00 [64909] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22998 / mine 22998, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:15:40.310_456+00:00 [64909] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:15:40.310_707+00:00 [64912] [INFO] receive a config change from leader at 22999	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:15:40.310_895+00:00 [64915] [INFO] config at index 22999 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:15:40.310_916+00:00 [64915] [INFO] new config log idx 22999, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:15:40.310_930+00:00 [64915] [INFO] new configuration: log idx 22999, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:16:20.730_865+00:00 [65320] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:16:20.732_250+00:00 [65320] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:16:20.732_287+00:00 [65320] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:16:20.732_293+00:00 [65320] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:16:20.732_317+00:00 [65320] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:16:20.732_321+00:00 [65320] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:16:20.732_324+00:00 [65320] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:16:20.732_360+00:00 [65320] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:16:20.732_503+00:00 [65357] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:16:22.780_656+00:00 [65328] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:16:22.780_679+00:00 [65328] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:16:22.780_714+00:00 [65328] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:16:22.780_753+00:00 [65328] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:16:22.780_768+00:00 [65328] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:16:22.780_779+00:00 [65328] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:16:22.780_828+00:00 [65328] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:16:22.780_960+00:00 [65356] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:16:22.780_987+00:00 [65356] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:16:22.781_011+00:00 [65356] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:16:32.545_282+00:00 [65328] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:16:32.545_304+00:00 [65328] [INFO] session 1 got connection from 127.0.0.1:42284 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:16:32.545_413+00:00 [65328] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:16:32.545_439+00:00 [65328] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:16:32.545_499+00:00 [65328] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:16:32.545_533+00:00 [65328] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:16:32.545_535+00:00 [65328] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:16:32.545_538+00:00 [65328] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:16:32.545_546+00:00 [65328] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:16:32.546_265+00:00 [65328] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42284 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:16:33.046_633+00:00 [65328] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:16:33.046_647+00:00 [65328] [INFO] session 2 got connection from 127.0.0.1:42286 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:16:33.046_746+00:00 [65343] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:16:33.046_749+00:00 [65343] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:16:33.046_918+00:00 [65343] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:16:33.046_925+00:00 [65343] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:16:33.046_992+00:00 [65356] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:16:33.046_996+00:00 [65356] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:16:33.047_005+00:00 [65356] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:16:33.047_007+00:00 [65356] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:16:33.047_014+00:00 [65356] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:16:33.047_028+00:00 [65356] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:16:33.047_033+00:00 [65356] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:16:33.047_052+00:00 [65356] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:16:52.787_939+00:00 [65348] [INFO] 0x7f2838001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:52.788_072+00:00 [65348] [INFO] 0x7f28300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:52.788_183+00:00 [65346] [INFO] 0x7f28340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:52.788_400+00:00 [65346] [INFO] 0x7f28280014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:52.788_562+00:00 [65346] [INFO] 0x7f28100014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:52.788_717+00:00 [65346] [INFO] 0x7f28080014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:53.045_343+00:00 [65349] [INFO] 0x7f28280157e0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:55.663_815+00:00 [65326] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42286 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:16:56.873_663+00:00 [65350] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:16:56.873_676+00:00 [65350] [INFO] session 3 got connection from 127.0.0.1:42288 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:16:56.873_785+00:00 [65350] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22722 / mine 22719, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:16:56.873_793+00:00 [65350] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:16:57.051_881+00:00 [65350] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:16:57.051_911+00:00 [65350] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:16:57.051_922+00:00 [65350] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:16:57.052_010+00:00 [65350] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:16:57.052_061+00:00 [65350] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22719, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:16:57.052_338+00:00 [65350] [INFO] 0x7f284414a280 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:16:57.052_405+00:00 [65350] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:16:57.052_484+00:00 [65350] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:16:57.052_488+00:00 [65350] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:16:57.052_490+00:00 [65350] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:16:57.052_505+00:00 [65350] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 22719, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:16:57.052_652+00:00 [65350] [INFO] [VOTE RESP] peer 2 (X), resp term 2, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:16:58.440_902+00:00 [65350] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22722 / mine 22719, term: req 2 / mine 2
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:16:58.440_912+00:00 [65350] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:16:58.441_152+00:00 [65353] [INFO] [BECOME FOLLOWER] term 3	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:16:58.441_175+00:00 [65353] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:16:58.441_190+00:00 [65353] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22722 / mine 22719, term: req 3 / mine 3
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:16:58.441_204+00:00 [65353] [INFO] decision: O (grant), voted_for 2, term 3	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:16:58.441_437+00:00 [65353] [WARN] [LOG XX] req log idx: 22722, req log term: 1, my last log idx: 22719, my log (22722) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:16:58.441_446+00:00 [65353] [WARN] deny, req term 3, my term 3, req log idx 22722, my log idx 22719	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:16:58.441_623+00:00 [65353] [INFO] receive a config change from leader at 22723	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:16:58.441_834+00:00 [65356] [INFO] config at index 22723 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:16:58.441_852+00:00 [65356] [INFO] new config log idx 22723, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:16:58.441_864+00:00 [65356] [INFO] new configuration: log idx 22723, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 3	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:17:37.853_826+00:00 [65771] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:17:37.855_243+00:00 [65771] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:17:37.855_276+00:00 [65771] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:17:37.855_280+00:00 [65771] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:17:37.855_305+00:00 [65771] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:17:37.855_310+00:00 [65771] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:17:37.855_312+00:00 [65771] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:17:37.855_340+00:00 [65771] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:17:37.855_491+00:00 [65808] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:17:39.842_653+00:00 [65779] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:17:39.842_725+00:00 [65779] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:17:39.842_778+00:00 [65779] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:17:39.842_805+00:00 [65779] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:17:39.842_812+00:00 [65779] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:17:39.842_816+00:00 [65779] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:17:39.842_835+00:00 [65779] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:17:39.842_885+00:00 [65807] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:17:39.842_893+00:00 [65807] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:17:39.842_902+00:00 [65807] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:17:50.170_113+00:00 [65779] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:17:50.170_132+00:00 [65779] [INFO] session 1 got connection from 127.0.0.1:42290 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:17:50.170_233+00:00 [65779] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:17:50.170_257+00:00 [65779] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:17:50.170_314+00:00 [65779] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:17:50.170_346+00:00 [65779] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:17:50.170_349+00:00 [65779] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:17:50.170_351+00:00 [65779] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:17:50.170_359+00:00 [65779] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:17:50.171_097+00:00 [65779] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42290 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:17:50.671_774+00:00 [65779] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:17:50.671_789+00:00 [65779] [INFO] session 2 got connection from 127.0.0.1:42292 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:17:50.671_877+00:00 [65779] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:17:50.671_881+00:00 [65779] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:17:50.672_030+00:00 [65779] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:17:50.672_034+00:00 [65779] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:17:50.672_103+00:00 [65807] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:17:50.672_106+00:00 [65807] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:17:50.672_115+00:00 [65807] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:17:50.672_117+00:00 [65807] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:17:50.672_124+00:00 [65807] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:17:50.672_137+00:00 [65807] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:17:50.672_142+00:00 [65807] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:17:50.672_162+00:00 [65807] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:18:09.911_638+00:00 [65798] [INFO] 0x7f9ac8001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.911_767+00:00 [65798] [INFO] 0x7f9ac00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.911_865+00:00 [65798] [INFO] 0x7f9ac40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.911_956+00:00 [65798] [INFO] 0x7f9ab80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.912_122+00:00 [65798] [INFO] 0x7f9abc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.912_255+00:00 [65798] [INFO] 0x7f9ab00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.912_410+00:00 [65798] [INFO] 0x7f9a980014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:09.912_553+00:00 [65798] [INFO] 0x7f9a900014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:12.606_447+00:00 [65787] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42292 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:18:14.079_600+00:00 [65787] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:18:14.079_664+00:00 [65787] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:18:14.079_682+00:00 [65787] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:18:14.079_862+00:00 [65787] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:18:14.079_976+00:00 [65787] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22284, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:18:14.080_364+00:00 [65787] [INFO] 0x7f9af4002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:18:14.080_438+00:00 [65787] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:18:14.080_551+00:00 [65787] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:18:14.425_236+00:00 [65802] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:18:14.425_248+00:00 [65802] [INFO] session 3 got connection from 127.0.0.1:42294 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:18:14.425_355+00:00 [65802] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22290 / mine 22284, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:18:14.425_363+00:00 [65802] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:18:14.425_532+00:00 [65802] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:18:14.425_554+00:00 [65802] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:18:14.425_565+00:00 [65802] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22290 / mine 22284, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:18:14.425_578+00:00 [65802] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:18:14.425_796+00:00 [65802] [WARN] [LOG XX] req log idx: 22290, req log term: 1, my last log idx: 22284, my log (22290) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:18:14.425_805+00:00 [65802] [WARN] deny, req term 2, my term 2, req log idx 22290, my log idx 22284	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:18:14.426_046+00:00 [65802] [INFO] receive a config change from leader at 22291	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:18:14.426_306+00:00 [65807] [INFO] config at index 22291 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:18:14.426_328+00:00 [65807] [INFO] new config log idx 22291, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:18:14.426_343+00:00 [65807] [INFO] new configuration: log idx 22291, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:18:54.975_748+00:00 [66234] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:18:54.977_110+00:00 [66234] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:18:54.977_139+00:00 [66234] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:18:54.977_148+00:00 [66234] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:18:54.977_172+00:00 [66234] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:18:54.977_176+00:00 [66234] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:18:54.977_179+00:00 [66234] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:18:54.977_209+00:00 [66234] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:18:54.977_354+00:00 [66271] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:18:56.603_447+00:00 [66242] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:18:56.603_458+00:00 [66242] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:18:56.603_472+00:00 [66242] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:18:56.603_483+00:00 [66242] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:18:56.603_489+00:00 [66242] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:18:56.603_492+00:00 [66242] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:18:56.603_510+00:00 [66242] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:18:56.603_559+00:00 [66270] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:18:56.603_568+00:00 [66270] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:18:56.603_578+00:00 [66270] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:19:07.040_587+00:00 [66242] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:19:07.040_607+00:00 [66242] [INFO] session 1 got connection from 127.0.0.1:42298 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:19:07.040_704+00:00 [66242] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:19:07.040_730+00:00 [66242] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:19:07.040_791+00:00 [66242] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:19:07.040_825+00:00 [66242] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:19:07.040_828+00:00 [66242] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:19:07.040_831+00:00 [66242] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:19:07.040_838+00:00 [66242] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:19:07.041_546+00:00 [66242] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42298 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:19:07.541_780+00:00 [66242] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:19:07.541_794+00:00 [66242] [INFO] session 2 got connection from 127.0.0.1:42300 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:19:07.541_885+00:00 [66242] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:19:07.541_888+00:00 [66242] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:19:07.542_036+00:00 [66242] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:19:07.542_040+00:00 [66242] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:19:07.542_107+00:00 [66270] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:19:07.542_110+00:00 [66270] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:19:07.542_119+00:00 [66270] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:19:07.542_121+00:00 [66270] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:19:07.542_128+00:00 [66270] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:19:07.542_141+00:00 [66270] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:19:07.542_146+00:00 [66270] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:19:07.542_165+00:00 [66270] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:19:26.783_815+00:00 [66261] [INFO] 0x7faff4001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.783_943+00:00 [66261] [INFO] 0x7fafec0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_043+00:00 [66261] [INFO] 0x7faff00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_133+00:00 [66261] [INFO] 0x7fafe40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_226+00:00 [66261] [INFO] 0x7fafe80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_438+00:00 [66261] [INFO] 0x7fafdc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_531+00:00 [66261] [INFO] 0x7fafe00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_623+00:00 [66261] [INFO] 0x7fafd40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_778+00:00 [66239] [INFO] 0x7fafb80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:26.784_930+00:00 [66239] [INFO] 0x7fafac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:29.337_015+00:00 [66269] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42300 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:19:31.177_341+00:00 [66269] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:19:31.177_355+00:00 [66269] [INFO] session 3 got connection from 127.0.0.1:42302 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:19:31.177_466+00:00 [66269] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22316 / mine 22308, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:19:31.177_475+00:00 [66269] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:19:31.261_544+00:00 [66269] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:19:31.261_565+00:00 [66269] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:19:31.261_572+00:00 [66269] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:19:31.261_638+00:00 [66269] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:19:31.261_678+00:00 [66269] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22308, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:19:31.261_915+00:00 [66269] [INFO] 0x7fb014129760 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:19:31.261_982+00:00 [66269] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:19:31.262_081+00:00 [66240] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:19:31.262_086+00:00 [66240] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:19:31.262_088+00:00 [66240] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:19:31.262_098+00:00 [66240] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 22308, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:19:31.262_251+00:00 [66245] [INFO] [VOTE RESP] peer 2 (X), resp term 2, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:19:33.110_275+00:00 [66245] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:19:33.110_286+00:00 [66245] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:19:33.110_314+00:00 [66245] [INFO] [ELECTION TIMEOUT] current role: candidate, log last term 1, state term 2, target p 40, my p 50, hb dead, pre-vote done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:19:33.110_316+00:00 [66245] [INFO] pre-vote term (1) is different, reset it to 2	[handle_timeout.cxx:308, handle_election_timeout()]
2022-04-29T06:19:33.110_326+00:00 [66245] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:19:33.110_401+00:00 [66245] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 2, log idx 22308, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:19:33.110_745+00:00 [66245] [INFO] [PRE-VOTE RESP] peer 2 (O), term 2, resp term 2, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:19:33.110_749+00:00 [66245] [INFO] [PRE-VOTE DONE] SUCCESS, term 2	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:19:33.110_751+00:00 [66245] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:19:33.110_761+00:00 [66245] [INFO] [VOTE INIT] my id 3, my role candidate, term 3, log idx 22308, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:19:33.110_800+00:00 [66245] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-29T06:19:33.110_851+00:00 [66245] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:19:33.110_933+00:00 [66245] [INFO] [VOTE RESP] peer 2 (X), resp term 3, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:19:34.511_863+00:00 [66245] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:19:34.511_873+00:00 [66245] [INFO] [PRIORITY] decay, target 40 -> 30, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:19:34.511_898+00:00 [66245] [INFO] [ELECTION TIMEOUT] current role: candidate, log last term 1, state term 3, target p 30, my p 50, hb dead, pre-vote done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:19:34.511_901+00:00 [66245] [INFO] pre-vote term (2) is different, reset it to 3	[handle_timeout.cxx:308, handle_election_timeout()]
2022-04-29T06:19:34.511_910+00:00 [66245] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:19:34.511_950+00:00 [66245] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 3, log idx 22308, log term 1, priority (target 30 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:19:34.512_253+00:00 [66245] [INFO] [PRE-VOTE RESP] peer 2 (O), term 3, resp term 3, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:19:34.512_257+00:00 [66245] [INFO] [PRE-VOTE DONE] SUCCESS, term 3	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:19:34.512_258+00:00 [66245] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:19:34.512_269+00:00 [66245] [INFO] [VOTE INIT] my id 3, my role candidate, term 4, log idx 22308, log term 1, priority (target 30 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:19:34.512_305+00:00 [66245] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-29T06:19:34.512_373+00:00 [66245] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:19:34.512_482+00:00 [66241] [INFO] [VOTE RESP] peer 2 (X), resp term 4, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:19:35.916_959+00:00 [66251] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22316 / mine 22308, term: req 4 / mine 4
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:19:35.916_969+00:00 [66251] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:19:35.917_203+00:00 [66251] [INFO] [BECOME FOLLOWER] term 5	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:19:35.917_225+00:00 [66251] [INFO] [PRIORITY] decay, target 30 -> 20, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:19:35.917_238+00:00 [66251] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22316 / mine 22308, term: req 5 / mine 5
priority: target 20 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:19:35.917_252+00:00 [66251] [INFO] decision: O (grant), voted_for 2, term 5	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:19:35.917_527+00:00 [66251] [WARN] [LOG XX] req log idx: 22316, req log term: 1, my last log idx: 22308, my log (22316) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:19:35.917_538+00:00 [66251] [WARN] deny, req term 5, my term 5, req log idx 22316, my log idx 22308	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:19:35.917_804+00:00 [66251] [INFO] receive a config change from leader at 22317	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:19:35.918_003+00:00 [66270] [INFO] config at index 22317 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:19:35.918_022+00:00 [66270] [INFO] new config log idx 22317, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:19:35.918_035+00:00 [66270] [INFO] new configuration: log idx 22317, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 5	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:20:11.838_402+00:00 [66684] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:20:11.839_799+00:00 [66684] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:20:11.839_837+00:00 [66684] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:20:11.839_841+00:00 [66684] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:20:11.839_864+00:00 [66684] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:20:11.839_868+00:00 [66684] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:20:11.839_871+00:00 [66684] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:20:11.839_902+00:00 [66684] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:20:11.840_046+00:00 [66721] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:20:12.918_230+00:00 [66692] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:20:12.918_253+00:00 [66692] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:20:12.918_289+00:00 [66692] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:20:12.918_314+00:00 [66692] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:20:12.918_330+00:00 [66692] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:20:12.918_340+00:00 [66692] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:20:12.918_388+00:00 [66692] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:20:12.918_518+00:00 [66720] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:20:12.918_543+00:00 [66720] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:20:12.918_569+00:00 [66720] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:20:23.903_764+00:00 [66692] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:20:23.903_789+00:00 [66692] [INFO] session 1 got connection from 127.0.0.1:42304 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:20:23.903_914+00:00 [66692] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:20:23.903_941+00:00 [66692] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:20:23.904_009+00:00 [66692] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:20:23.904_043+00:00 [66692] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:20:23.904_046+00:00 [66692] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:20:23.904_048+00:00 [66692] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:20:23.904_056+00:00 [66692] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:20:23.904_766+00:00 [66692] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42304 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:20:24.405_035+00:00 [66692] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:20:24.405_049+00:00 [66692] [INFO] session 2 got connection from 127.0.0.1:42306 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:20:24.405_146+00:00 [66692] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:20:24.405_149+00:00 [66692] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:20:24.405_296+00:00 [66692] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:20:24.405_301+00:00 [66692] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:20:24.405_369+00:00 [66720] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:20:24.405_372+00:00 [66720] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:20:24.405_381+00:00 [66720] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:20:24.405_383+00:00 [66720] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:20:24.405_390+00:00 [66720] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:20:24.405_404+00:00 [66720] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:20:24.405_408+00:00 [66720] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:20:24.405_427+00:00 [66720] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:20:43.146_603+00:00 [66711] [INFO] 0x7fea50001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.146_758+00:00 [66711] [INFO] 0x7fea480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.146_860+00:00 [66711] [INFO] 0x7fea4c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.146_955+00:00 [66711] [INFO] 0x7fea400014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_049+00:00 [66711] [INFO] 0x7fea440014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_155+00:00 [66711] [INFO] 0x7fea380014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_350+00:00 [66711] [INFO] 0x7fea3c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_445+00:00 [66711] [INFO] 0x7fea300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_536+00:00 [66711] [INFO] 0x7fea340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:43.147_629+00:00 [66709] [INFO] 0x7fea280014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:45.639_720+00:00 [66704] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42306 due to error 104, Connection reset by peer, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:20:47.186_799+00:00 [66704] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:20:47.186_813+00:00 [66704] [INFO] session 3 got connection from 127.0.0.1:42308 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:20:47.186_940+00:00 [66704] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22385 / mine 22388, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:20:47.186_948+00:00 [66704] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:20:47.620_316+00:00 [66704] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:20:47.620_345+00:00 [66704] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:20:47.620_353+00:00 [66704] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:20:47.620_436+00:00 [66704] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:20:47.620_481+00:00 [66704] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22388, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:20:47.620_757+00:00 [66704] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:47.620_802+00:00 [66704] [INFO] 0x7fea3410f980 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:20:47.620_933+00:00 [66704] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:20:47.620_938+00:00 [66704] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:20:47.620_940+00:00 [66704] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:20:47.620_954+00:00 [66704] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 22388, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:20:47.621_107+00:00 [66704] [INFO] [VOTE RESP] peer 2 (O), resp term 2, my role candidate, granted 2, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:20:47.621_111+00:00 [66704] [INFO] Server is elected as leader for term 2	[handle_vote.cxx:383, handle_vote_resp()]
2022-04-29T06:20:47.621_118+00:00 [66704] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:20:47.621_123+00:00 [66704] [INFO] state machine commit index 22383, precommit index 22388, last log index 22388	[raft_server.cxx:953, become_leader()]
2022-04-29T06:20:47.621_176+00:00 [66704] [INFO] [BECOME LEADER] appended new config at 22389	[raft_server.cxx:993, become_leader()]
2022-04-29T06:20:47.621_249+00:00 [66704] [INFO]   === LEADER (term 2) ===	[handle_vote.cxx:386, handle_vote_resp()]
2022-04-29T06:20:47.621_325+00:00 [66704] [WARN] declined append: peer 2, prev next log idx 22389, resp next 22386, new next log idx 22386	[handle_append_entries.cxx:946, handle_append_entries_resp()]
2022-04-29T06:20:47.621_636+00:00 [66720] [INFO] config at index 22389 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:20:47.621_652+00:00 [66720] [INFO] new config log idx 22389, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:20:47.621_664+00:00 [66720] [INFO] new configuration: log idx 22389, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:20:47.621_804+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:48.121_641+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:48.671_667+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:49.271_801+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:49.921_947+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:50.622_096+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:51.372_243+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:52.122_424+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:52.872_901+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:53.622_878+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:54.373_018+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:55.123_525+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:55.873_797+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:56.623_741+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:57.373_887+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:58.124_086+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:58.874_449+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:20:59.624_462+00:00 [66708] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:21:00.374_674+00:00 [66708] [WARN] too verbose RPC error on peer (1), will suppress it from now	[raft_server.cxx:756, handle_peer_resp()]
2022-04-29T06:21:28.211_324+00:00 [67129] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:21:28.212_671+00:00 [67129] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:21:28.212_706+00:00 [67129] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:21:28.212_712+00:00 [67129] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:21:28.212_739+00:00 [67129] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:21:28.212_743+00:00 [67129] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:21:28.212_746+00:00 [67129] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:21:28.212_781+00:00 [67129] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:21:28.212_928+00:00 [67166] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:21:30.159_975+00:00 [67137] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:21:30.159_986+00:00 [67137] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:21:30.160_001+00:00 [67137] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:21:30.160_012+00:00 [67137] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:21:30.160_019+00:00 [67137] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:21:30.160_023+00:00 [67137] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:21:30.160_042+00:00 [67137] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:21:30.160_094+00:00 [67165] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:21:30.160_101+00:00 [67165] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:21:30.160_111+00:00 [67165] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:21:40.275_886+00:00 [67137] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:21:40.275_906+00:00 [67137] [INFO] session 1 got connection from 127.0.0.1:42310 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:21:40.276_003+00:00 [67137] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:21:40.276_028+00:00 [67137] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:21:40.276_094+00:00 [67137] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:21:40.276_127+00:00 [67137] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:21:40.276_131+00:00 [67137] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:21:40.276_133+00:00 [67137] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:21:40.276_142+00:00 [67137] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:21:40.276_923+00:00 [67137] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42310 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:21:40.777_132+00:00 [67137] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:21:40.777_145+00:00 [67137] [INFO] session 2 got connection from 127.0.0.1:42312 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:21:40.777_225+00:00 [67137] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:21:40.777_228+00:00 [67137] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:21:40.777_378+00:00 [67137] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:21:40.777_382+00:00 [67137] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:21:40.777_440+00:00 [67165] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:21:40.777_443+00:00 [67165] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:21:40.777_451+00:00 [67165] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:21:40.777_452+00:00 [67165] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:21:40.777_458+00:00 [67165] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:21:40.777_470+00:00 [67165] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:21:40.777_474+00:00 [67165] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:21:40.777_491+00:00 [67165] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:22:00.268_864+00:00 [67157] [INFO] 0x7f9638001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.268_998+00:00 [67157] [INFO] 0x7f96300014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_100+00:00 [67157] [INFO] 0x7f96340014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_341+00:00 [67157] [INFO] 0x7f96280014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_493+00:00 [67157] [INFO] 0x7f962c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_666+00:00 [67157] [INFO] 0x7f96200014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_776+00:00 [67157] [INFO] 0x7f96240014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_900+00:00 [67157] [INFO] 0x7f96180014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.269_994+00:00 [67133] [INFO] 0x7f961c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:00.270_090+00:00 [67133] [INFO] 0x7f96100014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:02.719_363+00:00 [67163] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42312 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:22:04.179_703+00:00 [67163] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:22:04.179_736+00:00 [67163] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:22:04.179_744+00:00 [67163] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:22:04.179_822+00:00 [67163] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:22:04.179_864+00:00 [67163] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22337, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:22:04.180_134+00:00 [67163] [INFO] 0x7f9664002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:22:04.180_209+00:00 [67163] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:22:04.180_327+00:00 [67163] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:22:04.300_241+00:00 [67163] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:22:04.300_254+00:00 [67163] [INFO] session 3 got connection from 127.0.0.1:42314 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:22:04.300_333+00:00 [67163] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22339 / mine 22337, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:22:04.300_340+00:00 [67163] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:22:04.300_545+00:00 [67163] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:22:04.300_567+00:00 [67163] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:22:04.300_580+00:00 [67163] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22339 / mine 22337, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:22:04.300_594+00:00 [67163] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:22:04.300_798+00:00 [67163] [WARN] [LOG XX] req log idx: 22339, req log term: 1, my last log idx: 22337, my log (22339) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:22:04.300_803+00:00 [67163] [WARN] deny, req term 2, my term 2, req log idx 22339, my log idx 22337	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:22:04.300_960+00:00 [67152] [INFO] receive a config change from leader at 22340	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:22:04.301_134+00:00 [67165] [INFO] config at index 22340 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:22:04.301_153+00:00 [67165] [INFO] new config log idx 22340, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:22:04.301_165+00:00 [67165] [INFO] new configuration: log idx 22340, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:22:45.331_944+00:00 [67589] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:22:45.333_287+00:00 [67589] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:22:45.333_322+00:00 [67589] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:22:45.333_327+00:00 [67589] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:22:45.333_354+00:00 [67589] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:22:45.333_358+00:00 [67589] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:22:45.333_361+00:00 [67589] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:22:45.333_394+00:00 [67589] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:22:45.333_542+00:00 [67626] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:22:46.522_546+00:00 [67597] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:22:46.522_554+00:00 [67597] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:22:46.522_567+00:00 [67597] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:22:46.522_576+00:00 [67597] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:22:46.522_583+00:00 [67597] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:22:46.522_586+00:00 [67597] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:22:46.522_603+00:00 [67597] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:22:46.522_643+00:00 [67625] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:22:46.522_650+00:00 [67625] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:22:46.522_657+00:00 [67625] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:22:57.146_709+00:00 [67597] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:22:57.146_729+00:00 [67597] [INFO] session 1 got connection from 127.0.0.1:42316 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:22:57.146_825+00:00 [67597] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:22:57.146_849+00:00 [67597] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:22:57.146_908+00:00 [67597] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:22:57.146_942+00:00 [67597] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:22:57.146_945+00:00 [67597] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:22:57.146_947+00:00 [67597] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:22:57.146_955+00:00 [67597] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:22:57.147_627+00:00 [67597] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42316 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:22:57.647_957+00:00 [67597] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:22:57.647_972+00:00 [67597] [INFO] session 2 got connection from 127.0.0.1:42318 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:22:57.648_069+00:00 [67597] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:22:57.648_073+00:00 [67597] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:22:57.648_225+00:00 [67597] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:22:57.648_230+00:00 [67597] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:22:57.648_298+00:00 [67625] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:22:57.648_301+00:00 [67625] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:22:57.648_309+00:00 [67625] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:22:57.648_311+00:00 [67625] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:22:57.648_319+00:00 [67625] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:22:57.648_332+00:00 [67625] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:22:57.648_337+00:00 [67625] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:22:57.648_356+00:00 [67625] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:23:16.639_208+00:00 [67615] [INFO] 0x7f5bd4001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_336+00:00 [67615] [INFO] 0x7f5bcc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_439+00:00 [67615] [INFO] 0x7f5bd00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_637+00:00 [67615] [INFO] 0x7f5bc40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_729+00:00 [67615] [INFO] 0x7f5bc80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_817+00:00 [67615] [INFO] 0x7f5bbc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_903+00:00 [67615] [INFO] 0x7f5bc00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.639_986+00:00 [67615] [INFO] 0x7f5bb40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.640_064+00:00 [67615] [INFO] 0x7f5bb80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:16.640_141+00:00 [67615] [INFO] 0x7f5bac0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:19.117_384+00:00 [67609] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42318 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:23:20.832_394+00:00 [67609] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:23:20.832_427+00:00 [67609] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:23:20.832_435+00:00 [67609] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:23:20.832_483+00:00 [67609] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:23:20.832_531+00:00 [67609] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22329, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:23:20.832_783+00:00 [67609] [INFO] 0x7f5c08002b80 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:23:20.832_858+00:00 [67609] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:23:20.832_956+00:00 [67609] [INFO] [PRE-VOTE RESP] peer 2 (X), term 1, resp term 1, my role candidate, dead 1, live 1, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:23:20.901_423+00:00 [67609] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:23:20.901_433+00:00 [67609] [INFO] session 3 got connection from 127.0.0.1:42320 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:23:20.901_495+00:00 [67609] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22331 / mine 22329, term: req 1 / mine 1
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:23:20.901_501+00:00 [67609] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:23:20.901_670+00:00 [67609] [INFO] [BECOME FOLLOWER] term 2	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:23:20.901_687+00:00 [67609] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:23:20.901_696+00:00 [67609] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22331 / mine 22329, term: req 2 / mine 2
priority: target 40 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:23:20.901_707+00:00 [67609] [INFO] decision: O (grant), voted_for 2, term 2	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:23:20.901_884+00:00 [67609] [WARN] [LOG XX] req log idx: 22331, req log term: 1, my last log idx: 22329, my log (22331) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:23:20.901_888+00:00 [67609] [WARN] deny, req term 2, my term 2, req log idx 22331, my log idx 22329	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:23:20.902_037+00:00 [67609] [INFO] receive a config change from leader at 22332	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:23:20.902_217+00:00 [67625] [INFO] config at index 22332 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:23:20.902_235+00:00 [67625] [INFO] new config log idx 22332, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:23:20.902_247+00:00 [67625] [INFO] new configuration: log idx 22332, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 2	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:24:01.692_871+00:00 [68048] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:24:01.694_243+00:00 [68048] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:24:01.694_275+00:00 [68048] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:24:01.694_281+00:00 [68048] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:24:01.694_305+00:00 [68048] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:24:01.694_310+00:00 [68048] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:24:01.694_313+00:00 [68048] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:24:01.694_345+00:00 [68048] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:24:01.694_493+00:00 [68085] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:24:02.953_653+00:00 [68056] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:24:02.953_677+00:00 [68056] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:24:02.953_714+00:00 [68056] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:24:02.953_740+00:00 [68056] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:24:02.953_755+00:00 [68056] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:24:02.953_766+00:00 [68056] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:24:02.953_815+00:00 [68056] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:24:02.953_947+00:00 [68084] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:24:02.953_973+00:00 [68084] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:24:02.954_000+00:00 [68084] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:24:13.252_676+00:00 [68056] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:24:13.252_696+00:00 [68056] [INFO] session 1 got connection from 127.0.0.1:42322 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:24:13.252_792+00:00 [68056] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:24:13.252_816+00:00 [68056] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:24:13.252_876+00:00 [68056] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:24:13.252_910+00:00 [68056] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:24:13.252_913+00:00 [68056] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:24:13.252_915+00:00 [68056] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:24:13.252_923+00:00 [68056] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:24:13.253_632+00:00 [68056] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42322 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:24:13.753_923+00:00 [68056] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:24:13.753_937+00:00 [68056] [INFO] session 2 got connection from 127.0.0.1:42324 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:24:13.754_055+00:00 [68056] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:24:13.754_060+00:00 [68056] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:24:13.754_245+00:00 [68056] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:24:13.754_250+00:00 [68056] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:24:13.754_321+00:00 [68084] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:24:13.754_324+00:00 [68084] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:24:13.754_333+00:00 [68084] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:24:13.754_335+00:00 [68084] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:24:13.754_342+00:00 [68084] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:24:13.754_355+00:00 [68084] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:24:13.754_360+00:00 [68084] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:24:13.754_379+00:00 [68084] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:24:33.000_675+00:00 [68074] [INFO] 0x7faa64001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.000_805+00:00 [68074] [INFO] 0x7faa5c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.000_898+00:00 [68074] [INFO] 0x7faa600014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.000_986+00:00 [68074] [INFO] 0x7faa540014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_079+00:00 [68052] [INFO] 0x7faa580014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_289+00:00 [68052] [INFO] 0x7faa4c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_375+00:00 [68052] [INFO] 0x7faa500014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_455+00:00 [68052] [INFO] 0x7faa440014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_536+00:00 [68052] [INFO] 0x7faa480014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:33.001_616+00:00 [68052] [INFO] 0x7faa3c0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:35.543_727+00:00 [68066] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42324 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:24:37.247_799+00:00 [68066] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:24:37.247_811+00:00 [68066] [INFO] session 3 got connection from 127.0.0.1:42326 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:24:37.247_903+00:00 [68066] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22313 / mine 22305, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:24:37.247_911+00:00 [68066] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:24:37.476_196+00:00 [68066] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:24:37.476_223+00:00 [68066] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:24:37.476_232+00:00 [68066] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:24:37.476_313+00:00 [68066] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:24:37.476_354+00:00 [68066] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22305, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:24:37.476_603+00:00 [68066] [INFO] 0x7faa5417c450 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:24:37.476_677+00:00 [68066] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:24:37.476_762+00:00 [68066] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:24:37.476_766+00:00 [68066] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:24:37.476_769+00:00 [68066] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:24:37.476_783+00:00 [68066] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 22305, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:24:37.476_934+00:00 [68066] [INFO] [VOTE RESP] peer 2 (X), resp term 2, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:24:39.077_956+00:00 [68053] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:24:39.077_966+00:00 [68053] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:24:39.077_990+00:00 [68053] [INFO] [ELECTION TIMEOUT] current role: candidate, log last term 1, state term 2, target p 40, my p 50, hb dead, pre-vote done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:24:39.077_992+00:00 [68053] [INFO] pre-vote term (1) is different, reset it to 2	[handle_timeout.cxx:308, handle_election_timeout()]
2022-04-29T06:24:39.078_001+00:00 [68053] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:24:39.078_071+00:00 [68053] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 2, log idx 22305, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:24:39.078_352+00:00 [68053] [INFO] [PRE-VOTE RESP] peer 2 (O), term 2, resp term 2, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:24:39.078_365+00:00 [68053] [INFO] [PRE-VOTE DONE] SUCCESS, term 2	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:24:39.078_367+00:00 [68053] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:24:39.078_377+00:00 [68053] [INFO] [VOTE INIT] my id 3, my role candidate, term 3, log idx 22305, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:24:39.078_416+00:00 [68053] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-29T06:24:39.078_468+00:00 [68053] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:24:39.078_556+00:00 [68053] [INFO] [VOTE RESP] peer 2 (X), resp term 3, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:24:40.221_712+00:00 [68053] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22313 / mine 22305, term: req 3 / mine 3
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:24:40.221_720+00:00 [68053] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:24:40.221_944+00:00 [68053] [INFO] [BECOME FOLLOWER] term 4	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:24:40.221_967+00:00 [68053] [INFO] [PRIORITY] decay, target 40 -> 30, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:24:40.221_980+00:00 [68053] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22313 / mine 22305, term: req 4 / mine 4
priority: target 30 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:24:40.221_994+00:00 [68053] [INFO] decision: O (grant), voted_for 2, term 4	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:24:40.222_229+00:00 [68064] [WARN] [LOG XX] req log idx: 22313, req log term: 1, my last log idx: 22305, my log (22313) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:24:40.222_236+00:00 [68064] [WARN] deny, req term 4, my term 4, req log idx 22313, my log idx 22305	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:24:40.222_497+00:00 [68064] [INFO] receive a config change from leader at 22314	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:24:40.222_747+00:00 [68084] [INFO] config at index 22314 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:24:40.222_764+00:00 [68084] [INFO] new config log idx 22314, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:24:40.222_776+00:00 [68084] [INFO] new configuration: log idx 22314, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 4	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:25:18.067_252+00:00 [68584] [====] Start logger: ./srv3.log (32 MB per file, up to 10 files)	[logger.cc:979, start()]
2022-04-29T06:25:18.069_062+00:00 [68584] [INFO] Raft ASIO listener initiated, UNSECURED	[asio_service.cxx:749, asio_rpc_listener()]
2022-04-29T06:25:18.069_121+00:00 [68584] [INFO] parameters: timeout 1000 - 2000, heartbeat 500, leadership expiry 10000, max batch 100, backoff 50, snapshot distance 100000, log sync stop gap 99999, reserved logs 10000000, client timeout 4000, auto forwarding ON, API call type BLOCKING, custom commit quorum size 0, custom election quorum size 0, snapshot receiver INCLUDED, leadership transfer wait time 0, grace period of lagging state machine 0, snapshot IO: BLOCKING, parallel log appending: OFF	[raft_server.cxx:352, apply_and_log_current_params()]
2022-04-29T06:25:18.069_127+00:00 [68584] [INFO] new timeout range: 1000 -- 2000	[raft_server.cxx:326, update_rand_timeout()]
2022-04-29T06:25:18.069_156+00:00 [68584] [INFO]    === INIT RAFT SERVER ===
commit index 0
term 0
election timer allowed
log store start 1, end 0
config log idx 0, prev log idx 0	[raft_server.cxx:149, raft_server()]
2022-04-29T06:25:18.069_161+00:00 [68584] [INFO] peer 3: DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, voting_member
num peers: 0	[raft_server.cxx:242, raft_server()]
2022-04-29T06:25:18.069_166+00:00 [68584] [INFO] global manager does not exist. will use local thread for commit and append	[raft_server.cxx:260, start_server()]
2022-04-29T06:25:18.069_204+00:00 [68584] [INFO] wait for HB, for 50 + [1000, 2000] ms	[raft_server.cxx:285, start_server()]
2022-04-29T06:25:18.069_390+00:00 [68621] [INFO] bg append_entries thread initiated	[handle_append_entries.cxx:49, append_entries_in_bg()]
2022-04-29T06:25:19.544_443+00:00 [68592] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:25:19.544_454+00:00 [68592] [INFO] [PRIORITY] decay, target 1 -> 1, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:25:19.544_470+00:00 [68592] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 0, state term 0, target p 1, my p 50, hb dead, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:25:19.544_486+00:00 [68592] [INFO] [VOTE INIT] my id 3, my role candidate, term 1, log idx 0, log term 0, priority (target 1 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:25:19.544_493+00:00 [68592] [INFO] number of pending commit elements: 0	[raft_server.cxx:940, become_leader()]
2022-04-29T06:25:19.544_497+00:00 [68592] [INFO] state machine commit index 0, precommit index 0, last log index 0	[raft_server.cxx:953, become_leader()]
2022-04-29T06:25:19.544_514+00:00 [68592] [INFO] [BECOME LEADER] appended new config at 1	[raft_server.cxx:993, become_leader()]
2022-04-29T06:25:19.544_565+00:00 [68620] [INFO] config at index 1 is committed, prev config log idx 0	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:25:19.544_573+00:00 [68620] [INFO] new config log idx 1, prev log idx 0, cur config log idx 0, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:25:19.544_582+00:00 [68620] [INFO] new configuration: log idx 1, prev log idx 0
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 3, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:25:30.381_579+00:00 [68592] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:25:30.381_600+00:00 [68592] [INFO] session 1 got connection from 127.0.0.1:42328 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:25:30.381_700+00:00 [68592] [INFO] got join cluster req from leader 1	[handle_join_leave.cxx:165, handle_join_cluster_req()]
2022-04-29T06:25:30.381_723+00:00 [68592] [INFO] new config log idx 2, prev log idx 1, cur config log idx 1, prev log idx 0	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:25:30.381_780+00:00 [68592] [INFO] server 1 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:25:30.381_814+00:00 [68592] [INFO] server 2 is added to cluster	[handle_commit.cxx:667, reconfigure()]
2022-04-29T06:25:30.381_816+00:00 [68592] [INFO] peer 3 cannot be found, no action for removing	[handle_commit.cxx:761, reconfigure()]
2022-04-29T06:25:30.381_818+00:00 [68592] [INFO] add peer 1, tcp://localhost:12347, voting member
add peer 2, tcp://localhost:12345, voting member	[handle_commit.cxx:766, reconfigure()]
2022-04-29T06:25:30.381_826+00:00 [68592] [INFO] new configuration: log idx 2, prev log idx 1
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:25:30.382_509+00:00 [68592] [ERRO] session 1 failed to read rpc header from socket 127.0.0.1:42328 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:25:30.883_217+00:00 [68592] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:25:30.883_232+00:00 [68592] [INFO] session 2 got connection from 127.0.0.1:42330 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:25:30.883_327+00:00 [68592] [INFO] [LOG XX] req log idx: 3, req log term: 1, my last log idx: 1, my log (3) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:25:30.883_330+00:00 [68592] [INFO] deny, req term 1, my term 1, req log idx 3, my log idx 1	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:25:30.883_482+00:00 [68592] [INFO] receive a config change from leader at 2	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:25:30.883_486+00:00 [68592] [INFO] receive a config change from leader at 3	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:25:30.883_555+00:00 [68620] [INFO] config at index 1 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:25:30.883_558+00:00 [68620] [INFO] skipped config 1, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:25:30.883_567+00:00 [68620] [INFO] config at index 2 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:25:30.883_569+00:00 [68620] [INFO] skipped config 2, latest config 2	[handle_commit.cxx:405, commit_conf()]
2022-04-29T06:25:30.883_576+00:00 [68620] [INFO] config at index 3 is committed, prev config log idx 2	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:25:30.883_589+00:00 [68620] [INFO] new config log idx 3, prev log idx 2, cur config log idx 2, prev log idx 1	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:25:30.883_594+00:00 [68620] [INFO] now this node is the part of cluster, catch-up process is done, clearing the flag	[handle_commit.cxx:624, reconfigure()]
2022-04-29T06:25:30.883_613+00:00 [68620] [INFO] new configuration: log idx 3, prev log idx 2
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 1, term: 1	[handle_commit.cxx:809, reconfigure()]
2022-04-29T06:25:49.624_848+00:00 [68612] [INFO] 0x7fcb00001630 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.624_969+00:00 [68612] [INFO] 0x7fcaf80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_056+00:00 [68612] [INFO] 0x7fcafc0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_144+00:00 [68612] [INFO] 0x7fcaf00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_229+00:00 [68612] [INFO] 0x7fcaf40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_318+00:00 [68612] [INFO] 0x7fcae80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_512+00:00 [68612] [INFO] 0x7fcaec0014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_594+00:00 [68612] [INFO] 0x7fcae00014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_675+00:00 [68612] [INFO] 0x7fcae40014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:49.625_764+00:00 [68606] [INFO] 0x7fcad80014a0 connected to localhost:12347 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:52.208_344+00:00 [68593] [ERRO] session 2 failed to read rpc header from socket 127.0.0.1:42330 due to error 2, End of file, ref count 1	[asio_service.cxx:315, operator()()]
2022-04-29T06:25:53.739_758+00:00 [68593] [INFO] receive a incoming rpc connection	[asio_service.cxx:809, handle_accept()]
2022-04-29T06:25:53.739_772+00:00 [68593] [INFO] session 3 got connection from 127.0.0.1:42332 (as a server)	[asio_service.cxx:248, prepare_handshake()]
2022-04-29T06:25:53.739_907+00:00 [68593] [INFO] [PRE-VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22362 / mine 22355, term: req 1 / mine 1
HB alive	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:25:53.739_915+00:00 [68593] [INFO] pre-vote decision: X (deny)	[handle_vote.cxx:429, handle_prevote_req()]
2022-04-29T06:25:53.767_142+00:00 [68606] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:25:53.767_183+00:00 [68606] [INFO] [ELECTION TIMEOUT] current role: follower, log last term 1, state term 1, target p 50, my p 50, hb alive, pre-vote NOT done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:25:53.767_199+00:00 [68606] [INFO] reset RPC client for peer 2	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:25:53.767_354+00:00 [68606] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:25:53.767_484+00:00 [68606] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 1, log idx 22355, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:25:53.768_031+00:00 [68606] [INFO] 0x7fcadc1b1d60 connected to localhost:12345 (as a client)	[asio_service.cxx:1233, connected()]
2022-04-29T06:25:53.768_116+00:00 [68606] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:25:53.768_190+00:00 [68606] [INFO] [PRE-VOTE RESP] peer 2 (O), term 1, resp term 1, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:25:53.768_193+00:00 [68606] [INFO] [PRE-VOTE DONE] SUCCESS, term 1	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:25:53.768_194+00:00 [68606] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:25:53.768_204+00:00 [68606] [INFO] [VOTE INIT] my id 3, my role candidate, term 2, log idx 22355, log term 1, priority (target 50 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:25:53.768_334+00:00 [68606] [INFO] [VOTE RESP] peer 2 (X), resp term 2, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:25:54.996_291+00:00 [68606] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:25:54.996_300+00:00 [68606] [INFO] [PRIORITY] decay, target 50 -> 40, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:25:54.996_325+00:00 [68606] [INFO] [ELECTION TIMEOUT] current role: candidate, log last term 1, state term 2, target p 40, my p 50, hb dead, pre-vote done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:25:54.996_327+00:00 [68606] [INFO] pre-vote term (1) is different, reset it to 2	[handle_timeout.cxx:308, handle_election_timeout()]
2022-04-29T06:25:54.996_336+00:00 [68606] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:25:54.996_377+00:00 [68606] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 2, log idx 22355, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:25:54.996_676+00:00 [68606] [INFO] [PRE-VOTE RESP] peer 2 (O), term 2, resp term 2, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:25:54.996_679+00:00 [68606] [INFO] [PRE-VOTE DONE] SUCCESS, term 2	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:25:54.996_681+00:00 [68606] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:25:54.996_692+00:00 [68606] [INFO] [VOTE INIT] my id 3, my role candidate, term 3, log idx 22355, log term 1, priority (target 40 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:25:54.996_732+00:00 [68606] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-29T06:25:54.996_782+00:00 [68606] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:25:54.996_898+00:00 [68607] [INFO] [VOTE RESP] peer 2 (X), resp term 3, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:25:56.898_809+00:00 [68606] [WARN] Election timeout, initiate leader election	[handle_timeout.cxx:286, handle_election_timeout()]
2022-04-29T06:25:56.898_819+00:00 [68606] [INFO] [PRIORITY] decay, target 40 -> 30, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:25:56.898_843+00:00 [68606] [INFO] [ELECTION TIMEOUT] current role: candidate, log last term 1, state term 3, target p 30, my p 50, hb dead, pre-vote done	[handle_timeout.cxx:299, handle_election_timeout()]
2022-04-29T06:25:56.898_846+00:00 [68606] [INFO] pre-vote term (2) is different, reset it to 3	[handle_timeout.cxx:308, handle_election_timeout()]
2022-04-29T06:25:56.898_854+00:00 [68606] [INFO] reset RPC client for peer 1	[handle_vote.cxx:79, request_prevote()]
2022-04-29T06:25:56.898_895+00:00 [68606] [INFO] [PRE-VOTE INIT] my id 3, my role candidate, term 3, log idx 22355, log term 1, priority (target 30 / mine 50)	[handle_vote.cxx:134, request_prevote()]
2022-04-29T06:25:56.899_201+00:00 [68606] [INFO] [PRE-VOTE RESP] peer 2 (O), term 3, resp term 3, my role candidate, dead 2, live 0, num voting members 3, quorum 2	[handle_vote.cxx:465, handle_prevote_resp()]
2022-04-29T06:25:56.899_205+00:00 [68606] [INFO] [PRE-VOTE DONE] SUCCESS, term 3	[handle_vote.cxx:475, handle_prevote_resp()]
2022-04-29T06:25:56.899_206+00:00 [68606] [INFO] [PRE-VOTE DONE] initiate actual vote	[handle_vote.cxx:480, handle_prevote_resp()]
2022-04-29T06:25:56.899_217+00:00 [68606] [INFO] [VOTE INIT] my id 3, my role candidate, term 4, log idx 22355, log term 1, priority (target 30 / mine 50)	[handle_vote.cxx:225, request_vote()]
2022-04-29T06:25:56.899_258+00:00 [68606] [WARN] failed to send vote request: peer 1 (tcp://localhost:12347) is busy	[handle_vote.cxx:271, request_vote()]
2022-04-29T06:25:56.899_308+00:00 [68606] [WARN] peer (1) response error: failed to connect to peer 1, localhost:12347, error 111, Connection refused	[raft_server.cxx:754, handle_peer_resp()]
2022-04-29T06:25:56.899_392+00:00 [68606] [INFO] [VOTE RESP] peer 2 (X), resp term 4, my role candidate, granted 1, responded 2, num voting members 3, quorum 2	[handle_vote.cxx:374, handle_vote_resp()]
2022-04-29T06:25:57.903_579+00:00 [68606] [INFO] [PRE-VOTE REQ] my role candidate, from peer 2, log term: req 1 / mine 1
last idx: req 22362 / mine 22355, term: req 4 / mine 4
HB dead	[handle_vote.cxx:398, handle_prevote_req()]
2022-04-29T06:25:57.903_589+00:00 [68606] [INFO] pre-vote decision: O (grant)	[handle_vote.cxx:425, handle_prevote_req()]
2022-04-29T06:25:57.903_828+00:00 [68606] [INFO] [BECOME FOLLOWER] term 5	[raft_server.cxx:1266, become_follower()]
2022-04-29T06:25:57.903_850+00:00 [68606] [INFO] [PRIORITY] decay, target 30 -> 20, mine 50	[handle_priority.cxx:211, decay_target_priority()]
2022-04-29T06:25:57.903_864+00:00 [68606] [INFO] [VOTE REQ] my role follower, from peer 2, log term: req 1 / mine 1
last idx: req 22362 / mine 22355, term: req 5 / mine 5
priority: target 20 / mine 50, voted_for -1	[handle_vote.cxx:278, handle_vote_req()]
2022-04-29T06:25:57.903_877+00:00 [68606] [INFO] decision: O (grant), voted_for 2, term 5	[handle_vote.cxx:337, handle_vote_req()]
2022-04-29T06:25:57.904_135+00:00 [68606] [WARN] [LOG XX] req log idx: 22362, req log term: 1, my last log idx: 22355, my log (22362) term: 0	[handle_append_entries.cxx:570, handle_append_entries()]
2022-04-29T06:25:57.904_141+00:00 [68606] [WARN] deny, req term 5, my term 5, req log idx 22362, my log idx 22355	[handle_append_entries.cxx:582, handle_append_entries()]
2022-04-29T06:25:57.904_389+00:00 [68606] [INFO] receive a config change from leader at 22363	[handle_append_entries.cxx:726, handle_append_entries()]
2022-04-29T06:25:57.904_646+00:00 [68620] [INFO] config at index 22363 is committed, prev config log idx 3	[handle_commit.cxx:396, commit_conf()]
2022-04-29T06:25:57.904_668+00:00 [68620] [INFO] new config log idx 22363, prev log idx 3, cur config log idx 3, prev log idx 2	[handle_commit.cxx:589, reconfigure()]
2022-04-29T06:25:57.904_685+00:00 [68620] [INFO] new configuration: log idx 22363, prev log idx 3
peer 1, DC ID 1, tcp://localhost:12347, voting member, 50
peer 2, DC ID 1, tcp://localhost:12345, voting member, 50
peer 3, DC ID 1, tcp://localhost:12346, voting member, 50
my id: 3, leader: 2, term: 5	[handle_commit.cxx:809, reconfigure()]
